(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{36:function(t,e,s){"use strict";var i=s(6),a=s.n(i),n=s(13),o=s.n(n),r=s(37),l=s(11),d=s(53);class c{static build(t,e,s){const i=document.createElement(t);for(const[t,s]of Object.entries(e))switch(t){case"cssText":i.style.cssText=s;break;case"dataset":for(const[t,e]of Object.entries(s))i.dataset[t]=e;break;default:i[t]=s}return s&&i.append(...s),i}static link(t,e,s){return c.build("a",{href:t,title:e,target:"_blank",rel:"noopener",innerHTML:s})}static icon(t){return c.build("i",{className:"fa fa-fw",innerHTML:t})}}var h=c;class u{constructor(){this.parent=null,Object.defineProperty(this,"parent",{enumerable:!1})}init(t){this.parent=t}render(){}}const p={open:{key:"open",title:"Open"},save:{key:"save",title:"Save"},upload:{key:"upload",title:"Upload"},import:{key:"import",title:"Import"},about:{key:"about",title:"About"},signout:{key:"signout",title:"Sign Out"}};class m extends u{constructor(){super(...arguments),this.ctrl=null,this.items=new Map,this.events=new Map}init(t){super.init(t),this.render()}render(){const t=h.build("ul",{className:"mdc-list",role:"menu",ariaOrientation:"vertical"});for(const e of Object.values(p)){const s=h.build("li",{className:"mdc-list-item",role:"menuitem",dataset:{code:e.key},hidden:!0},[h.build("span",{className:"mdc-list-item__text",innerHTML:a.a.t(e.title)})]);this.items.set(e.key,s),t.append(s)}this.items.get(p.about.key).hidden=!1;const e=h.build("div",{className:"mdc-menu mdc-menu-surface"},[t]),s=h.build("div",{className:"mdc-menu-surface--anchor"},[e]);this.parent.append(s),this.ctrl=new r.a(e),this.ctrl.listen("MDCMenu:selected",t=>{this.events.get(t.detail.item.dataset.code)()})}open(){this.ctrl.open||(this.ctrl.open=!0)}}const b={view:{key:"view",title:"List",icon:""},signin:{key:"signin",title:"Sign In",icon:""},menu:{key:"menu",title:"Menu",icon:""}};var g=class extends u{constructor(){super(),this.menu=new m,this.actions=new Map,this.events=new Map,this.events.set(b.menu.key,()=>this.menu.open())}init(t){super.init(t),this.render()}render(){const t=h.build("section",{className:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-end"].join(" ")});for(const e of Object.values(b)){const s=h.build("button",{className:"fa mdc-icon-button",title:a.a.t(e.title),innerHTML:e.icon});t.append(s);const i=new l.a(s);i.unbounded=!0,i.listen("click",this.events.get(e.key)),s.hidden=!0,this.actions.set(e.key,s)}this.menu.init(t),this.actions.get(b.view.key).hidden=!1,this.actions.get(b.view.key).id="button-appBar-view",this.actions.get(b.menu.key).hidden=!1;const e=h.build("header",{className:"mdc-top-app-bar"},[h.build("div",{className:"mdc-top-app-bar__row"},[h.build("section",{className:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-start"].join(" ")},[h.build("span",{className:"mdc-top-app-bar__title",innerHTML:"Potori"})]),t])]);this.parent.append(e),this.parent.append(h.build("div",{className:"mdc-top-app-bar--fixed-adjust"})),new d.a(e)}switchView(){const t=this.actions.get(b.view.key),e=""===t.innerHTML;t.innerHTML=e?"":"",t.title=a.a.t(e?"Dashboard":"List")}};var f=class extends u{constructor(){super(...arguments),this.enabled=!1,this.changed=()=>{}}init(t){super.init(t);const e=window.matchMedia("(prefers-color-scheme: dark)");e.addListener(t=>{this.enabled=t.matches,this.changed(this.enabled)}),this.enabled=e.matches}},y=s(10),v=s.n(y);s(15);class x extends u{constructor(){super(),this.root=null,Object.defineProperty(this,"root",{enumerable:!1})}update(t){}updateStyle(){}setVisible(t){if(!this.root){if(!t)return;this.render()}this.root.hidden=!t}}class w extends x{constructor(){super(...arguments),this.chart=null}static get color(){return{border:"rgba(0, 0, 0, 0.2)",borderHover:"rgba(0, 0, 0, 0.4)"}}static buildChartCard(t,e,s,i){return h.build("div",{className:["mdc-card","mdc-card--outlined","padding--8","flex--"+s,"flex-shrink--1"].join(" "),cssText:`min-width:${i}px`},[h.build("span",{className:"mdc-typography--headline6",innerHTML:t}),h.build("div",{className:"container-chart"},[e])])}}class k extends x{updateStats(t){}}class _ extends k{constructor(){super(...arguments),this.chart=null}static buildChartCard(t,e,s,i){return w.buildChartCard(t,e,s,i)}}var N=class extends k{constructor(){super(...arguments),this.textReviews=null,this.textSubtitle=null,this.actionRefresh=null,this.events={refresh:()=>{},clear:()=>{}}}render(){this.textReviews=h.build("span",{cssText:"font-weight:300;font-size:4.5rem;line-height:4.5rem;",innerHTML:"0"}),this.textSubtitle=h.build("span",{className:"mdc-typography--body1 text-nowrap",innerHTML:a.a.t("Reviews for Portals",{count:0})}),this.actionRefresh=h.build("button",{className:"mdc-button mdc-card__action mdc-card__action--button",disabled:!0},[h.build("div",{className:"mdc-button__ripple"}),h.build("i",{className:"fa fa-fw mdc-button__icon",innerHTML:""}),h.build("span",{className:"mdc-button__label",innerHTML:a.a.t("Refresh")})]);const t=new l.a(this.actionRefresh);t.unbounded=!0,t.listen("click",()=>{this.actionRefresh.disabled=!0,this.events.refresh()});const e=h.build("button",{className:["fa","mdc-icon-button","mdc-card__action","mdc-card__action--icon"].join(" "),title:a.a.t("Clear"),id:"button-card-nomination-location",innerHTML:""}),s=new l.a(e);s.unbounded=!0,s.listen("click",()=>{this.events.clear()}),this.root=h.build("div",{className:["mdc-card","mdc-card--outlined","flex--1","flex-shrink--1"].join(" ")},[h.build("div",{className:["flex-box-col","padding--8","flex-grow--1","flex-justify-content--between"].join(" ")},[h.build("span",{className:"mdc-typography--headline6",innerHTML:a.a.t("Brainstorming")}),this.textReviews,this.textSubtitle]),h.build("div",{className:"mdc-card__actions"},[h.build("div",{className:"mdc-card__action-buttons"},[this.actionRefresh]),h.build("div",{className:"mdc-card__action-icons"},[e])])]),this.setVisible(!1),this.parent.append(this.root)}updateStats(t){this.textReviews.innerHTML=""+t.review,this.textSubtitle.innerHTML=a.a.t("Reviews for Portals",{count:t.nomination}),this.actionRefresh.disabled=!1}},T=s(19);var L=class extends _{render(){const t=h.build("canvas",{className:"canvas-chart--h"});this.root=_.buildChartCard(a.a.t("Brainstorming Rates"),t,1,240),this.setVisible(!1),this.parent.append(this.root);const e=[];for(const t of Object.values(T.a))e.push(a.a.t(t));const s=getComputedStyle(document.documentElement);this.chart=new v.a(t.getContext("2d"),{type:"radar",data:{labels:e,datasets:[{data:[],borderColor:s.getPropertyValue("--mdc-theme-primary"),pointRadius:0}]},options:{legend:{display:!1},scale:{ticks:{display:!1,min:1,max:5,stepSize:1},angleLines:{color:s.getPropertyValue("--mdc-theme-text-disabled-on-light")},gridLines:{color:s.getPropertyValue("--mdc-theme-text-disabled-on-light")}}}})}updateStats(t){const e=[];for(const s of Object.keys(T.a)){const i=t.rate.get(s),a=i.reduce((t,e)=>t+e,0)/i.length;e.push(parseFloat(a.toFixed(2)))}this.chart.data.datasets[0].data=e,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.options.scale.angleLines.color=t.getPropertyValue("--mdc-theme-text-disabled-on-light"),this.chart.options.scale.gridLines.color=t.getPropertyValue("--mdc-theme-text-disabled-on-light"),this.chart.update()}};var M=class extends k{constructor(){super(...arguments),this.textSynch=null}render(){this.textSynch=h.build("span",{cssText:"font-weight:300;font-size:6rem;line-height:6rem;",innerHTML:"0.0"}),this.root=h.build("div",{className:["mdc-card","mdc-card--outlined","padding--8","flex--1","flex-shrink--1","flex-justify-content--between"].join(" ")},[h.build("span",{className:"mdc-typography--headline6",innerHTML:a.a.t("Brainstorming Synch")}),h.build("span",{className:"text-nowarp"},[this.textSynch,h.build("span",{cssText:"font-size:2rem;line-height:2rem;",innerHTML:"%"})]),h.build("span",{className:"mdc-typography--body1 text-nowarp",innerHTML:a.a.t("Reviews match the result")})]),this.setVisible(!1),this.parent.append(this.root)}updateStats(t){const e=t.synch.total>0?t.synch.synched/t.synch.total:0;this.textSynch.innerHTML=""+(100*e).toFixed(1)}},S=s(16),C=s.n(S);var j=class{static fillTimeDataMap(t,e,s){let i=e;for(;i<=s;){const e=C()(i+1e3).startOf("month"),s=e.valueOf();t.has(s)||t.set(s,0),i=e.endOf("month").valueOf()}}};var R=class extends _{render(){const t=h.build("canvas",{className:"canvas-chart--h"});this.root=_.buildChartCard(a.a.t("Brainstorming Reviews"),t,3,300),this.setVisible(!1),this.parent.append(this.root);const e=getComputedStyle(document.documentElement);this.chart=new v.a(t.getContext("2d"),{type:"line",data:{labels:[],datasets:[{label:a.a.t("Reviews"),data:[],borderColor:e.getPropertyValue("--mdc-theme-primary"),pointRadius:0}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{unit:"month",tooltipFormat:"YYYY-MM",displayFormats:{month:"YYYY-MM"}}}]}}})}updateStats(t){if(t.reviewTimes.length<1)return this.chart.data.datasets[0].data=[],void this.chart.update();const e=new Map;let s=C()(t.reviewTimes[0]).startOf("month").valueOf(),i=s;for(const a of t.reviewTimes){const t=C()(a).startOf("month").valueOf();t<s?s=t:t>i&&(i=t),e.has(t)?e.set(t,e.get(t)+1):e.set(t,1)}j.fillTimeDataMap(e,s,i);const a=[];e.forEach((t,e)=>{a.push({t:e,y:t})}),a.sort((t,e)=>t.t-e.t),this.chart.data.datasets[0].data=a,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.update()}};var H=class extends x{constructor(){super(),this.basic=new N,this.rates=new L,this.synch=new M,this.reviews=new R,this.events={analyse:()=>({review:0,nomination:0,rate:new Map,reviewTimes:[],synch:{total:0,synched:0}})},Object.defineProperty(this,"events",{enumerable:!1})}init(t){this.forEach(e=>{e.init(t)})}update(t){const e=this.events.analyse(t);this.forEach(t=>{t.updateStats(e)})}updateStyle(){this.forEach(t=>{t.updateStyle()})}setVisible(t){this.forEach(e=>{e.setVisible(t)})}forEach(t){Object.values(this).forEach(t)}};var B=class extends w{render(){const t=h.build("canvas",{className:"canvas-chart--h"});this.root=w.buildChartCard(a.a.t("Count by Month"),t,3,300),this.setVisible(!1),this.parent.append(this.root);const e=getComputedStyle(document.documentElement),s=e.getPropertyValue("--mdc-theme-primary"),i=e.getPropertyValue("--mdc-theme-secondary");this.chart=new v.a(t.getContext("2d"),{type:"line",data:{labels:[],datasets:[{label:a.a.t("Submissions"),data:[],borderColor:s,pointBackgroundColor:s,pointRadius:0,fill:!1},{label:a.a.t("Results"),data:[],borderColor:i,pointBackgroundColor:i,pointRadius:0,fill:!1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{unit:"month",tooltipFormat:"YYYY-MM",displayFormats:{month:"YYYY-MM"}}}]},tooltips:{mode:"x"}}})}update(t){if(0===t.length)return this.chart.data.datasets[0].data=[],this.chart.data.datasets[1].data=[],void this.chart.update();const e=new Map,s=new Map;let i=C()(t[0].confirmedTime).startOf("month").valueOf(),a=i;for(const n of t){const t=C()(n.confirmedTime).startOf("month").valueOf();if(t<i?i=t:t>a&&(a=t),e.has(t)?e.set(t,e.get(t)+1):e.set(t,1),!n.resultTime)continue;const o=C()(n.resultTime).startOf("month").valueOf();o>a&&(a=o),s.has(o)?s.set(o,s.get(o)+1):s.set(o,1)}j.fillTimeDataMap(e,i,a),j.fillTimeDataMap(s,i,a);const n=[],o=[];e.forEach((t,e)=>{n.push({t:e,y:t})}),s.forEach((t,e)=>{o.push({t:e,y:t})}),n.sort((t,e)=>t.t-e.t),o.sort((t,e)=>t.t-e.t),this.chart.data.datasets[0].data=n,this.chart.data.datasets[1].data=o,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.data.datasets[1].borderColor=t.getPropertyValue("--mdc-theme-secondary"),this.chart.update()}},D=s(57),V=s(3);class O extends x{constructor(){super(...arguments),this.block={type:{root:null},reason:{root:null}},this.types=new Map,this.reasons=new Map,this.events={switchType:()=>{},switchReason:()=>{}}}render(){this.block.type.root=h.build("div",{className:"flex-box-row--nowrap"}),this.block.reason.root=h.build("div",{className:"flex-box-row--nowrap"}),this.root=h.build("div",{className:["mdc-card","mdc-card--outlined","padding--8","flex--1","flex-shrink--0"].join(" ")},[h.build("span",{className:"mdc-typography--headline6",innerHTML:a.a.t("Filter")}),h.build("span",{className:"mdc-typography--subtitle1",innerHTML:a.a.t("Type")}),this.block.type.root,h.build("span",{className:"mdc-typography--subtitle1",innerHTML:a.a.t("Rejected")}),this.block.reason.root]),this.setVisible(!1),this.parent.append(this.root);for(const t of V.c.reasons.values()){const e=O.buildSwitch(this.block.reason,t,"rejected");e.listen("change",()=>{this.switchReason(t,e.checked)}),this.reasons.set(t,e)}for(const t of V.c.types.values()){const e=O.buildSwitch(this.block.type,t,t.key);e.listen("change",()=>this.switchType(t,e.checked)),this.types.set(t,e)}}switchType(t,e){if(t.code>100)for(const t of this.reasons.values())t.checked=e;this.events.switchType(t,e)}switchReason(t,e){this.events.switchReason(t,e);const s=V.c.types.get("rejected");e&&!this.types.get(s).checked&&(this.types.get(s).checked=!0,this.events.switchType(s,!0))}static buildSwitch(t,e,s){const i="switch-filter-"+e.key,n=h.build("div",{className:"mdc-switch"},[h.build("div",{className:"mdc-switch__track"}),h.build("div",{className:"mdc-switch__thumb-underlay",id:i},[h.build("div",{className:"mdc-switch__thumb"},[h.build("input",{type:"checkbox",className:"mdc-switch__native-control",role:"switch"})])])]),o=h.build("div",{className:"mdc-switch-box margin-h--4"},[n,h.build("label",{className:"fa fa-fw status-"+s,for:i,title:a.a.t(e.title),innerHTML:e.icon})]);t.root.append(o);const r=new D.a(n);return r.checked=!0,r}}var P=new O;class E extends x{constructor(){super(...arguments),this.ctrl=null,this.events={focus:()=>{},styleLoaded:()=>[]},this.tasks=[]}render(){const t=h.build("div",{cssText:["width: 100%","height: 100%","clip-path: inset(100% round 4px)","-webkit-clip-path: inset(0 round 4px)"].join(";")});this.root=h.build("div",{className:"mdc-card mdc-card--outlined flex--3 flex-shrink--1",cssText:"min-width: 300px;"},[t]),this.parent.append(this.root),this.ctrl=new o.a.Map({container:t,style:`mapbox:${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`}),this.ctrl.on("idle",()=>this.executeTasks()),this.ctrl.addControl(new o.a.NavigationControl),this.ctrl.addControl(new o.a.FullscreenControl),this.resize()}get loaded(){return this.ctrl&&this.ctrl.isStyleLoaded()}update(t){this.loaded?(this.updateRejected(t),this.updateSource("accepted",E.generateGeoJSON(t,[V.c.types.get("accepted").code])),this.updateSource("pending",E.generateGeoJSON(t,[V.c.types.get("pending").code]))):this.tasks.push(()=>this.update(t))}updateStyle(){this.loaded?(this.ctrl.setStyle(`mapbox:${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`),this.update(this.events.styleLoaded())):this.tasks.push(()=>this.updateStyle())}setTypeVisible(t,e){if(!this.loaded)return void this.tasks.push(()=>this.setTypeVisible(t,e));const s=e?"visible":"none";this.ctrl.setLayoutProperty(`potori-${t}-cluster`,"visibility",s),this.ctrl.setLayoutProperty(`potori-${t}-count`,"visibility",s),this.ctrl.setLayoutProperty(`potori-${t}-unclustered`,"visibility",s)}easeTo(t){if(!this.loaded)return void this.tasks.push(()=>this.easeTo(t));const e=this.ctrl.getZoom();this.ctrl.easeTo({center:t,zoom:e<15?15:e})}resize(){this.loaded?this.ctrl.resize():this.tasks.push(()=>this.resize())}fit(t){if(!this.loaded)return void this.tasks.push(()=>this.fit(t));const e={lng:-181,lat:-91},s={lng:181,lat:91};for(const i of t)i.lngLat&&(i.lngLat.lng>e.lng&&(e.lng=i.lngLat.lng),i.lngLat.lng<s.lng&&(s.lng=i.lngLat.lng),i.lngLat.lat>e.lat&&(e.lat=i.lngLat.lat),i.lngLat.lat<s.lat&&(s.lat=i.lngLat.lat));s.lng>-181&&this.ctrl.fitBounds([s,e],{linear:!0})}updateRejected(t){if(!this.loaded)return void this.tasks.push(()=>this.updateRejected(t));const e=[];for(const[t,s]of P.reasons.entries())s.checked&&e.push(t.code);this.updateSource("rejected",E.generateGeoJSON(t,e))}executeTasks(){const t=this.tasks.length;for(let e=0;e<t;e++)this.tasks.shift()()}updateSource(t,e){const s="potori-"+t,i=this.ctrl.getSource(s);if(i)return void i.setData(e);this.ctrl.addSource(s,{type:"geojson",data:e,cluster:!0});const a=getComputedStyle(document.documentElement),n=a.getPropertyValue("--color-"+t),r=a.getPropertyValue(`--color-${t}--dark`);this.ctrl.addLayer({id:s+"-cluster",type:"circle",source:s,filter:["has","point_count"],paint:{"circle-color":n,"circle-opacity":.6,"circle-stroke-width":4,"circle-stroke-color":r,"circle-radius":["step",["get","point_count"],20,50,30,100,40]}}),this.ctrl.addLayer({id:s+"-count",type:"symbol",source:s,filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":getComputedStyle(document.documentElement).getPropertyValue("--mdc-theme-on-surface")}}),this.ctrl.addLayer({id:s+"-unclustered",type:"circle",source:s,filter:["!",["has","point_count"]],paint:{"circle-color":n,"circle-radius":5,"circle-stroke-width":2,"circle-stroke-color":r}}),this.ctrl.on("click",s+"-cluster",t=>{const e=this.ctrl.queryRenderedFeatures(t.point,{layers:[s+"-cluster"]}),i=e[0].properties.cluster_id;this.ctrl.getSource(s).getClusterExpansionZoom(i,(t,s)=>{t||this.ctrl.easeTo({center:e[0].geometry.coordinates,zoom:s})})}),this.ctrl.on("click",s+"-unclustered",t=>{t.features[0].geometry.coordinates;const e=t.features[0].geometry.coordinates;for(;Math.abs(t.lngLat.lng-e[0])>180;)e[0]+=t.lngLat.lng>e[0]?360:-360;(new o.a.Popup).setLngLat(e).setText(t.features[0].properties.title).addTo(this.ctrl),this.events.focus(t.features[0].properties.id)})}static generateGeoJSON(t,e){const s={type:"FeatureCollection",features:[]};if(e.length<1)return s;for(const i of t)e.includes(i.status.code)&&i.lngLat&&s.features.push({type:"Feature",properties:{id:i.id,title:i.title,status:i.status},geometry:{type:"Point",coordinates:[i.lngLat.lng,i.lngLat.lat]}});return s}}var I=E;var A=class extends w{render(){const t=h.build("canvas",{className:"canvas-chart--h"});this.root=w.buildChartCard(a.a.t("Quotas"),t,2,200),this.setVisible(!1),this.parent.append(this.root);const e=[];for(let t=0;t<14;t++)e.push(""+t);const s=getComputedStyle(document.documentElement);this.chart=new v.a(t.getContext("2d"),{type:"bar",data:{labels:e,datasets:[{data:[],backgroundColor:s.getPropertyValue("--mdc-theme-primary"),hoverBackgroundColor:s.getPropertyValue("--mdc-theme-primary")}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{scaleLabel:{display:!0,labelString:a.a.t("Day")}}]}}})}update(t){const e=new Array(14).fill(0),s=Date.now();for(const i of t){const t=i.restoreTime;t>s&&(e[Math.floor((t-s)/864e5)]+=1)}this.chart.data.datasets[0].data=e,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].backgroundColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.data.datasets[0].hoverBackgroundColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.update()}};class z extends w{render(){const t=h.build("canvas",{className:"canvas-chart--v"});this.root=w.buildChartCard(a.a.t("Stats Rejected"),t,2,250),this.setVisible(!1),this.parent.append(this.root);const e=[],s=[];for(const t of V.c.reasons.values())e.push(a.a.t(t.title)),s.push(t.color);this.chart=new v.a(t.getContext("2d"),{type:"doughnut",data:{labels:e,datasets:[{data:[],backgroundColor:s,borderAlign:"inner",borderColor:z.color.border,hoverBackgroundColor:s,hoverBorderColor:z.color.borderHover}]},options:{legend:{display:!0,position:"right"}}})}update(t){const e=new Array(V.c.reasons.size).fill(0);for(const s of t)s.status.code>100&&(e[s.status.code-101]+=1);this.chart.data.datasets[0].data=e,this.chart.update()}}var F=z;class q extends w{render(){const t=h.build("canvas",{className:"canvas-chart--v"});this.root=w.buildChartCard(a.a.t("Stats Type"),t,2,250),this.setVisible(!1),this.parent.append(this.root);const e=[],s=[],i=[],n=[],o=getComputedStyle(document.documentElement);for(const[t,r]of V.c.types.entries())e.push(a.a.t(r.title)),s.push(o.getPropertyValue("--color-"+t)),i.push(o.getPropertyValue(`--color-${t}--light`)),n.push(o.getPropertyValue(`--color-${t}--dark`));this.chart=new v.a(t.getContext("2d"),{type:"doughnut",data:{labels:e,datasets:[{data:[],backgroundColor:s,borderAlign:"inner",borderColor:q.color.border,hoverBackgroundColor:s,hoverBorderColor:q.color.borderHover}]},options:{legend:{display:!0,position:"right"}}})}update(t){const e=new Array(3).fill(0);for(const s of t)s.status.code>100?e[2]+=1:e[s.status.code]+=1;this.chart.data.datasets[0].data=e,this.chart.update()}}var U=q;var Y=class extends u{constructor(){super(),this.root=null,this.map=new I,this.filter=P,this.statsType=new U,this.statsRejected=new F,this.countByMonth=new B,this.quotas=new A,this.bs=new H,Object.defineProperty(this,"root",{enumerable:!1})}init(t){super.init(t),v.a.defaults.global.legend.labels.boxWidth=10,v.a.defaults.global.maintainAspectRatio=!1,v.a.defaults.line.tooltips={intersect:!1},v.a.defaults.doughnut.tooltips={callbacks:{label:(t,e)=>{const s=e.datasets[t.datasetIndex],i=s._meta,a=i[Object.keys(i)[0]].data,n=s.data.reduce((t,e,s)=>t+(a[s].hidden?0:e),0),o=s.data[t.index],r=(o/n*100).toFixed(2);return`${e.labels[t.index]}: ${o} (${r}%)`}}},v.a.defaults.radar.tooltips={intersect:!1,callbacks:{title:(t,e)=>e.labels[t[0].index]}},this.render(),this.forEach(t=>{t.init(this.root)})}render(){this.root=h.build("div",{className:["flex--2","flex-box-row--wrap","flex-align-items--start","flex-align-content--start","padding--4","dashboard"].join(" "),cssText:["height: 100%","box-sizing: border-box","overflow-y: scroll","scroll-behavior: smooth","-webkit-overflow-scrolling: touch"].join(";")}),this.parent.append(this.root)}refresh(t){this.forEach(e=>{e.update(t)})}update(t){this.map.update(t),this.statsType.update(t),this.statsRejected.update(t),this.countByMonth.update(t)}updateStyle(){this.forEach(t=>{t.updateStyle()})}setVisible(t){this.forEach(e=>{e.setVisible(t)}),this.map.resize()}forEach(t){Object.values(this).forEach(t)}},$=s(54);class J extends u{constructor(){super(...arguments),this.ctrl=null}static buildDialog(t){return h.build("div",{className:"mdc-dialog mdc-dialog--scrollable",role:"dialog",ariaModal:!0},[h.build("div",{className:"mdc-dialog__container"},[h.build("div",{className:"mdc-dialog__surface"},t)]),h.build("div",{className:"mdc-dialog__scrim"})])}static buildDialogAction(t,e){return h.build("button",{className:"mdc-button mdc-dialog__button",dataset:{mdcDialogAction:t}},[h.build("span",{className:"mdc-button__label",innerHTML:e})])}}var G=s(17);var Z=class extends J{render(){const t=J.buildDialog([h.build("h2",{className:"mdc-dialog__title",innerHTML:a.a.t("About")}),h.build("div",{className:"mdc-dialog__content flex-box-col"},[h.build("span",{className:"mdc-typography--body2"},[h.link("./docs",a.a.t("Documents"),a.a.t("Documents"))]),h.build("span",{className:"mdc-typography--body2"},[h.link("https://github.com/lucka-me/potori",a.a.t("GitHub Repo"),a.a.t("GitHub Repo"))]),h.build("span",{className:"mdc-typography--body2"},[h.link("https://github.com/lucka-me/potori/blob/master/CHANGELOG.md",a.a.t("Changelog"),G.a.text)," by ",h.link("https://lucka.moe",a.a.t("Blog"),"Lucka")])]),h.build("footer",{className:"mdc-dialog__actions"},[J.buildDialogAction("close",a.a.t("Close"))])]);this.parent.append(t),this.ctrl=new $.a(t)}open(){this.ctrl||this.render(),this.ctrl.open()}};var W=new class extends J{constructor(){super(...arguments),this.textMessage=null}render(){this.textMessage=h.build("div",{className:"mdc-dialog__content"});const t=J.buildDialog([this.textMessage,h.build("footer",{className:"mdc-dialog__actions"},[J.buildDialogAction("close",a.a.t("Close"))])]);this.parent.append(t),this.ctrl=new $.a(t)}open(t){this.ctrl||this.render(),this.ctrl.open(),this.textMessage.innerHTML=t}},Q=s(59),X=s(58),K=s(52),tt=s(51);class et extends u{constructor(){super(...arguments),this.ctrl=null,this.marker=null,this.dialog=null,this.nomination=null,this.buttons={edit:{root:null,icon:"",clicked:()=>this.edit()},search:{root:null,icon:"",clicked:()=>this.search()},delete:{root:null,icon:"",clicked:()=>this.delete()}},this.events={queryLngLat:()=>{}}}init(t){super.init(t),this.render()}render(){const t=[];for(const e of Object.values(this.buttons)){e.root=h.build("button",{className:"fa mdc-icon-button",innerHTML:e.icon});const s=new l.a(e.root);s.unbounded=!0,s.listen("click",e.clicked),t.push(e.root)}const e=h.build("div",{className:"flex-grow--1",cssText:"min-height: 180px"}),s=h.build("div",{className:"flex-box-row--nowrap margin-v--8"},[h.build("div",{className:"flex-box-col flex-justify-content--around"},t),e]);this.parent.append(s),this.ctrl=new o.a.Map({container:e,style:`mapbox:${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`}),this.ctrl.addControl(new o.a.NavigationControl)}set(t){this.nomination=t,this.delete(),this.nomination.lngLat&&(this.marker=new o.a.Marker,this.marker.setLngLat(this.nomination.lngLat).addTo(this.ctrl),this.ctrl.jumpTo({center:this.nomination.lngLat,zoom:16}),this.buttons.delete.root.disabled=!1,this.buttons.edit.root.innerHTML=""),this.buttons.search.root.disabled=!1}edit(){this.marker?this.marker.setDraggable(!0):(this.marker=(new o.a.Marker).setLngLat(this.ctrl.getCenter()).setDraggable(!0).addTo(this.ctrl),this.buttons.delete.root.disabled=!1,this.buttons.edit.root.innerHTML="")}search(){this.buttons.search.root.disabled=!0,this.events.queryLngLat(this.nomination.id,t=>{this.dialog.isOpen&&(this.marker?this.marker.setLngLat(t):this.marker=(new o.a.Marker).setLngLat(t).addTo(this.ctrl),this.marker.setDraggable(!1),this.ctrl.easeTo({center:t,zoom:16}),this.buttons.edit.root.innerHTML="",this.buttons.search.root.disabled=!1,this.buttons.delete.root.disabled=!1)},()=>{this.dialog.isOpen&&(W.open(a.a.t("message:Unable to query the location")),this.buttons.search.root.disabled=!1)})}delete(){this.marker&&this.marker.remove(),this.marker=null,this.buttons.edit.root.innerHTML="",this.buttons.delete.root.disabled=!0}}class st extends J{constructor(){super(...arguments),this.nomination=null,this.headingTitle=null,this.image=null,this.textConfirmedTime=null,this.status=new Map,this.selectedStatus=null,this.fieldResultTime=null,this.selectReason=null,this.elementReason=null,this.map=new et,this.events={update:()=>{},query:()=>{}}}render(){this.headingTitle=h.build("h2",{className:"mdc-dialog__title",dataset:{mdcDialogInitialFocus:""},innerHTML:""}),this.image=h.build("img",{cssText:["object-fit:cover","object-position:center","width:100%","height:150px;"].join(";")}),this.textConfirmedTime=h.build("span",{className:"margin-l--4"});const t=[];for(const e of V.c.types.keys()){const s="radio-dialog-details-status-"+e,i=h.build("input",{type:"radio",className:"mdc-radio__native-control",name:"radio-dialog-details-status",value:e});i.addEventListener("change",t=>{const e=t.target;this.selectedStatus=e.value,this.fieldResultTime.root.hidden="pending"===e.value,this.fieldResultTime.layout(),this.elementReason.hidden=!("rejected"===e.value),this.selectReason.layout(),this.map.ctrl.resize()});const a=h.build("div",{className:"mdc-radio"},[i,h.build("div",{className:"mdc-radio__background"},[h.build("div",{className:"mdc-radio__outer-circle"}),h.build("div",{className:"mdc-radio__inner-circle"})])]),n=h.build("div",{className:"mdc-form-field"},[a,h.build("label",{for:s,className:"fa status-"+e,innerHTML:V.c.types.get(e).icon})]),o=new X.a(a);this.status.set(e,o);new Q.a(n).input=o,t.push(n)}const e=h.build("div",{className:["mdc-text-field","mdc-text-field--outlined","mdc-text-field--with-leading-icon","margin-v--8","margin-h--4","flex-grow--1"].join(" ")},[h.build("i",{className:["fa","mdc-text-field__icon","mdc-text-field__icon--leading"].join(" "),innerHTML:""}),h.build("input",{type:"datetime-local",className:"mdc-text-field__input",id:"input-dialog-details-result-time"}),st.buildNotchedOutline({for:"input-dialog-details-result-time",innerHTML:a.a.t("Result Time")})]);this.fieldResultTime=new tt.a(e);const s=[];for(const[t,e]of V.c.reasons.entries())s.push(h.build("li",{className:"mdc-list-item",dataset:{value:t},innerHTML:a.a.t(e.title)}));this.elementReason=h.build("div",{className:["mdc-select","mdc-select--outlined","margin-v--8","margin-h--4"].join(" ")},[h.build("div",{className:"mdc-select__anchor"},[h.build("i",{className:"mdc-select__dropdown-icon"}),h.build("div",{className:"mdc-select__selected-text"}),st.buildNotchedOutline({innerHTML:a.a.t("Reason")})]),h.build("div",{className:"mdc-select__menu mdc-menu mdc-menu-surface"},[h.build("ul",{className:"mdc-list"},s)])]),this.selectReason=new K.a(this.elementReason),this.selectReason.selectedIndex=0;const i=h.build("div",{className:"mdc-dialog__content"},[h.build("div",{className:["mdc-typography--body1","flex-box-row--nowrap","flex-align-items--center"].join(" ")},[h.icon("&#xf062"),this.textConfirmedTime]),h.build("div",{className:["fullwidth","flex-box-row--nowrap","flex-justify-content--around"].join(" ")},t),h.build("div",{className:"flex-box-row--wrap"},[e,this.elementReason])]);this.map.init(i);const n=J.buildDialog([this.headingTitle,this.image,i,h.build("footer",{className:"mdc-dialog__actions"},[J.buildDialogAction("close","Close"),J.buildDialogAction("save","Save")])]);this.parent.append(n),this.ctrl=new $.a(n),this.ctrl.listen("MDCDialog:opened",()=>this.opened()),this.ctrl.listen("MDCDialog:closed",t=>this.closed(t)),this.map.dialog=this.ctrl}opened(){this.fieldResultTime.layout(),this.selectReason.layout(),this.map.ctrl.resize()}closed(t){if("save"!==t.detail.action)return;const e=V.c.getTypeByCode(this.nomination.status.code),s=V.c.getReasonByCode(this.nomination.status.code),i=this.selectedStatus;let n=!1;if("pending"!==i){const t=Date.parse(this.fieldResultTime.value);if(!t)return void W.open(a.a.t("message:Invalid DateTime"));const e=t+6e4*(new Date).getTimezoneOffset();this.nomination.resultTime&&Math.floor(this.nomination.resultTime/6e4)===Math.floor(e/6e4)||(this.nomination.resultTime=e,n=!0)}const o=this.selectReason.value;if((i!==e||"rejected"===e&&s.key!==o)&&(n=!0),this.map.marker){const t=this.map.marker.getLngLat();this.nomination.lngLat&&this.nomination.lngLat.lng===t.lng&&this.nomination.lngLat.lat===t.lat||(this.nomination.lngLat=t,n=!0)}else this.nomination.lngLat&&(this.nomination.lngLat=null,n=!0);n&&("rejected"!==this.selectedStatus?this.nomination.status=V.c.types.get(this.selectedStatus):this.nomination.status=V.c.reasons.get(this.selectReason.value),this.events.update(this.nomination))}open(t){this.ctrl||this.render(),this.nomination=t,this.map.set(t);const e=V.c.getTypeByCode(t.status.code);this.headingTitle.innerHTML=t.title,this.image.src=t.imageUrl,this.textConfirmedTime.innerHTML=new Date(t.confirmedTime).toLocaleString(),this.fieldResultTime.root.hidden="pending"===e;const s=t=>{const e=new Date;return e.setTime(t-6e4*e.getTimezoneOffset()),e.toISOString()},i=s(t.resultTime?t.resultTime:Date.now());this.fieldResultTime.value=i.slice(0,i.lastIndexOf(":")),this.elementReason.hidden=!("rejected"===e),"rejected"===e&&(this.selectReason.selectedIndex=t.status.code-V.c.types.get(e).code),"pending"===e&&this.events.query(t.id,t=>{const e=s(t.lastTime);this.fieldResultTime.value=e.slice(0,e.lastIndexOf(":")),this.fieldResultTime.layout()},()=>{}),this.status.get(e).checked=!0,this.selectedStatus=e,this.ctrl.open()}updateStyle(){this.map.ctrl&&this.map.ctrl.setStyle(`mapbox:${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`)}static buildNotchedOutline(t){return t.className="mdc-floating-label",h.build("div",{className:"mdc-notched-outline"},[h.build("div",{className:"mdc-notched-outline__leading"}),h.build("div",{className:"mdc-notched-outline__notch"},[h.build("label",t)]),h.build("div",{className:"mdc-notched-outline__trailing"})])}}var it=st;var at=class extends J{constructor(){super(...arguments),this.textField=null,this.events={import:()=>{}}}render(){const t=h.build("div",{className:["mdc-text-field","mdc-text-field--outlined","mdc-text-field--textarea","mdc-text-field--fullwidth"].join(" ")},[h.build("textarea",{className:"mdc-text-field__input code",id:"input-dialog-import-wayfarer",rows:8,cols:80}),h.build("div",{className:"mdc-notched-outline"},[h.build("div",{className:"mdc-notched-outline__leading"}),h.build("div",{className:"mdc-notched-outline__notch"},[h.build("label",{className:"mdc-floating-label",for:"input-dialog-import-wayfarer",innerHTML:"JSON"})]),h.build("div",{className:"mdc-notched-outline__trailing"})])]),e=J.buildDialog([h.build("h2",{className:"mdc-dialog__title",innerHTML:a.a.t("Import")}),h.build("div",{className:"mdc-dialog__content"},[t,h.build("div",{className:"mdc-text-field-helper-line"},[h.build("div",{className:"mdc-text-field-helper-text mdc-text-field-helper-text--persistent"},[a.a.t("From "),h.link("https://wayfarer.nianticlabs.com/api/v1/vault/manage",a.a.t("Wayfarer API"),a.a.t("Wayfarer API"))])])]),h.build("footer",{className:"mdc-dialog__actions"},[J.buildDialogAction("close",a.a.t("Close")),J.buildDialogAction("import",a.a.t("Import"))])]);this.parent.append(e),this.ctrl=new $.a(e),this.textField=new tt.a(t),this.ctrl.listen("MDCDialog:closed",t=>{this.closed(t)})}open(){this.ctrl||this.render(),this.ctrl.open()}closed(t){"import"===t.detail.action&&this.events.import(this.textField.value)}};var nt=class extends u{constructor(){super(...arguments),this.about=new Z,this.alert=W,this.details=new it,this.import=new at}init(t){super.init(t);for(const e of Object.values(this))e.init(t)}};var ot=class{static build(t,e,s){const i=["margin-r--8","flex-box-row--nowrap","flex-align-items--center"].join(" "),n=[];n.push(h.build("span",{className:i},[h.icon("&#xf062"),h.build("span",{className:"margin-l--4",innerHTML:t.confirmedDateString})]));t.restoreTime>e&&n.push(h.build("span",{className:i},[h.icon("&#xf2f9"),h.build("span",{className:"margin-l--4",innerHTML:t.restoreIntervalString})])),n.push(h.build("span",{className:i},[h.icon("&#xf017"),h.build("span",{className:"margin-l--4",id:"text-card-nomination-interval"})])),n.push(h.build("span",{className:i,id:"box-card-nomination-result"},[h.icon("&#xf00c"),h.build("span",{className:"margin-l--4"})]));const o=["object-fit: cover","object-position: center","width: 120px","min-width: 120px","height: 120px","min-height: 120px"].join(";"),r=h.build("div",{className:"mdc-card__primary-action"},[h.build("div",{className:"flex-box-row--nowrap"},[h.build("img",{cssText:o,src:t.imageUrl,loading:"lazy"}),h.build("div",{className:["padding--8","flex-box--col","flex-align-items--start","flex-justify-content--start"].join(" ")},[h.build("span",{className:"mdc-typography--headline6",innerHTML:t.title}),h.build("div",{className:"mdc-typography--body2 flex-box-row--wrap"},n)])])]);new l.a(r).listen("click",s.openDetails);const d=h.build("button",{className:"mdc-button mdc-card__action mdc-card__action--button"},[h.build("div",{className:"mdc-button__ripple"}),h.build("i",{className:"fa fa-fw mdc-button__icon"}),h.build("span",{className:"mdc-button__label"})]),c=new l.a(d);c.unbounded=!0,G.a.fullFeature?c.listen("click",()=>{window.open(t.bsUrl,"_blank","noopener")}):c.listen("click",()=>{const e=h.build("textarea",{value:t.id,readOnly:!0});document.body.append(e),e.select(),document.execCommand("copy"),e.remove(),W.open(a.a.t("message:Brainstorming ID copied",{id:t.id}))});const u=[],p=["fa","mdc-icon-button","mdc-card__action","mdc-card__action--icon"].join(" "),m=h.build("button",{className:p,title:a.a.t("Location"),id:"button-card-nomination-location",hidden:!0,innerHTML:"&#xf3c5"}),b=new l.a(m);if(b.unbounded=!0,b.listen("click",s.focus),u.push(m),G.a.fullFeature){const e=h.build("button",{className:p,title:a.a.t("Intel Map"),id:"button-card-nomination-intel",hidden:!0,innerHTML:"&#xf279"}),s=new l.a(e);s.unbounded=!0,s.listen("click",()=>{window.open(t.intelUrl,"_blank","noopener")}),u.push(e)}return h.build("div",{className:"mdc-card mdc-card--outlined flex-shrink--0",id:"card-"+t.id},[r,h.build("div",{className:"mdc-card__actions"},[h.build("div",{className:"mdc-card__action-buttons"},[d]),h.build("div",{className:"mdc-card__action-icons"},u)])])}static update(t,e){const s=e.querySelector("#box-card-nomination-result"),i=V.c.getTypeByCode(t.status.code);e.querySelector("#text-card-nomination-interval").innerHTML=t.intervalString,t.status.code>0?(s.hidden=!1,s.querySelector("i").innerHTML=V.c.types.get(i).icon,s.querySelector("span").innerHTML=t.resultDateString):s.hidden=!0;const n=e.querySelector(".mdc-card__action-buttons > button");n.className="mdc-button mdc-card__action mdc-card__action--button status-"+i,n.querySelector("i").innerHTML=t.status.icon,n.querySelector("span").innerHTML=a.a.t(t.status.title)}static updateLocation(t,e){const s=!t.lngLat;if(e.querySelector("#button-card-nomination-location").hidden=s,!G.a.fullFeature)return;e.querySelector("#button-card-nomination-intel").hidden=s}};var rt=class extends u{constructor(){super(...arguments),this.root=null,this.now=Date.now(),this.events={focus:()=>{},openDetails:()=>{}}}init(t){super.init(t),this.render()}render(){this.root=h.build("div",{className:["flex--1","flex-box-col","view-hide"].join(" "),cssText:["height: 100%","min-width: 300px","padding: 4px","box-sizing: border-box","overflow-y: scroll","scroll-behavior: smooth","-webkit-overflow-scrolling: touch"].join(";")}),this.parent.append(this.root)}clear(){this.root.innerHTML=""}show(t){this.clear();const e=t.map(t=>{const e=ot.build(t,this.now,{openDetails:()=>this.events.openDetails(t),focus:()=>{this.events.focus(t)}});return ot.update(t,e),t.lngLat&&ot.updateLocation(t,e),e});this.root.append(...e)}updateVisibility(t,e){t.status instanceof V.a?e.hidden=!P.reasons.get(t.status).checked:t.status instanceof V.b&&(e.hidden=!P.types.get(t.status).checked)}update(t){const e=this.root.querySelector("#card-"+t.id);ot.update(t,e),ot.updateLocation(t,e),this.updateVisibility(t,e)}},lt=s(55);var dt=class extends u{constructor(){super(...arguments),this.ctrl=null}init(t){super.init(t),this.render()}render(){const t=h.build("div",{className:"mdc-linear-progress mdc-linear-progress--closed"},[h.build("div",{className:"mdc-linear-progress__buffer"},[h.build("div",{className:"mdc-linear-progress__buffer-bar"}),h.build("div",{className:"mdc-linear-progress__buffer-dots"})]),h.build("div",{className:"mdc-linear-progress__bar mdc-linear-progress__primary-bar"},[h.build("span",{className:"mdc-linear-progress__bar-inner"})]),h.build("div",{className:"mdc-linear-progress__bar mdc-linear-progress__secondary-bar"},[h.build("span",{className:"mdc-linear-progress__bar-inner"})])]);this.parent.append(t),this.ctrl=new lt.a(t)}},ct=s(5),ht=s(56);var ut=new class extends u{constructor(){super(...arguments),this.ctrl=null,this.textMessage=null}render(){this.textMessage=h.build("div",{className:"mdc-snackbar__label",role:"status",ariaLive:"polite"});const t=h.build("div",{className:"mdc-snackbar__actions"},[h.build("button",{className:"fa mdc-icon-button mdc-snackbar__dismiss",title:a.a.t("Dismiss"),innerHTML:"&#xf00d"})]),e=h.build("div",{className:"mdc-snackbar"},[h.build("div",{className:"mdc-snackbar__surface"},[this.textMessage,t])]);this.parent.append(e),this.ctrl=new ht.a(e)}show(t){this.ctrl||this.render(),this.textMessage.innerHTML=t,this.ctrl.open()}};e.a=class{constructor(){this.appBar=new g,this.progress=new dt,this.dashboard=new Y,this.list=new rt,this.dialog=new nt,this.snackbar=ut,this.dark=new f}init(){document.documentElement.lang=a.a.language,o.a.accessToken="pk.eyJ1IjoibHVja2EtbWUiLCJhIjoiY2p2NDk5NmRvMHFreTQzbzduemM1MHV4cCJ9.7XGmxnEJRoCDr-i5BBmBfw";const t=document.body;t.className="mdc-typography fullheight flex-box-col",this.appBar.events.set(b.view.key,()=>this.switchView()),this.appBar.events.set(b.signin.key,()=>ct.a.auth.signIn()),this.appBar.menu.events.set(p.open.key,()=>ct.a.open()),this.appBar.menu.events.set(p.save.key,()=>ct.a.save()),this.appBar.menu.events.set(p.upload.key,()=>ct.a.upload()),this.appBar.menu.events.set(p.import.key,()=>this.dialog.import.open()),this.appBar.menu.events.set(p.about.key,()=>this.dialog.about.open()),this.appBar.menu.events.set(p.signout.key,()=>ct.a.auth.signOut()),this.appBar.init(t),this.progress.init(t);const e=h.build("div",{className:["flex--1","flex-box-row--wrap","main-box"].join(" "),cssText:["min-height: 0%"].join(";")});t.append(e),this.snackbar.init(t),this.dashboard.map.events.focus=t=>{const e=this.list.root.offsetTop+8;this.list.root.scrollTo(0,document.getElementById("card-"+t).offsetTop-e)},this.dashboard.map.events.styleLoaded=()=>ct.a.nominations,this.dashboard.filter.events.switchType=(t,e)=>{for(const s of ct.a.nominations)V.c.typeMatched(s.status.code,t.code)&&(document.getElementById("card-"+s.id).hidden=!e);"rejected"===t.key&&this.dashboard.map.updateRejected(ct.a.nominations),this.dashboard.map.setTypeVisible(t.key,e)},this.dashboard.filter.events.switchReason=(t,e)=>{for(const s of ct.a.nominations)s.status.code===t.code&&(document.getElementById("card-"+s.id).hidden=!e);this.dashboard.map.updateRejected(ct.a.nominations)},this.dashboard.bs.events.analyse=t=>ct.a.bs.analyse(t),this.dashboard.bs.basic.events={refresh:()=>{ct.a.updateBsData()},clear:()=>{ct.a.clearBsData(),this.dashboard.bs.update([])}},this.dashboard.init(e),this.list.events.focus=t=>{this.dashboard.map.easeTo(t.lngLat)},this.list.events.openDetails=t=>{this.dialog.details.open(t)},this.list.init(e),this.dialog.details.events.update=t=>{this.update(t)},this.dialog.details.events.query=(t,e,s)=>{ct.a.bs.query(t,e,s)},this.dialog.details.map.events.queryLngLat=(t,e,s)=>{ct.a.bs.queryLngLat(t,e,s)},this.dialog.import.events.import=t=>{ct.a.import(t)},this.dialog.init(t),this.dark.changed=()=>{this.dashboard.updateStyle(),this.dialog.details.updateStyle()},this.dark.init(t)}linkService(){ct.a.events.authStatusChanged=t=>{t?(this.appBar.actions.get(b.signin.key).hidden=!0,this.appBar.menu.items.get(p.signout.key).hidden=!1):(this.clear(),this.appBar.actions.get(b.signin.key).hidden=!1,this.appBar.menu.items.get(p.signout.key).hidden=!0,this.appBar.menu.items.get(p.upload.key).hidden=!0,this.appBar.menu.items.get(p.import.key).hidden=!0)},ct.a.events.progressUpdate=t=>{this.progress.ctrl.progress=t},ct.a.events.updateBs=()=>{this.dashboard.bs.update(ct.a.nominations)},ct.a.events.showProgress=()=>{this.progress.ctrl.open()},ct.a.events.show=()=>{this.show()},ct.a.events.clear=()=>{this.clear()},ct.a.events.alert=t=>{this.dialog.alert.open(t)},ct.a.events.info=t=>{this.snackbar.show(t)},ct.a.file.local.events.openUI=t=>{this.openFileUI(t)},ct.a.file.local.events.saveUI=(t,e)=>{this.saveFileUI(t,e)},ct.a.mari.events.bufferUpdate=t=>{this.progress.ctrl.buffer=t},ct.a.mari.events.progressUpdate=t=>{this.progress.ctrl.progress=.9*t}}switchView(){this.appBar.switchView(),this.dashboard.root.classList.toggle("view-hide"),this.list.root.classList.toggle("view-hide")}clear(){this.appBar.menu.items.get(p.open.key).hidden=!1,this.appBar.menu.items.get(p.save.key).hidden=!0,this.dashboard.setVisible(!1),this.list.clear(),this.dashboard.map.update(ct.a.nominations),this.progress.ctrl.close(),this.progress.ctrl.buffer=0,this.progress.ctrl.progress=0}show(){this.list.show(ct.a.nominations),this.dashboard.setVisible(!0),this.dashboard.map.fit(ct.a.nominations),this.dashboard.refresh(ct.a.nominations),this.appBar.menu.items.get(p.open.key).hidden=!0,this.appBar.menu.items.get(p.save.key).hidden=!1,this.appBar.menu.items.get(p.upload.key).hidden=!ct.a.auth.signedIn,this.appBar.menu.items.get(p.import.key).hidden=!1,this.progress.ctrl.close()}update(t){this.list.update(t),this.dashboard.update(ct.a.nominations)}openFileUI(t){const e=h.build("input",{cssText:"display:none;",type:"file",accept:"json"});e.addEventListener("change",t,!1),document.body.append(e),e.click(),setTimeout(()=>{e.remove()},1e3)}saveFileUI(t,e){const s=h.build("a",{cssText:"display:none",href:e,download:t});document.body.append(s),s.click(),s.remove()}}}}]);