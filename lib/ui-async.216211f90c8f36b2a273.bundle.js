(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{43:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var a=s(1);const i={card:"mdc-card mdc-card--outlined",actions:"mdc-card__actions",actionButtons:"mdc-card__action-buttons",actionIcons:"mdc-card__action-icons",iconAction:["fa","mdc-icon-button","mdc-card__action","mdc-card__action--icon"].join(" "),buttonAction:"mdc-button mdc-card__action mdc-card__action--button",buttonActionRipple:"mdc-button__ripple",buttonActionIcon:"fa fa-fw mdc-button__icon",buttonActionLabel:"mdc-button__label"};function n(t,e){return Object(a.a)("div",{className:`${i.card} ${t}`},e)}!function(t){t.actions=function(t){const e=Object(a.a)("div",{className:i.actions});return t.buttons&&e.append(Object(a.a)("div",{className:i.actionButtons},t.buttons)),t.icons&&e.append(Object(a.a)("div",{className:i.actionIcons},t.icons)),e},t.buttonAction=function(t,e){return Object(a.a)("button",{className:i.buttonAction},[Object(a.a)("div",{className:i.buttonActionRipple}),Object(a.a)("i",{className:i.buttonActionIcon,innerHTML:t}),Object(a.a)("span",{className:i.buttonActionLabel,innerHTML:e})])},t.iconAction=function(t,e){return Object(a.a)("button",{className:i.iconAction,title:e,innerHTML:t})}}(n||(n={}))},51:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var a=s(1);const i={textField:["mdc-text-field","mdc-text-field--outlined"].join(" "),textfieldTextarea:["mdc-text-field--textarea","mdc-text-field--fullwidth"].join(" "),textFieldWitchIcon:"mdc-text-field--with-leading-icon",textFieldIcon:["fa","mdc-text-field__icon","mdc-text-field__icon--leading"].join(" "),input:"mdc-text-field__input",outline:"mdc-notched-outline",outlineLeading:"mdc-notched-outline__leading",outlineNotch:"mdc-notched-outline__notch",label:"mdc-floating-label",outlineTrailing:"mdc-notched-outline__trailing",helper:"mdc-text-field-helper-line",helperText:"mdc-text-field-helper-text mdc-text-field-helper-text--persistent"};function n(t){let e=i.textField;const s=[];return t.textarea?(e+=" "+i.textfieldTextarea,s.push(Object(a.a)("textarea",{className:i.input,id:t.id,rows:8,cols:80}))):(t.icon&&(e+=" "+i.textFieldWitchIcon,s.push(Object(a.a)("i",{className:i.textFieldIcon,innerHTML:t.icon}))),s.push(Object(a.a)("input",{type:t.inputType,className:i.input,id:t.id}))),s.push(Object(a.a)("div",{className:i.outline},[Object(a.a)("div",{className:i.outlineLeading}),Object(a.a)("div",{className:i.outlineNotch},[Object(a.a)("label",{className:i.label,for:t.id,innerHTML:t.label})]),Object(a.a)("div",{className:i.outlineTrailing})])),Object(a.a)("div",{className:e},s)}!function(t){t.helper=function(t){return Object(a.a)("div",{className:i.helper},[Object(a.a)("div",{className:i.helperText},t)])}}(n||(n={}))},65:function(t,e,s){"use strict";s.r(e);var a,i=s(42),n=s.n(i),o=s(1),r=s(5),c=s(44),l=s.n(c),d=s(43);!function(t){class e extends r.a{constructor(){super(),this.root=null,Object.defineProperty(this,"root",{enumerable:!1})}update(t){}updateStyle(){}setVisible(t){if(!this.root){if(!t)return;this.render()}this.root.hidden=!t}}t.CardPrototype=e;t.ChartCardProtorype=class extends e{constructor(){super(...arguments),this.chart=null}},t.eliChartCard=function(t,e,s){return Object(d.a)(t,[Object(o.a)("div",{className:"content"},[Object(o.a)("span",{className:"title",innerHTML:e}),Object(o.a)("div",{className:"chart-container"},[s])])])},t.fillTimeDataMap=function(t,e,s){let a=e;for(;a<=s;){const e=l()(a+1e3).startOf("month"),s=e.valueOf();t.has(s)||t.set(s,0),a=e.endOf("month").valueOf()}}}(a||(a={}));var h,u=s(3),p=s(14),m=s(7);!function(t){class e extends a.CardPrototype{updateStats(t){}}t.CardPrototype=e;t.ChartCardPrototype=class extends e{constructor(){super(...arguments),this.chart=null}},t.eliChartCard=a.eliChartCard,t.fillTimeDataMap=a.fillTimeDataMap}(h||(h={}));const b="ui.dashboard.brainstorming.basic",g={title:b+".title",desc:b+".desc",refresh:b+".refresh",clear:b+".clear"};class f extends h.CardPrototype{constructor(){super(...arguments),this.actionRefresh=null,this.events={refresh:()=>{},clear:()=>{}}}render(){this.actionRefresh=d.a.buttonAction(m.a.Icon.syncAlt,u.a.t(g.refresh));const t=new p.a(this.actionRefresh);t.unbounded=!0,t.listen("click",(()=>{this.actionRefresh.disabled=!0,this.events.refresh()}));const e=d.a.iconAction(m.a.Icon.trash,u.a.t(g.clear)),s=new p.a(e);s.unbounded=!0,s.listen("click",(()=>{this.events.clear()})),this.root=Object(d.a)("bs-basic-card",[Object(o.a)("div",{className:"content"},[Object(o.a)("span",{className:"title",innerHTML:u.a.t(g.title)}),Object(o.a)("span",{className:"count",innerHTML:"0"}),Object(o.a)("span",{className:"desc",innerHTML:u.a.t(g.desc,{count:0})})]),d.a.actions({buttons:[this.actionRefresh],icons:[e]})]),this.setVisible(!1),this.parent.append(this.root)}updateStats(t){this.root.querySelector(".count").innerHTML=""+t.review,this.root.querySelector(".desc").innerHTML=u.a.t(g.desc,{count:t.nomination}),this.actionRefresh.disabled=!1}}var y=f,v=s(19);const j={title:"ui.dashboard.brainstorming.rates.title"};class O extends h.ChartCardPrototype{render(){const t=Object(o.a)("canvas",{});this.root=h.eliChartCard("bs-rates-card",u.a.t(j.title),t),this.setVisible(!1),this.parent.append(this.root);const e=[];for(const t of Object.values(v.a))e.push(u.a.t(t));const s=getComputedStyle(document.documentElement);this.chart=new n.a(t.getContext("2d"),{type:"radar",data:{labels:e,datasets:[{data:[],borderColor:s.getPropertyValue("--mdc-theme-primary"),pointRadius:0}]},options:{legend:{display:!1},scale:{ticks:{display:!1,min:1,max:5,stepSize:1},angleLines:{color:s.getPropertyValue("--mdc-theme-text-disabled-on-light")},gridLines:{color:s.getPropertyValue("--mdc-theme-text-disabled-on-light")}}}})}updateStats(t){const e=[];for(const s of Object.keys(v.a)){const a=t.rate.get(s),i=a.reduce(((t,e)=>t+e),0)/a.length;e.push(parseFloat(i.toFixed(2)))}this.chart.data.datasets[0].data=e,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.options.scale.angleLines.color=t.getPropertyValue("--mdc-theme-text-disabled-on-light"),this.chart.options.scale.gridLines.color=t.getPropertyValue("--mdc-theme-text-disabled-on-light"),this.chart.update()}}var w=O;const x={title:"ui.dashboard.brainstorming.reviews.title",desc:"ui.dashboard.brainstorming.reviews.desc"};class C extends h.ChartCardPrototype{render(){const t=Object(o.a)("canvas",{});this.root=h.eliChartCard("bs-reviews-card",u.a.t(x.title),t),this.setVisible(!1),this.parent.append(this.root);const e=getComputedStyle(document.documentElement);this.chart=new n.a(t.getContext("2d"),{type:"line",data:{labels:[],datasets:[{label:u.a.t(x.desc),data:[],borderColor:e.getPropertyValue("--mdc-theme-primary"),pointRadius:0}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{unit:"month",tooltipFormat:"YYYY-MM",displayFormats:{month:"YYYY-MM"}}}]}}})}updateStats(t){if(t.reviewTimes.length<1)return this.chart.data.datasets[0].data=[],void this.chart.update();const e=new Map;let s=l()(t.reviewTimes[0]).startOf("month").valueOf(),a=s;for(const i of t.reviewTimes){const t=l()(i).startOf("month").valueOf();t<s?s=t:t>a&&(a=t),e.has(t)?e.set(t,e.get(t)+1):e.set(t,1)}h.fillTimeDataMap(e,s,a);const i=[];e.forEach(((t,e)=>{i.push({t:e,y:t})})),i.sort(((t,e)=>t.t-e.t)),this.chart.data.datasets[0].data=i,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.update()}}var T=C;const L={title:"ui.dashboard.brainstorming.synch.title",desc:"ui.dashboard.brainstorming.synch.desc"};class k extends h.ChartCardPrototype{render(){this.root=Object(d.a)("bs-synch-card",[Object(o.a)("div",{className:"content"},[Object(o.a)("span",{className:"title",innerHTML:u.a.t(L.title)}),Object(o.a)("span",{className:"synch"},[Object(o.a)("span",{className:"number",innerHTML:"0.0"}),Object(o.a)("span",{className:"percent",innerHTML:"%"})]),Object(o.a)("span",{className:"desc",innerHTML:u.a.t(L.desc)})])]),this.setVisible(!1),this.parent.append(this.root)}updateStats(t){const e=t.synch.total>0?t.synch.synched/t.synch.total:0;this.root.querySelector(".number").innerHTML=""+(100*e).toFixed(1)}}var _=k;class S extends a.CardPrototype{constructor(){super(),this.basic=new y,this.rates=new w,this.synch=new _,this.reviews=new T,this.events={analyse:()=>({review:0,nomination:0,rate:new Map,reviewTimes:[],synch:{total:0,synched:0}})},Object.defineProperty(this,"events",{enumerable:!1})}init(t){this.forEach((e=>{e.init(t)}))}update(t){const e=this.events.analyse(t);this.forEach((t=>{t.updateStats(e)}))}updateStyle(){this.forEach((t=>{t.updateStyle()}))}setVisible(t){this.forEach((e=>{e.setVisible(t)}))}forEach(t){Object.values(this).forEach(t)}}var M=S;const N={title:"ui.dashboard.count-by-month.title",submissions:"ui.dashboard.count-by-month.submissions",results:"ui.dashboard.count-by-month.results"};class R extends a.ChartCardProtorype{render(){const t=Object(o.a)("canvas",{});this.root=a.eliChartCard("count-by-month-card",u.a.t(N.title),t),this.setVisible(!1),this.parent.append(this.root);const e=getComputedStyle(document.documentElement),s=e.getPropertyValue("--mdc-theme-primary"),i=e.getPropertyValue("--mdc-theme-secondary");this.chart=new n.a(t.getContext("2d"),{type:"line",data:{labels:[],datasets:[{label:u.a.t(N.submissions),data:[],borderColor:s,pointBackgroundColor:s,pointRadius:0,fill:!1},{label:u.a.t(N.results),data:[],borderColor:i,pointBackgroundColor:i,pointRadius:0,fill:!1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{unit:"month",tooltipFormat:"YYYY-MM",displayFormats:{month:"YYYY-MM"}}}]},tooltips:{mode:"x"}}})}update(t){if(0===t.length)return this.chart.data.datasets[0].data=[],this.chart.data.datasets[1].data=[],void this.chart.update();const e=new Map,s=new Map;let i=l()(t[0].confirmedTime).startOf("month").valueOf(),n=i;for(const a of t){if(a.confirmedTime>0){const t=l()(a.confirmedTime).startOf("month").valueOf();t<i?i=t:t>n&&(n=t),e.has(t)?e.set(t,e.get(t)+1):e.set(t,1)}if(a.resultTime>0){const t=l()(a.resultTime).startOf("month").valueOf();t>n&&(n=t),s.has(t)?s.set(t,s.get(t)+1):s.set(t,1)}}a.fillTimeDataMap(e,i,n),a.fillTimeDataMap(s,i,n);const o=[],r=[];e.forEach(((t,e)=>{o.push({t:e,y:t})})),s.forEach(((t,e)=>{r.push({t:e,y:t})})),o.sort(((t,e)=>t.t-e.t)),r.sort(((t,e)=>t.t-e.t)),this.chart.data.datasets[0].data=o,this.chart.data.datasets[1].data=r,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.data.datasets[1].borderColor=t.getPropertyValue("--mdc-theme-secondary"),this.chart.update()}}var D=R,I=s(74),P=s(0);const A={title:"ui.dashboard.filter.title",type:"ui.dashboard.filter.type",rejected:"ui.dashboard.filter.rejected"},H="mdc-switch",V="mdc-switch__track",E="mdc-switch__thumb-underlay",F="mdc-switch__thumb",B="mdc-switch__native-control";class q extends a.CardPrototype{constructor(){super(...arguments),this.types=new Map,this.reasons=new Map,this.events={switchType:()=>{},switchReason:()=>{}}}render(){const t=Object(o.a)("div",{className:"type-box"}),e=Object(o.a)("div",{className:"reason-box"});this.root=Object(d.a)("filter-card",[Object(o.a)("div",{className:"content"},[Object(o.a)("span",{className:"title",innerHTML:u.a.t(A.title)}),Object(o.a)("span",{className:"subtitle",innerHTML:u.a.t(A.type)}),t,Object(o.a)("span",{className:"subtitle",innerHTML:u.a.t(A.rejected)}),e])]),this.setVisible(!1),this.parent.append(this.root);for(const e of P.a.status.types.values()){const s=q.buildSwitch(t,e,e.key);s.listen("change",(()=>this.switchType(e,s.checked))),this.types.set(e,s)}for(const t of P.a.status.reasons.values()){const s=q.buildSwitch(e,t,"rejected");s.listen("change",(()=>{this.switchReason(t,s.checked)})),this.reasons.set(t,s)}}switchType(t,e){if(t.code>100)for(const t of this.reasons.values())t.checked=e;this.events.switchType(t,e)}switchReason(t,e){this.events.switchReason(t,e);const s=P.a.status.types.get("rejected");e&&!this.types.get(s).checked&&(this.types.get(s).checked=!0,this.events.switchType(s,!0))}getFilter(t){const e=new Map;for(const[s,a]of t.entries())a.checked&&e.set(s.code,a.checked);return e}get typeFilter(){return this.getFilter(this.types)}get reasonFilter(){return this.getFilter(this.reasons)}static buildSwitch(t,e,s){const a="switch-filter-"+e.key,i=function(t){return Object(o.a)("div",{className:H},[Object(o.a)("div",{className:V}),Object(o.a)("div",{className:E},[Object(o.a)("div",{className:F}),Object(o.a)("input",{type:"checkbox",className:B,id:t,role:"switch"})])])}(a),n=Object(o.a)("div",{},[i,Object(o.a)("label",{className:"fa fa-fw status-"+s,for:a,title:u.a.t(e.title),innerHTML:e.icon})]);t.append(n);const r=new I.a(i);return r.checked=!0,r}}var z=s(50),Y=s.n(z);s(57);class $ extends a.CardPrototype{constructor(){super(...arguments),this.ctrl=null,this.events={focus:()=>{},styleLoaded:()=>[]},this.enabledReasons=[],this.tasks=[]}render(){const t=Object(o.a)("div",{});this.root=Object(d.a)("map-card",[t]),this.parent.append(this.root),Y.a.accessToken="pk.eyJ1IjoibHVja2EtbWUiLCJhIjoiY2p2NDk5NmRvMHFreTQzbzduemM1MHV4cCJ9.7XGmxnEJRoCDr-i5BBmBfw",this.ctrl=new Y.a.Map({container:t,style:$.getStyle()}),this.ctrl.on("idle",(()=>this.executeTasks())),this.ctrl.addControl(new Y.a.NavigationControl),this.ctrl.addControl(new Y.a.FullscreenControl),this.resize()}get loaded(){return this.ctrl&&this.ctrl.isStyleLoaded()}update(t){this.loaded?(this.updateRejected(t),this.updateSource("accepted",$.generateGeoJSON(t,[P.a.status.types.get("accepted").code])),this.updateSource("pending",$.generateGeoJSON(t,[P.a.status.types.get("pending").code]))):this.tasks.push((()=>this.update(t)))}updateStyle(){this.loaded?(this.ctrl.setStyle($.getStyle()),this.update(this.events.styleLoaded())):this.tasks.push((()=>this.updateStyle()))}set reasonFilter(t){this.enabledReasons=[];for(const[e,s]of t.entries())s&&this.enabledReasons.push(e)}setTypeVisible(t,e){if(!this.loaded)return void this.tasks.push((()=>this.setTypeVisible(t,e)));const s=e?"visible":"none";this.ctrl.setLayoutProperty(`potori-${t}-cluster`,"visibility",s),this.ctrl.setLayoutProperty(`potori-${t}-count`,"visibility",s),this.ctrl.setLayoutProperty(`potori-${t}-unclustered`,"visibility",s)}easeTo(t){if(!this.loaded)return void this.tasks.push((()=>this.easeTo(t)));const e=this.ctrl.getZoom();this.ctrl.easeTo({center:t,zoom:e<15?15:e})}resize(){this.loaded?this.ctrl.resize():this.tasks.push((()=>this.resize()))}fit(t){if(!this.loaded)return void this.tasks.push((()=>this.fit(t)));const e={lng:-181,lat:-91},s={lng:181,lat:91};for(const a of t)a.lngLat&&(a.lngLat.lng>e.lng&&(e.lng=a.lngLat.lng),a.lngLat.lng<s.lng&&(s.lng=a.lngLat.lng),a.lngLat.lat>e.lat&&(e.lat=a.lngLat.lat),a.lngLat.lat<s.lat&&(s.lat=a.lngLat.lat));s.lng>-181&&this.ctrl.fitBounds([s,e],{linear:!0})}updateRejected(t){this.loaded?this.updateSource("rejected",$.generateGeoJSON(t,this.enabledReasons)):this.tasks.push((()=>this.updateRejected(t)))}executeTasks(){const t=this.tasks.length;for(let e=0;e<t;e++)this.tasks.shift()()}updateSource(t,e){const s="potori-"+t,a=this.ctrl.getSource(s);if(a)return void a.setData(e);this.ctrl.addSource(s,{type:"geojson",data:e,cluster:!0});const i=getComputedStyle(document.documentElement),n=i.getPropertyValue("--color-"+t),o=i.getPropertyValue(`--color-${t}--dark`);this.ctrl.addLayer({id:s+"-cluster",type:"circle",source:s,filter:["has","point_count"],paint:{"circle-color":n,"circle-opacity":.6,"circle-stroke-width":4,"circle-stroke-color":o,"circle-radius":["step",["get","point_count"],20,50,30,100,40]}}),this.ctrl.addLayer({id:s+"-count",type:"symbol",source:s,filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":getComputedStyle(document.documentElement).getPropertyValue("--mdc-theme-on-surface")}}),this.ctrl.addLayer({id:s+"-unclustered",type:"circle",source:s,filter:["!",["has","point_count"]],paint:{"circle-color":n,"circle-radius":5,"circle-stroke-width":2,"circle-stroke-color":o}}),this.ctrl.on("click",s+"-cluster",(t=>{const e=this.ctrl.queryRenderedFeatures(t.point,{layers:[s+"-cluster"]}),a=e[0].properties.cluster_id;this.ctrl.getSource(s).getClusterExpansionZoom(a,((t,s)=>{t||this.ctrl.easeTo({center:e[0].geometry.coordinates,zoom:s})}))})),this.ctrl.on("click",s+"-unclustered",(t=>{t.features[0].geometry.coordinates;const e=t.features[0].geometry.coordinates;for(;Math.abs(t.lngLat.lng-e[0])>180;)e[0]+=t.lngLat.lng>e[0]?360:-360;(new Y.a.Popup).setLngLat(e).setText(t.features[0].properties.title).addTo(this.ctrl),this.events.focus(t.features[0].properties.id)}))}static generateGeoJSON(t,e){const s={type:"FeatureCollection",features:[]};if(e.length<1)return s;for(const a of t)e.includes(a.status.code)&&a.lngLat&&s.features.push({type:"Feature",properties:{id:a.id,title:a.title,status:a.status},geometry:{type:"Point",coordinates:[a.lngLat.lng,a.lngLat.lat]}});return s}static getStyle(){return`mapbox://styles/mapbox/${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`}}var U=$;const J={title:"ui.dashboard.quotas.title",xAxis:"ui.dashboard.quotas.xAxis"};class W extends a.ChartCardProtorype{render(){const t=Object(o.a)("canvas",{});this.root=a.eliChartCard("quotas-card",u.a.t(J.title),t),this.setVisible(!1),this.parent.append(this.root);const e=[];for(let t=0;t<14;t++)e.push(""+t);const s=getComputedStyle(document.documentElement);this.chart=new n.a(t.getContext("2d"),{type:"bar",data:{labels:e,datasets:[{data:[],backgroundColor:s.getPropertyValue("--mdc-theme-primary"),hoverBackgroundColor:s.getPropertyValue("--mdc-theme-primary")}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{scaleLabel:{display:!0,labelString:u.a.t(J.xAxis)}}]}}})}update(t){const e=new Array(14).fill(0),s=Date.now();for(const a of t){const t=a.restoreTime;t>s&&(e[Math.floor((t-s)/864e5)]+=1)}this.chart.data.datasets[0].data=e,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].backgroundColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.data.datasets[0].hoverBackgroundColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.update()}}var G=W;const Z={title:"ui.dashboard.stats-rejected.title"};class K extends a.ChartCardProtorype{render(){const t=Object(o.a)("canvas",{});this.root=a.eliChartCard("stats-rejected-card",u.a.t(Z.title),t),this.setVisible(!1),this.parent.append(this.root),this.chart=new n.a(t.getContext("2d"),{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:[],borderAlign:"inner",borderColor:"rgba(0, 0, 0, 0.2)",hoverBackgroundColor:[],hoverBorderColor:"rgba(0, 0, 0, 0.4)"}]},options:{legend:{display:!0,position:"right"}}})}update(t){const e=new Map;for(const t of P.a.status.reasons.values())e.set(t,0);t.reduce(((t,e)=>{if(e.status.code<100)return t;const s=e.status;return t.set(s,t.get(s)+1),t}),e);const s=[],a=[],i=[];for(const[t,n]of e.entries())n<1||(s.push(u.a.t(t.title)),a.push(t.color),i.push(n));this.chart.data.labels=s,this.chart.data.datasets[0].data=i,this.chart.data.datasets[0].backgroundColor=a,this.chart.data.datasets[0].hoverBackgroundColor=a,this.chart.update()}}var Q=K;const X={title:"ui.dashboard.stats-type.title"};class tt extends a.ChartCardProtorype{render(){const t=Object(o.a)("canvas",{});this.root=a.eliChartCard("stats-type-card",u.a.t(X.title),t),this.setVisible(!1),this.parent.append(this.root),this.chart=new n.a(t.getContext("2d"),{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:[],borderAlign:"inner",borderColor:"rgba(0, 0, 0, 0.2)",hoverBackgroundColor:[],hoverBorderColor:"rgba(0, 0, 0, 0.4)"}]},options:{legend:{display:!0,position:"right"}}})}update(t){const e=new Map;for(const t of P.a.status.types.values())e.set(t.key,0);t.reduce(((t,e)=>{const s=e.status.code>100?"rejected":e.status.key;return t.set(s,t.get(s)+1),t}),e);const s=[],a=[],i=[],n=getComputedStyle(document.documentElement);for(const[t,o]of e.entries()){if(o<1)continue;const e=P.a.status.types.get(t);s.push(u.a.t(e.title)),a.push(n.getPropertyValue("--color-"+t)),i.push(o)}this.chart.data.labels=s,this.chart.data.datasets[0].data=i,this.chart.data.datasets[0].backgroundColor=a,this.chart.data.datasets[0].hoverBackgroundColor=a,this.chart.update()}}var et=tt;class st extends r.a{constructor(){super(),this.root=null,this.map=new U,this.filter=new q,this.statsType=new et,this.statsRejected=new Q,this.countByMonth=new D,this.quotas=new G,this.bs=new M,Object.defineProperty(this,"root",{enumerable:!1})}init(t){super.init(t),n.a.defaults.global.legend.labels.boxWidth=10,n.a.defaults.global.maintainAspectRatio=!1,n.a.defaults.line.tooltips={intersect:!1},n.a.defaults.doughnut.tooltips={callbacks:{label:(t,e)=>{const s=e.datasets[t.datasetIndex],a=s._meta,i=a[Object.keys(a)[0]].data,n=s.data.reduce(((t,e,s)=>t+(i[s].hidden?0:e)),0),o=s.data[t.index],r=(o/n*100).toFixed(2);return`${e.labels[t.index]}: ${o} (${r}%)`}}},n.a.defaults.radar.tooltips={intersect:!1,callbacks:{title:(t,e)=>e.labels[t[0].index]}},this.render(),this.forEach((t=>{t.init(this.root)}))}render(){this.root=Object(o.a)("div",{className:"dashboard"}),this.parent.append(this.root)}refresh(t){this.map.reasonFilter=this.filter.reasonFilter,this.forEach((e=>{e.update(t)}))}update(t){this.map.reasonFilter=this.filter.reasonFilter,this.map.update(t),this.statsType.update(t),this.statsRejected.update(t),this.countByMonth.update(t),this.bs.update(t)}updateStyle(){this.forEach((t=>{t.updateStyle()}))}setVisible(t){this.forEach((e=>{e.setVisible(t)})),this.map.resize()}switchView(){this.root.classList.toggle("view-hide")}forEach(t){Object.values(this).forEach(t)}}e.default=st},69:function(t,e,s){"use strict";s.r(e);var a=s(3),i=s(68),n=s(39),o=s(76),r=s(75),c=s(14),l=s(66),d=s(1);const h="mdc-chip",u="mdc-chip__ripple",p="mdc-chip__primary-action",m="mdc-chip__text",b="mdc-chip-set mdc-chip-set--choice";var g=s(9),f=s(7),y=s(18);const v="mdc-radio",j="mdc-radio__native-control",O="mdc-radio__background",w="mdc-radio__outer-circle",x="mdc-radio__inner-circle";function C(t,e,s,a){const i=Object(d.a)("input",{type:"radio",className:j,id:t,name:e,value:s});return i.addEventListener("change",(t=>{const e=t.target;a(e.value)})),Object(d.a)("div",{className:v},[i,Object(d.a)("div",{className:O},[Object(d.a)("div",{className:w}),Object(d.a)("div",{className:x})])])}(C||(C={})).form=function(t,e,s,a){return Object(d.a)("div",{className:"mdc-form-field"},[t,Object(d.a)("label",{for:s,className:a||"",innerHTML:e})])};var T=s(51),L=s(0),k=s(10);const _="ui.dialog.details",S="save",M={resultTime:_+".resultTime",reason:_+".reason",save:_+".save",messageInvalidTime:`message:${_}.invalidTime`};var N=s(50),R=s.n(N),D=s(5);class I extends D.a{constructor(){super(...arguments),this.ctrl=null,this.marker=null,this.buttons={edit:{ctrl:null,icon:f.a.Icon.edit,clicked:()=>this.edit()},search:{ctrl:null,icon:f.a.Icon.search,clicked:()=>this.search()},delete:{ctrl:null,icon:f.a.Icon.trash,clicked:()=>this.delete()}},this.opened=!1,this.events={alert:()=>{},queryLngLat:()=>{}}}init(t){super.init(t),this.render()}render(){const t=Object(d.a)("div",{className:"map"});this.parent.append(Object(d.a)("div",{className:"details-map"},[Object(d.a)("div",{className:"buttons"},Object.values(this.buttons).map((t=>{const e=Object(y.a)(t.icon);return t.ctrl=new c.a(e),t.ctrl.unbounded=!0,t.ctrl.listen("click",t.clicked),e}))),t])),this.ctrl=new R.a.Map({container:t,style:I.style}),this.ctrl.addControl(new R.a.NavigationControl)}updateStyle(){this.ctrl&&this.ctrl.setStyle(I.style)}set lngLat(t){this.delete(),t&&s.e(0).then(s.t.bind(null,50,7)).then((e=>{this.marker=(new e.Marker).setLngLat(t).addTo(this.ctrl),this.ctrl.jumpTo({center:t,zoom:16}),this.buttons.delete.ctrl.disabled=!1,this.buttons.edit.ctrl.root.innerHTML=f.a.Icon.edit})),this.buttons.search.ctrl.disabled=!1}get lngLat(){return this.marker?this.marker.getLngLat():null}layout(){this.ctrl.resize();for(const t of Object.values(this.buttons))t.ctrl.layout()}edit(){this.marker?this.marker.setDraggable(!0):s.e(0).then(s.t.bind(null,50,7)).then((t=>{this.marker=(new t.Marker).setLngLat(this.ctrl.getCenter()).setDraggable(!0).addTo(this.ctrl),this.buttons.delete.ctrl.disabled=!1,this.buttons.edit.ctrl.root.innerHTML=f.a.Icon.edit}))}search(){this.buttons.search.ctrl.disabled=!0,this.events.queryLngLat((t=>{this.opened&&(this.marker?(this.marker.setLngLat(t),this.marker.setDraggable(!1)):s.e(0).then(s.t.bind(null,50,7)).then((e=>{this.marker=(new e.Marker).setLngLat(t).setDraggable(!1).addTo(this.ctrl)})),this.ctrl.easeTo({center:t,zoom:16}),this.buttons.edit.ctrl.root.innerHTML=f.a.Icon.edit,this.buttons.search.ctrl.disabled=!1,this.buttons.delete.ctrl.disabled=!1)}),(t=>{this.opened&&(this.events.alert(a.a.t(t)),this.buttons.search.ctrl.disabled=!1)}))}delete(){this.marker&&this.marker.remove(),this.marker=null,this.buttons.edit.ctrl.root.innerHTML=f.a.Icon.plus,this.buttons.delete.ctrl.disabled=!0}static get style(){return`mapbox://styles/mapbox/${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`}}class P extends k.a.DialogPrototype{constructor(){super(...arguments),this._nomination=null,this.textConfirmedTime=null,this.status=new Map,this.selectedStatus=null,this.fieldResultTime=null,this.blockReason=null,this.fieldReason=null,this.chipSetReason=null,this.map=new I,this.events={alert:()=>{},query:()=>{},update:()=>{}}}render(){const t=[];this.textConfirmedTime=Object(d.a)("span",{}),t.push(Object(d.a)("div",{className:"confirmed-time"},[Object(f.a)(f.a.Icon.arrowUp),this.textConfirmedTime]));const e=[];for(const t of L.a.status.types.keys()){const s="radio-dialog-details-status-"+t,a=C(s,"radio-dialog-details-status",t,(t=>{this.selectedStatus=t,this.fieldResultTime.root.hidden="pending"===t,this.fieldResultTime.layout(),this.blockReason.hidden=!("rejected"===t),this.map.layout()})),i=C.form(a,L.a.status.types.get(t).icon,s,"fa status-"+t),n=new r.a(a);this.status.set(t,n);new o.a(i).input=n,e.push(i)}t.push(Object(d.a)("div",{className:"status-form"},e));const s=Object(T.a)({id:"input-dialog-details-result-time",label:a.a.t(M.resultTime),icon:f.a.Icon.calendarAlt,inputType:"datetime-local"});s.classList.add("result-time"),t.push(s);const v=Object(T.a)({id:"input-dialog-details-reason",label:a.a.t(M.reason),icon:" ",inputType:"text"}),j=[];for(const[t,e]of L.a.status.reasons)j.push({id:"details-reason-"+t,text:a.a.t(e.title)});const O=(w=j,Object(d.a)("div",{className:b,role:"grid",hidden:!0},w.map((t=>Object(d.a)("div",{className:h,id:t.id,role:"row"},[Object(d.a)("div",{className:u}),Object(d.a)("span",{role:"gridcell"},[Object(d.a)("span",{className:p,role:"button"},[Object(d.a)("span",{className:m,innerHTML:t.text})])])])))));var w;this.chipSetReason=new i.a(O);const x=Object(y.a)(f.a.Icon.angleDown),_=new c.a(x);_.unbounded=!0,_.listen("click",(()=>{O.hidden=!O.hidden,x.innerHTML=O.hidden?f.a.Icon.angleDown:f.a.Icon.angleUp,this.map.layout()})),this.blockReason=Object(d.a)("div",{className:"reason-selector"},[Object(d.a)("div",{className:"controller"},[v,x]),O]);for(const t of this.chipSetReason.chips)t.listen("MDCChip:selection",(()=>{const t=this.chipSetReason.selectedChipIds.length>0?this.chipSetReason.selectedChipIds[0].replace("details-reason-",""):"undeclared",e=L.a.status.reasons.get(t);this.fieldReason.leadingIconContent=e.icon,this.fieldReason.value=a.a.t(e.title)}));t.push(this.blockReason);const N=Object(g.a)("details-dialog",{title:" ",contents:t,actions:[{action:k.a.Action.close,text:a.a.t(k.a.StringKey.close)},{action:S,text:a.a.t(M.save)}]});this.parent.append(N);const R=N.querySelector(".mdc-dialog__content");N.querySelector(".mdc-dialog__surface").insertBefore(Object(d.a)("img",{}),R),this.map.init(R),this.map.events.alert=t=>this.events.alert(t),this.map.events.queryLngLat=(t,e)=>{this.events.query(this._nomination,(e=>t({lng:parseFloat(e.lng),lat:parseFloat(e.lat)})),e)},this.fieldResultTime=new l.a(s),this.fieldReason=new l.a(v),this.fieldReason.disabled=!0,this.ctrl=new n.a(N),this.ctrl.listen("MDCDialog:opened",(()=>this.opened())),this.ctrl.listen("MDCDialog:closed",(t=>this.closed(t))),_.layout()}updateStyle(){this.map.updateStyle()}set nomination(t){this.ctrl||this.render(),this._nomination=t,this.map.lngLat=t.lngLat;const e=t.status.type;this.ctrl.root.querySelector(".mdc-dialog__title").innerHTML=t.title,this.ctrl.root.querySelector("img").src=t.imageUrl,this.textConfirmedTime.innerHTML=new Date(t.confirmedTime).toLocaleString(),this.fieldResultTime.root.hidden="pending"===e;const s=t=>{const e=new Date;return e.setTime(t-6e4*e.getTimezoneOffset()),e.toISOString()},i=s(t.resultTime?t.resultTime:Date.now());if(this.fieldResultTime.value=i.slice(0,i.lastIndexOf(":")),this.blockReason.hidden=!("rejected"===e),"rejected"===e){const e="details-reason-"+t.status.key;this.chipSetReason.chips.forEach((t=>{t.selected=t.id===e})),this.fieldReason.leadingIconContent=t.status.icon,this.fieldReason.value=a.a.t(t.status.title)}"pending"===e&&this.events.query(t,(t=>{const e=s(t.lastTime);this.fieldResultTime.value=e.slice(0,e.lastIndexOf(":")),this.fieldResultTime.layout()}),(()=>{})),this.status.get(e).checked=!0,this.selectedStatus=e}opened(){this.fieldResultTime.layout(),this.fieldReason.layout(),this.map.layout(),this.map.opened=!0}closed(t){if(this.map.opened=!1,t.detail.action!==S)return;const e=this._nomination.status.type,s=this._nomination.status.code<100?null:this._nomination.status;let i=!1;if("pending"!==this.selectedStatus){const t=Date.parse(this.fieldResultTime.value);if(!t)return void this.events.alert(a.a.t(M.messageInvalidTime));const e=t+6e4*(new Date).getTimezoneOffset();this._nomination.resultTime&&Math.floor(this._nomination.resultTime/6e4)===Math.floor(e/6e4)||(this._nomination.resultTime=e,i=!0)}const n=this.chipSetReason.selectedChipIds.length>0?this.chipSetReason.selectedChipIds[0].replace("details-reason-",""):"undeclared";(this.selectedStatus!==e||"rejected"===e&&s.key!==n)&&(i=!0);const o=this.map.lngLat;o?this._nomination.lngLat&&this._nomination.lngLat.lng===o.lng&&this._nomination.lngLat.lat===o.lat||(this._nomination.lngLat=o,i=!0):this._nomination.lngLat&&(this._nomination.lngLat=null,i=!0),i&&("rejected"!==this.selectedStatus?this._nomination.status=L.a.status.types.get(this.selectedStatus):this._nomination.status=L.a.status.reasons.get(n),this.events.update(this._nomination))}}e.default=P},70:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return m}));var a=s(3),i=s(1),n=s(0),o=s(5),r=s(14),c=s(43),l=s(7);const d="ui.nomination-list.card",h={location:d+".location",intelMap:d+".intelMap",bsWatermeter:d+".bsWatermeter"};class u{static build(t){const e=Object(c.a)("nomination-card",[Object(i.a)("div",{className:"info-box"},[Object(i.a)("img",{src:t.imageUrl,loading:"lazy"}),Object(i.a)("div",{},[Object(i.a)("span",{innerHTML:t.title}),Object(i.a)("div",{})])]),c.a.actions({buttons:[],icons:[]})]);return e.id="card-"+t.id,e}static update(t,e,s,i){const o=t.querySelector(".info-box > div > div");o.innerHTML="",o.append(u.buildDetail(l.a.Icon.arrowUp,e.confirmedDateString));e.restoreTime>s&&o.append(u.buildDetail(l.a.Icon.redoAlt,e.restoreIntervalString)),e.confirmedTime>0&&o.append(u.buildDetail(l.a.Icon.clock,e.intervalString));const d=e.status.type;e.status.code>0&&o.append(u.buildDetail(n.a.status.types.get(d).icon,e.resultDateString));const p=t.querySelector(".mdc-card__action-buttons");p.innerHTML="";const m=c.a.buttonAction(e.status.icon,a.a.t(e.status.title));m.classList.add("status-"+d),p.append(m);const b=new r.a(m);b.unbounded=!0,b.listen("click",i.openDetails);const g=t.querySelector(".mdc-card__action-icons");g.innerHTML="",e.lngLat&&(g.append(u.buildIconAction(l.a.Icon.mapMarkerAlt,h.location,i.focus)),n.a.version.full&&g.append(u.buildIconAction(l.a.Icon.globe,h.intelMap,(()=>window.open(e.intelUrl,"_blank","noopener"))))),n.a.bs.beforeCreate(e)||g.append(u.buildIconAction(l.a.Icon.brain,h.bsWatermeter,i.openBs))}static buildDetail(t,e){return Object(i.a)("span",{},[Object(l.a)(t),Object(i.a)("span",{innerHTML:e})])}static buildIconAction(t,e,s){const i=c.a.iconAction(t,a.a.t(e)),n=new r.a(i);return n.unbounded=!0,n.listen("click",s),i}}const p={messageBsIdCopied:"message:ui.nomination-list.bsIdCopied"};class m extends o.a{constructor(){super(...arguments),this.root=null,this.now=Date.now(),this.events={alert:()=>{},focus:()=>{},openDetails:()=>{}}}init(t){super.init(t),this.render()}render(){this.root=Object(i.a)("div",{className:"list-view view-hide"}),this.parent.append(this.root)}clear(){this.root.innerHTML=""}show(t){this.clear();const e=t.map((t=>{const e=u.build(t);return u.update(e,t,this.now,this.createCardEvents(t)),e}));this.root.append(...e)}update(t,e){const s=this.root.querySelector("#card-"+t.id);u.update(s,t,this.now,this.createCardEvents(t)),s.hidden=!e}focus(t){const e=this.root.offsetTop+8,s=this.root.querySelector("#card-"+t);this.root.scrollTo(0,s.offsetTop-e)}switchView(){this.root.classList.toggle("view-hide")}createCardEvents(t){return{focus:()=>{this.events.focus(t)},openBs:()=>{n.a.version.full?window.open(t.bsUrl,"_blank","noopener"):(i.a.copy(t.id),this.events.alert(a.a.t(p.messageBsIdCopied,{id:t.id})))},openDetails:()=>this.events.openDetails(t)}}}},71:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return m})),s.d(e,"AppBarMenuItems",(function(){return p.a}));var a=s(3),i=s(67),n=s(1);const o="mdc-menu-surface--anchor",r="mdc-menu mdc-menu-surface",c="mdc-list",l="mdc-list-item",d="mdc-list-item__text";function h(t){return Object(n.a)("div",{className:o},[Object(n.a)("div",{className:r},[Object(n.a)("ul",{className:c,role:"menu",ariaHidden:!0,ariaOrientation:"vertical"},t)])])}(h||(h={})).item=function(t,e){return Object(n.a)("li",{className:l,role:"menuitem",dataset:{code:t}},[Object(n.a)("span",{className:d,innerHTML:e})])};var u=s(5),p=s(17);class m extends u.a{constructor(){super(...arguments),this.ctrl=null,this.items=new Map,this.events=new Map}init(t){super.init(t),this.render()}render(){const t=h(Object.values(p.a).map((t=>{const e=h.item(t.key,a.a.t(t.title));return this.items.set(t.key,e),e})));this.items.get(p.a.about.key).hidden=!1,this.parent.append(t),this.ctrl=new i.a(t.querySelector(".mdc-menu")),this.ctrl.listen("MDCMenu:selected",(t=>{this.events.get(t.detail.item.dataset.code)()}))}open(){this.ctrl.open||(this.ctrl.open=!0)}}},72:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return u}));var a=s(3),i=s(39),n=s(66),o=s(9),r=s(51),c=s(10);const l="import",d="https://wayfarer.nianticlabs.com/api/v1/vault/manage",h={title:"ui.dialog.import.title",json:"ui.dialog.import.json",from:"ui.dialog.import.from",wayfarer:"ui.dialog.import.wayfarer",import:"ui.dialog.import.import"};class u extends c.a.DialogPrototype{constructor(){super(...arguments),this.textField=null,this.import=()=>{}}render(){const t=Object(r.a)({id:"input-dialog-import-wayfarer",label:a.a.t(h.json),textarea:!0}),e=Object(o.a)("import-dialog",{title:a.a.t(h.title),contents:[t,r.a.helper([a.a.t(h.from),o.a.link(a.a.t(h.wayfarer),d)])],actions:[{action:c.a.Action.close,text:a.a.t(c.a.StringKey.close)},{action:l,text:a.a.t(h.import)}]});this.parent.append(e),this.ctrl=new i.a(e),this.textField=new n.a(t),this.ctrl.listen("MDCDialog:closed",(t=>{t.detail.action===l&&this.import(this.textField.value)}))}open(){super.open(),this.textField.value=""}}},73:function(t,e,s){"use strict";s.r(e);var a=s(3),i=s(39),n=s(1),o=s(7),r=s(0),c=s(10);const l="no",d="yes",h="https://wayfarer.nianticlabs.com/img/missing_image.png",u={title:"ui.dialog.match.title",desc:"ui.dialog.match.desc",no:"ui.dialog.match.no",yes:"ui.dialog.match.yes"};var p=s(9);class m extends c.a.DialogPrototype{constructor(){super(...arguments),this.content=null,this.events={close:()=>{}}}render(){const t=Object(p.a)("match-dialog",{title:a.a.t(u.title),contents:[],actions:[{action:l,text:a.a.t(u.no)},{action:d,text:a.a.t(u.yes)}]});this.parent.append(t),this.content=t.querySelector(".mdc-dialog__content"),this.ctrl=new i.a(t),this.ctrl.listen("MDCDialog:closed",(t=>{this.events.close(t.detail.action===d)}))}set nominations(t){this.ctrl||this.render(),this.content.innerHTML="",this.content.append(a.a.t(u.desc));for(const e of t)this.buildBlock(e)}buildBlock(t){const e=[this.buildDetail(o.a.Icon.arrowUp,t.confirmedDateString)];if(t.status.code>0){const s=t.status.type;e.push(this.buildDetail(r.a.status.types.get(s).icon,t.resultDateString));const i=this.buildDetail(t.status.icon,a.a.t(t.status.title));i.classList.add("status-"+s),e.push(i)}const s=Object(n.a)("div",{className:"nomination-block"},[Object(n.a)("img",{src:t.image.length>0?t.imageUrl:h}),Object(n.a)("div",{},[Object(n.a)("span",{innerHTML:t.title}),Object(n.a)("div",{},e)])]);this.content.append(s)}buildDetail(t,e){return Object(n.a)("span",{},[Object(o.a)(t),Object(n.a)("span",{innerHTML:e})])}}e.default=m}}]);