(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1:function(e,t,i){"use strict";i.d(t,"b",(function(){return o}));var s=i(10),a=i.n(s);i.d(t,"c",(function(){return a.a}));var n=i(12);i.d(t,"a",(function(){return n.a}));class o{constructor(){this.parent=null,Object.defineProperty(this,"parent",{enumerable:!1})}init(e){this.parent=e}render(){}}},12:function(e,t,i){"use strict";class s{static build(e,t,i){const s=document.createElement(e);for(const[e,i]of Object.entries(t))switch(e){case"cssText":s.style.cssText=i;break;case"dataset":for(const[e,t]of Object.entries(i))s.dataset[e]=t;break;default:s[e]=i}return i&&s.append(...i),s}static link(e,t,i){return s.build("a",{href:e,title:t,target:"_blank",rel:"noopener",innerHTML:i})}static icon(e){return s.build("i",{className:"fa fa-fw",innerHTML:e})}}t.a=s},18:function(e,t,i){"use strict";var s=i(2);class a extends s.c{constructor(){super(...arguments),this.textMessage=null}render(){this.textMessage=s.a.build("div",{className:"mdc-dialog__content"});const e=s.c.buildDialog([this.textMessage,s.a.build("footer",{className:"mdc-dialog__actions"},[s.c.buildDialogAction("close",s.d.t("Close"))])]);this.parent.append(e),this.ctrl=new s.b(e)}open(e){this.ctrl||this.render(),this.ctrl.open(),this.textMessage.innerHTML=e}}t.a=new a},2:function(e,t,i){"use strict";i.d(t,"c",(function(){return n}));var s=i(42);i.d(t,"b",(function(){return s.a}));var a=i(1);i.d(t,"a",(function(){return a.a})),i.d(t,"d",(function(){return a.c}));class n extends a.b{constructor(){super(...arguments),this.ctrl=null}static buildDialog(e){return a.a.build("div",{className:"mdc-dialog mdc-dialog--scrollable",role:"dialog",ariaModal:!0},[a.a.build("div",{className:"mdc-dialog__container"},[a.a.build("div",{className:"mdc-dialog__surface"},e)]),a.a.build("div",{className:"mdc-dialog__scrim"})])}static buildDialogAction(e,t){return a.a.build("button",{className:"mdc-button mdc-dialog__button",dataset:{mdcDialogAction:e}},[a.a.build("span",{className:"mdc-button__label",innerHTML:t})])}}},36:function(e,t,i){"use strict";var s=i(10),a=i.n(s),n=i(35),o=i(13),l=i(55),d=i(1);const r={open:{key:"open",title:"Open"},save:{key:"save",title:"Save"},upload:{key:"upload",title:"Upload"},import:{key:"import",title:"Import"},about:{key:"about",title:"About"},signout:{key:"signout",title:"Sign Out"}};class c extends d.b{constructor(){super(...arguments),this.ctrl=null,this.items=new Map,this.events=new Map}init(e){super.init(e),this.render()}render(){const e=d.a.build("ul",{className:"mdc-list",role:"menu",ariaOrientation:"vertical"});for(const t of Object.values(r)){const i=d.a.build("li",{className:"mdc-list-item",role:"menuitem",dataset:{code:t.key},hidden:!0},[d.a.build("span",{className:"mdc-list-item__text",innerHTML:d.c.t(t.title)})]);this.items.set(t.key,i),e.append(i)}this.items.get(r.about.key).hidden=!1;const t=d.a.build("div",{className:"mdc-menu mdc-menu-surface"},[e]),i=d.a.build("div",{className:"mdc-menu-surface--anchor"},[t]);this.parent.append(i),this.ctrl=new n.a(t),this.ctrl.listen("MDCMenu:selected",e=>{this.events.get(e.detail.item.dataset.code)()})}open(){this.ctrl.open||(this.ctrl.open=!0)}}const u={view:{key:"view",title:"List",icon:""},signin:{key:"signin",title:"Sign In",icon:""},menu:{key:"menu",title:"Menu",icon:""}};class h extends d.b{constructor(){super(),this.menu=new c,this.actions=new Map,this.events=new Map,this.events.set(u.menu.key,()=>this.menu.open())}init(e){super.init(e),this.render()}render(){const e=d.a.build("section",{className:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-end"].join(" ")});for(const t of Object.values(u)){const i=d.a.build("button",{className:"fa mdc-icon-button",title:d.c.t(t.title),innerHTML:t.icon});e.append(i);const s=new o.a(i);s.unbounded=!0,s.listen("click",this.events.get(t.key)),i.hidden=!0,this.actions.set(t.key,i)}this.menu.init(e),this.actions.get(u.view.key).hidden=!1,this.actions.get(u.view.key).id="button-appBar-view",this.actions.get(u.menu.key).hidden=!1;const t=d.a.build("header",{className:"mdc-top-app-bar"},[d.a.build("div",{className:"mdc-top-app-bar__row"},[d.a.build("section",{className:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-start"].join(" ")},[d.a.build("span",{className:"mdc-top-app-bar__title",innerHTML:"Potori"})]),e])]);this.parent.append(t),this.parent.append(d.a.build("div",{className:"mdc-top-app-bar--fixed-adjust"})),new l.a(t)}switchView(){const e=this.actions.get(u.view.key),t=""===e.innerHTML;e.innerHTML=t?"":"",e.title=d.c.t(t?"Dashboard":"List")}}var m=h;class p extends d.b{constructor(){super(...arguments),this.enabled=!1,this.changed=()=>{}}init(e){super.init(e);const t=window.matchMedia("(prefers-color-scheme: dark)");t.addListener(e=>{this.enabled=e.matches,this.changed(this.enabled)}),this.enabled=t.matches}}var b=p,g=i(2),v=i(19);class f extends g.c{render(){const e=g.c.buildDialog([g.a.build("h2",{className:"mdc-dialog__title",innerHTML:g.d.t("About")}),g.a.build("div",{className:"mdc-dialog__content flex-box-col"},[g.a.build("span",{className:"mdc-typography--body2"},[g.a.link("./docs",g.d.t("Documents"),g.d.t("Documents"))]),g.a.build("span",{className:"mdc-typography--body2"},[g.a.link("https://github.com/lucka-me/potori",g.d.t("GitHub Repo"),g.d.t("GitHub Repo"))]),g.a.build("span",{className:"mdc-typography--body2"},[g.a.link("https://github.com/lucka-me/potori/blob/master/CHANGELOG.md",g.d.t("Changelog"),v.a.text)," by ",g.a.link("https://lucka.moe",g.d.t("Blog"),"Lucka")])]),g.a.build("footer",{className:"mdc-dialog__actions"},[g.c.buildDialogAction("close",g.d.t("Close"))])]);this.parent.append(e),this.ctrl=new g.b(e)}open(){this.ctrl||this.render(),this.ctrl.open()}}var y=f,_=i(18),w=i(59),k=i(58),x=i(54),N=i(53),T=i(8),L=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function l(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}d((s=s.apply(e,t||[])).next())}))};class M extends d.b{constructor(){super(...arguments),this.ctrl=null,this.marker=null,this.dialog=null,this.nomination=null,this.buttons={edit:{root:null,icon:"",clicked:()=>this.edit()},search:{root:null,icon:"",clicked:()=>this.search()},delete:{root:null,icon:"",clicked:()=>this.delete()}},this.events={queryLngLat:()=>{}}}init(e){const t=Object.create(null,{init:{get:()=>super.init}});return L(this,void 0,void 0,(function*(){t.init.call(this,e),yield this.render()}))}render(){return L(this,void 0,void 0,(function*(){const e=[];for(const t of Object.values(this.buttons)){t.root=d.a.build("button",{className:"fa mdc-icon-button",innerHTML:t.icon});const i=new o.a(t.root);i.unbounded=!0,i.listen("click",t.clicked),e.push(t.root)}const t=d.a.build("div",{className:"flex-grow--1",cssText:"min-height: 180px"}),s=d.a.build("div",{className:"flex-box-row--nowrap margin-v--8"},[d.a.build("div",{className:"flex-box-col flex-justify-content--around"},e),t]);this.parent.append(s);const a=yield i.e(0).then(i.t.bind(null,73,7));this.ctrl=new a.Map({container:t,style:`mapbox:${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`}),this.ctrl.addControl(new a.NavigationControl)}))}set(e){this.nomination=e,this.delete(),this.nomination.lngLat&&i.e(0).then(i.t.bind(null,73,7)).then(e=>{this.marker=(new e.Marker).setLngLat(this.nomination.lngLat).addTo(this.ctrl),this.ctrl.jumpTo({center:this.nomination.lngLat,zoom:16}),this.buttons.delete.root.disabled=!1,this.buttons.edit.root.innerHTML=""}),this.buttons.search.root.disabled=!1}edit(){this.marker?this.marker.setDraggable(!0):i.e(0).then(i.t.bind(null,73,7)).then(e=>{this.marker=(new e.Marker).setLngLat(this.ctrl.getCenter()).setDraggable(!0).addTo(this.ctrl),this.buttons.delete.root.disabled=!1,this.buttons.edit.root.innerHTML=""})}search(){this.buttons.search.root.disabled=!0,this.events.queryLngLat(this.nomination.id,e=>{this.dialog.isOpen&&(this.marker?(this.marker.setLngLat(e),this.marker.setDraggable(!1)):i.e(0).then(i.t.bind(null,73,7)).then(t=>{this.marker=(new t.Marker).setLngLat(e).setDraggable(!1).addTo(this.ctrl)}),this.ctrl.easeTo({center:e,zoom:16}),this.buttons.edit.root.innerHTML="",this.buttons.search.root.disabled=!1,this.buttons.delete.root.disabled=!1)},()=>{this.dialog.isOpen&&(_.a.open(d.c.t("message:Unable to query the location")),this.buttons.search.root.disabled=!1)})}delete(){this.marker&&this.marker.remove(),this.marker=null,this.buttons.edit.root.innerHTML="",this.buttons.delete.root.disabled=!0}}class B extends g.c{constructor(){super(...arguments),this.nomination=null,this.headingTitle=null,this.image=null,this.textConfirmedTime=null,this.status=new Map,this.selectedStatus=null,this.fieldResultTime=null,this.selectReason=null,this.elementReason=null,this.map=new M,this.events={update:()=>{},query:()=>{}}}render(){return L(this,void 0,void 0,(function*(){this.headingTitle=d.a.build("h2",{className:"mdc-dialog__title",dataset:{mdcDialogInitialFocus:""},innerHTML:""}),this.image=d.a.build("img",{cssText:["object-fit:cover","object-position:center","width:100%","height:150px;"].join(";")}),this.textConfirmedTime=d.a.build("span",{className:"margin-l--4"});const e=[];for(const t of T.c.types.keys()){const i="radio-dialog-details-status-"+t,s=d.a.build("input",{type:"radio",className:"mdc-radio__native-control",name:"radio-dialog-details-status",value:t});s.addEventListener("change",e=>{const t=e.target;this.selectedStatus=t.value,this.fieldResultTime.root.hidden="pending"===t.value,this.fieldResultTime.layout(),this.elementReason.hidden=!("rejected"===t.value),this.selectReason.layout(),this.map.ctrl.resize()});const a=d.a.build("div",{className:"mdc-radio"},[s,d.a.build("div",{className:"mdc-radio__background"},[d.a.build("div",{className:"mdc-radio__outer-circle"}),d.a.build("div",{className:"mdc-radio__inner-circle"})])]),n=d.a.build("div",{className:"mdc-form-field"},[a,d.a.build("label",{for:i,className:"fa status-"+t,innerHTML:T.c.types.get(t).icon})]),o=new k.a(a);this.status.set(t,o);new w.a(n).input=o,e.push(n)}const t=d.a.build("div",{className:["mdc-text-field","mdc-text-field--outlined","mdc-text-field--with-leading-icon","margin-v--8","margin-h--4","flex-grow--1"].join(" ")},[d.a.build("i",{className:["fa","mdc-text-field__icon","mdc-text-field__icon--leading"].join(" "),innerHTML:""}),d.a.build("input",{type:"datetime-local",className:"mdc-text-field__input",id:"input-dialog-details-result-time"}),B.buildNotchedOutline({for:"input-dialog-details-result-time",innerHTML:d.c.t("Result Time")})]);this.fieldResultTime=new N.a(t);const i=[];for(const[e,t]of T.c.reasons.entries())i.push(d.a.build("li",{className:"mdc-list-item",dataset:{value:e}},[d.a.build("span",{className:"mdc-list-item__ripple"}),d.a.build("span",{className:"mdc-list-item__text",innerHTML:d.c.t(t.title)})]));this.elementReason=d.a.build("div",{className:["mdc-select","mdc-select--outlined","margin-v--8","margin-h--4"].join(" ")},[d.a.build("div",{className:"mdc-select__anchor"},[B.buildNotchedOutline({innerHTML:d.c.t("Reason")}),d.a.build("span",{className:"mdc-select__selected-text"}),d.a.build("span",{className:"mdc-select__dropdown-icon"},[B.buildSVG("svg",{class:"mdc-select__dropdown-icon-graphic",viewBox:"7 10 10 5",focusable:!1},[B.buildSVG("polygon",{class:"mdc-select__dropdown-icon-inactive",stroke:"none","fill-rule":"evenodd",points:"7 10 12 15 17 10"}),B.buildSVG("polygon",{class:"mdc-select__dropdown-icon-active",stroke:"none","fill-rule":"evenodd",points:"7 15 12 10 17 15"})])])]),d.a.build("div",{className:"mdc-select__menu mdc-menu mdc-menu-surface"},[d.a.build("ul",{className:"mdc-list"},i)])]),this.selectReason=new x.a(this.elementReason),this.selectReason.selectedIndex=0;const s=d.a.build("div",{className:"mdc-dialog__content"},[d.a.build("div",{className:["mdc-typography--body1","flex-box-row--nowrap","flex-align-items--center"].join(" ")},[d.a.icon("&#xf062"),this.textConfirmedTime]),d.a.build("div",{className:["fullwidth","flex-box-row--nowrap","flex-justify-content--around"].join(" ")},e),d.a.build("div",{className:"flex-box-row--wrap"},[t,this.elementReason])]);yield this.map.init(s);const a=g.c.buildDialog([this.headingTitle,this.image,s,d.a.build("footer",{className:"mdc-dialog__actions"},[g.c.buildDialogAction("close","Close"),g.c.buildDialogAction("save","Save")])]);this.parent.append(a),this.ctrl=new g.b(a),this.ctrl.listen("MDCDialog:opened",()=>this.opened()),this.ctrl.listen("MDCDialog:closed",e=>this.closed(e)),this.map.dialog=this.ctrl}))}prepare(){return L(this,void 0,void 0,(function*(){this.ctrl||(yield this.render())}))}opened(){this.fieldResultTime.layout(),this.selectReason.layout(),this.map.ctrl.resize()}closed(e){if("save"!==e.detail.action)return;const t=T.c.getTypeByCode(this.nomination.status.code),i=T.c.getReasonByCode(this.nomination.status.code),s=this.selectedStatus;let a=!1;if("pending"!==s){const e=Date.parse(this.fieldResultTime.value);if(!e)return void _.a.open(d.c.t("message:Invalid DateTime"));const t=e+6e4*(new Date).getTimezoneOffset();this.nomination.resultTime&&Math.floor(this.nomination.resultTime/6e4)===Math.floor(t/6e4)||(this.nomination.resultTime=t,a=!0)}const n=this.selectReason.value;if((s!==t||"rejected"===t&&i.key!==n)&&(a=!0),this.map.marker){const e=this.map.marker.getLngLat();this.nomination.lngLat&&this.nomination.lngLat.lng===e.lng&&this.nomination.lngLat.lat===e.lat||(this.nomination.lngLat=e,a=!0)}else this.nomination.lngLat&&(this.nomination.lngLat=null,a=!0);a&&("rejected"!==this.selectedStatus?this.nomination.status=T.c.types.get(this.selectedStatus):this.nomination.status=T.c.reasons.get(this.selectReason.value),this.events.update(this.nomination))}open(e){this.prepare().then(()=>{this.nomination=e,this.map.set(e);const t=T.c.getTypeByCode(e.status.code);this.headingTitle.innerHTML=e.title,this.image.src=e.imageUrl,this.textConfirmedTime.innerHTML=new Date(e.confirmedTime).toLocaleString(),this.fieldResultTime.root.hidden="pending"===t;const i=e=>{const t=new Date;return t.setTime(e-6e4*t.getTimezoneOffset()),t.toISOString()},s=i(e.resultTime?e.resultTime:Date.now());this.fieldResultTime.value=s.slice(0,s.lastIndexOf(":")),this.elementReason.hidden=!("rejected"===t),"rejected"===t&&(this.selectReason.selectedIndex=e.status.code-T.c.types.get(t).code),"pending"===t&&this.events.query(e.id,e=>{const t=i(e.lastTime);this.fieldResultTime.value=t.slice(0,t.lastIndexOf(":")),this.fieldResultTime.layout()},()=>{}),this.status.get(t).checked=!0,this.selectedStatus=t,this.ctrl.open()})}updateStyle(){this.map.ctrl&&this.map.ctrl.setStyle(`mapbox:${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`)}static buildNotchedOutline(e){return e.className="mdc-floating-label",d.a.build("div",{className:"mdc-notched-outline"},[d.a.build("div",{className:"mdc-notched-outline__leading"}),d.a.build("div",{className:"mdc-notched-outline__notch"},[d.a.build("label",e)]),d.a.build("div",{className:"mdc-notched-outline__trailing"})])}static buildSVG(e,t,i){const s=document.createElementNS("http://www.w3.org/2000/svg",e);for(const[e,i]of Object.entries(t))s.setAttributeNS(null,e,""+i);return i&&s.append(...i),s}}var D=B;class j extends g.c{constructor(){super(...arguments),this.textField=null,this.events={import:()=>{}}}render(){const e=g.a.build("div",{className:["mdc-text-field","mdc-text-field--outlined","mdc-text-field--textarea","mdc-text-field--fullwidth"].join(" ")},[g.a.build("textarea",{className:"mdc-text-field__input code",id:"input-dialog-import-wayfarer",rows:8,cols:80}),g.a.build("div",{className:"mdc-notched-outline"},[g.a.build("div",{className:"mdc-notched-outline__leading"}),g.a.build("div",{className:"mdc-notched-outline__notch"},[g.a.build("label",{className:"mdc-floating-label",for:"input-dialog-import-wayfarer",innerHTML:"JSON"})]),g.a.build("div",{className:"mdc-notched-outline__trailing"})])]),t=g.c.buildDialog([g.a.build("h2",{className:"mdc-dialog__title",innerHTML:g.d.t("Import")}),g.a.build("div",{className:"mdc-dialog__content"},[e,g.a.build("div",{className:"mdc-text-field-helper-line"},[g.a.build("div",{className:"mdc-text-field-helper-text mdc-text-field-helper-text--persistent"},[g.d.t("From "),g.a.link("https://wayfarer.nianticlabs.com/api/v1/vault/manage",g.d.t("Wayfarer API"),g.d.t("Wayfarer API"))])])]),g.a.build("footer",{className:"mdc-dialog__actions"},[g.c.buildDialogAction("close",g.d.t("Close")),g.c.buildDialogAction("import",g.d.t("Import"))])]);this.parent.append(t),this.ctrl=new g.b(t),this.textField=new N.a(e),this.ctrl.listen("MDCDialog:closed",e=>{this.closed(e)})}open(){this.ctrl||this.render(),this.ctrl.open()}closed(e){"import"===e.detail.action&&this.events.import(this.textField.value)}}var R=j;class H extends d.b{constructor(){super(...arguments),this.about=new y,this.alert=_.a,this.details=new D,this.import=new R}init(e){super.init(e);for(const t of Object.values(this))t.init(e)}}var S=H,O=i(12),I=i(56);class C extends d.b{constructor(){super(...arguments),this.ctrl=null}init(e){super.init(e),this.render()}render(){const e=O.a.build("div",{className:"mdc-linear-progress mdc-linear-progress--closed"},[O.a.build("div",{className:"mdc-linear-progress__buffer"},[O.a.build("div",{className:"mdc-linear-progress__buffer-bar"}),O.a.build("div",{className:"mdc-linear-progress__buffer-dots"})]),O.a.build("div",{className:"mdc-linear-progress__bar mdc-linear-progress__primary-bar"},[O.a.build("span",{className:"mdc-linear-progress__bar-inner"})]),O.a.build("div",{className:"mdc-linear-progress__bar mdc-linear-progress__secondary-bar"},[O.a.build("span",{className:"mdc-linear-progress__bar-inner"})])]);this.parent.append(e),this.ctrl=new I.a(e)}}var V=C,A=i(6),U=i(57);class E extends d.b{constructor(){super(...arguments),this.ctrl=null,this.textMessage=null}render(){this.textMessage=d.a.build("div",{className:"mdc-snackbar__label",role:"status",ariaLive:"polite"});const e=d.a.build("div",{className:"mdc-snackbar__actions"},[d.a.build("button",{className:"fa mdc-icon-button mdc-snackbar__dismiss",title:d.c.t("Dismiss"),innerHTML:"&#xf00d"})]),t=d.a.build("div",{className:"mdc-snackbar"},[d.a.build("div",{className:"mdc-snackbar__surface"},[this.textMessage,e])]);this.parent.append(t),this.ctrl=new U.a(t)}show(e){this.ctrl||this.render(),this.textMessage.innerHTML=e,this.ctrl.open()}}var P=new E,q=function(e,t,i,s){return new(i||(i=Promise))((function(a,n){function o(e){try{d(s.next(e))}catch(e){n(e)}}function l(e){try{d(s.throw(e))}catch(e){n(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,l)}d((s=s.apply(e,t||[])).next())}))};t.a=class{constructor(){this.appBar=new m,this.progress=new V,this.dialog=new S,this.snackbar=P,this.mainBox=null,this.dashboard=null,this.list=null,this.dark=new b}init(){document.documentElement.lang=a.a.language;const e=document.body;e.className="mdc-typography fullheight flex-box-col",this.appBar.events.set(u.view.key,()=>this.switchView()),this.appBar.events.set(u.signin.key,()=>A.a.auth.signIn()),this.appBar.menu.events.set(r.open.key,()=>A.a.open()),this.appBar.menu.events.set(r.save.key,()=>A.a.save()),this.appBar.menu.events.set(r.upload.key,()=>A.a.upload()),this.appBar.menu.events.set(r.import.key,()=>this.dialog.import.open()),this.appBar.menu.events.set(r.about.key,()=>this.dialog.about.open()),this.appBar.menu.events.set(r.signout.key,()=>A.a.auth.signOut()),this.appBar.init(e),this.progress.init(e),this.mainBox=O.a.build("div",{className:["flex--1","flex-box-row--wrap","main-box"].join(" "),cssText:["min-height: 0%"].join(";")}),e.append(this.mainBox),this.snackbar.init(e),this.dialog.details.events.update=e=>{this.update(e)},this.dialog.details.events.query=(e,t,i)=>{A.a.bs.query(e,t,i)},this.dialog.details.map.events.queryLngLat=(e,t,i)=>{A.a.bs.queryLngLat(e,t,i)},this.dialog.import.events.import=e=>{A.a.import(e)},this.dialog.init(e),this.dark.init(e)}linkService(){A.a.events.authStatusChanged=e=>{e?(this.appBar.actions.get(u.signin.key).hidden=!0,this.appBar.menu.items.get(r.signout.key).hidden=!1):(this.clear(),this.appBar.actions.get(u.signin.key).hidden=!1,this.appBar.menu.items.get(r.signout.key).hidden=!0,this.appBar.menu.items.get(r.upload.key).hidden=!0,this.appBar.menu.items.get(r.import.key).hidden=!0)},A.a.events.progressUpdate=e=>{this.progress.ctrl.progress=e},A.a.events.showProgress=()=>{this.preloadModules(),this.progress.ctrl.open()},A.a.events.show=()=>{this.show()},A.a.events.clear=()=>{this.clear()},A.a.events.alert=e=>{this.dialog.alert.open(e)},A.a.events.info=e=>{this.snackbar.show(e)},A.a.file.local.events.openUI=e=>{this.openFileUI(e)},A.a.file.local.events.saveUI=(e,t)=>{this.saveFileUI(e,t)},A.a.mari.events.bufferUpdate=e=>{this.progress.ctrl.buffer=e},A.a.mari.events.progressUpdate=e=>{this.progress.ctrl.progress=.9*e}}switchView(){this.dashboard&&(this.appBar.switchView(),this.dashboard.root.classList.toggle("view-hide"),this.list.root.classList.toggle("view-hide"))}clear(){this.appBar.menu.items.get(r.open.key).hidden=!1,this.appBar.menu.items.get(r.save.key).hidden=!0,this.progress.ctrl.close(),this.progress.ctrl.buffer=0,this.progress.ctrl.progress=0,this.dashboard&&(this.dashboard.setVisible(!1),this.list.clear(),this.dashboard.map.update(A.a.nominations))}show(){this.prepareViews().then(()=>{this.dashboard.setVisible(!0),this.dashboard.map.fit(A.a.nominations),this.dashboard.refresh(A.a.nominations),this.list.show(A.a.nominations),this.appBar.menu.items.get(r.open.key).hidden=!0,this.appBar.menu.items.get(r.save.key).hidden=!1,this.appBar.menu.items.get(r.upload.key).hidden=!A.a.auth.signedIn,this.appBar.menu.items.get(r.import.key).hidden=!1,this.progress.ctrl.close()})}preloadModules(){Promise.all([i.e(0),i.e(1),i.e(8),i.e(2)]).then(i.bind(null,75)),i.e(5).then(i.bind(null,76))}prepareViews(){return q(this,void 0,void 0,(function*(){if(this.dashboard)return;const e=yield Promise.all([i.e(0),i.e(1),i.e(8),i.e(2)]).then(i.bind(null,75));this.dashboard=new e.default,this.dashboard.init(this.mainBox),A.a.events.updateBs=()=>{this.dashboard.bs.update(A.a.nominations)},this.dashboard.map.events.styleLoaded=()=>A.a.nominations,this.dashboard.filter.events.switchType=(e,t)=>{for(const i of A.a.nominations)T.c.typeMatched(i.status.code,e.code)&&(document.getElementById("card-"+i.id).hidden=!t);"rejected"===e.key&&this.dashboard.map.updateRejected(A.a.nominations),this.dashboard.map.setTypeVisible(e.key,t)},this.dashboard.filter.events.switchReason=(e,t)=>{for(const i of A.a.nominations)i.status.code===e.code&&(document.getElementById("card-"+i.id).hidden=!t);this.dashboard.map.updateRejected(A.a.nominations)},this.dashboard.bs.events.analyse=e=>A.a.bs.analyse(e),this.dashboard.bs.basic.events={refresh:()=>{A.a.updateBsData()},clear:()=>{A.a.clearBsData(),this.dashboard.bs.update([])}},this.dark.changed=()=>{this.dashboard&&this.dashboard.updateStyle(),this.dialog.details.updateStyle()};const t=yield i.e(5).then(i.bind(null,76));this.list=new t.default,this.list.init(this.mainBox),this.list.events.focus=e=>{this.dashboard.map.easeTo(e.lngLat)},this.list.events.openDetails=e=>{this.dialog.details.open(e)},this.dashboard.map.events.focus=e=>{const t=this.list.root.offsetTop+8;this.list.root.scrollTo(0,document.getElementById("card-"+e).offsetTop-t)}}))}update(e){this.dashboard&&(this.dashboard.update(A.a.nominations),this.list.update(e))}openFileUI(e){const t=O.a.build("input",{cssText:"display:none;",type:"file",accept:"json"});t.addEventListener("change",e,!1),document.body.append(t),t.click(),setTimeout(()=>{t.remove()},1e3)}saveFileUI(e,t){const i=O.a.build("a",{cssText:"display:none",href:t,download:e});document.body.append(i),i.click(),i.remove()}}}}]);