(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){function t(e,t,n){const a=document.createElement(e);for(const[e,n]of Object.entries(t))switch(e){case"cssText":a.style.cssText=n;break;case"dataset":for(const[e,t]of Object.entries(n))a.dataset[e]=t;break;default:a[e]=n}return n&&a.append(...n),a}e.build=t,e.icon=function(e){return t("i",{className:"fa fa-fw",innerHTML:e})}}(a||(a={}))},17:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={open:{key:"open",title:"ui.app-bar.menu.open"},save:{key:"save",title:"ui.app-bar.menu.save"},upload:{key:"upload",title:"ui.app-bar.menu.upload"},import:{key:"import",title:"ui.app-bar.menu.import"},about:{key:"about",title:"ui.app-bar.menu.about"},signout:{key:"signout",title:"ui.app-bar.menu.signOut"}}},30:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(3),i=n(1),s=n(0),o=n(13),r=n(14),c=n(37),d=n(5);const l={view:{key:"view",title:"ui.app-bar.list",icon:""},signin:{key:"signin",title:"ui.app-bar.signIn",icon:""},open:{key:"open",title:"ui.app-bar.open",icon:""},about:{key:"about",title:"ui.app-bar.about",icon:""},menu:{key:"menu",title:"ui.app-bar.menu",icon:""}};var u=n(17),p=function(e,t,n,a){return new(n||(n=Promise))((function(i,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function r(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};class m extends d.a{constructor(){super(),this.menu=null,this.actions=new Map,this.events=new Map,this.sectionActions=null,this.events.set(l.menu.key,(()=>this.menu.open()))}init(e){super.init(e),this.render()}render(){this.sectionActions=i.a.build("section",{className:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-end"].join(" ")});for(const e of Object.values(l)){const t=i.a.build("button",{className:"fa mdc-icon-button",title:a.a.t(e.title),innerHTML:e.icon});this.sectionActions.append(t);const n=new r.a(t);n.unbounded=!0,n.listen("click",this.events.get(e.key)),t.hidden=!0,this.actions.set(e.key,t)}this.actions.get(l.view.key).hidden=!1,this.actions.get(l.view.key).id="button-appBar-view",this.actions.get(l.open.key).hidden=!1,this.actions.get(l.about.key).hidden=!1;const e=i.a.build("header",{className:"mdc-top-app-bar mdc-top-app-bar--fixed"},[i.a.build("div",{className:"mdc-top-app-bar__row"},[i.a.build("section",{className:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-start"].join(" ")},[i.a.build("span",{className:"mdc-top-app-bar__title",innerHTML:"Potori"})]),this.sectionActions])]);this.parent.append(e),this.parent.append(i.a.build("div",{className:"mdc-top-app-bar--fixed-adjust"})),new c.a(e)}prepare(){return p(this,void 0,void 0,(function*(){if(this.menu)return;const e=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,70));this.menu=new e.default,this.menu.init(this.sectionActions),this.actions.get(l.menu.key).hidden=!1,this.actions.get(l.open.key).hidden=!0,this.actions.get(l.about.key).hidden=!0}))}switchView(){const e=this.actions.get(l.view.key),t=""===e.innerHTML;e.innerHTML=t?"":"",e.title=a.a.t(t?"ui.app-bar.dashboard":"ui.app-bar.list")}}var h=m;class b extends d.a{constructor(){super(...arguments),this.change=()=>{}}init(e){super.init(e);window.matchMedia("(prefers-color-scheme: dark)").addListener((e=>{this.change(e.matches)}))}}var f=n(38),g=n(6);class v extends g.a{constructor(){super(...arguments),this.events={info:()=>{}}}render(){const e=g.a.buildLink("#",a.a.t("ui.dialog.about.exportError"));e.onclick=()=>(this.exportError(),!1);const t=g.a.buildDialog([i.a.build("h2",{className:"mdc-dialog__title",innerHTML:a.a.t("ui.dialog.about.title")}),i.a.build("div",{className:"mdc-dialog__content flex-box-col"},[i.a.build("span",{className:"mdc-typography--body2"},[g.a.buildLink("./docs",a.a.t("ui.dialog.about.documents"))]),i.a.build("span",{className:"mdc-typography--body2"},[g.a.buildLink("https://github.com/lucka-me/potori",a.a.t("ui.dialog.about.repo"))]),i.a.build("span",{className:"mdc-typography--body2"},[g.a.buildLink("https://github.com/lucka-me/potori/blob/master/CHANGELOG.md",a.a.t("ui.dialog.about.changelog"),s.a.version.string)]),i.a.build("span",{className:"mdc-typography--body2"},[e])]),i.a.build("footer",{className:"mdc-dialog__actions"},[g.a.buildDialogAction("close",a.a.t("ui.dialog.close"))])]);this.parent.append(t),this.ctrl=new f.a(t)}open(){this.ctrl||this.render(),this.ctrl.open()}exportError(){if(s.a.errors.length<1)return void this.events.info(a.a.t("message:ui.dialog.about.exportErrorEmpty"));let e="";for(const t of s.a.errors){let n=t.message;if("message"in t.error){const e=t.error;n=e.stack||e.message}e+=`[${t.filename}][${t.lineno}:${t.colno}]${n}\n`}const t=i.a.build("textarea",{value:e,readOnly:!0});document.body.append(t),t.select(),document.execCommand("copy"),t.remove(),this.events.info(a.a.t("message:ui.dialog.about.exportErrorCopied",{count:s.a.errors.length}))}}var y=v;class k extends g.a{constructor(){super(...arguments),this.textMessage=null}render(){this.textMessage=i.a.build("div",{className:"mdc-dialog__content"});const e=g.a.buildDialog([this.textMessage,i.a.build("footer",{className:"mdc-dialog__actions"},[g.a.buildDialogAction("close",a.a.t("ui.dialog.close"))])]);this.parent.append(e),this.ctrl=new f.a(e)}open(e){this.ctrl||this.render(),this.ctrl.open(),this.textMessage.innerHTML=e}}var w=function(e,t,n,a){return new(n||(n=Promise))((function(i,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function r(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};class _ extends d.a{constructor(){super(...arguments),this.about=new y,this.alert=new k,this.details=null,this.import=null}init(e){super.init(e);for(const t of Object.values(this))t&&t.init(e)}prepare(){return w(this,void 0,void 0,(function*(){if(this.details)return;const e=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,65));this.details=new e.default,this.details.init(this.parent);const t=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,71));this.import=new t.default,this.import.init(this.parent)}))}}var x=_,N=n(39);class L extends d.a{constructor(){super(...arguments),this.ctrl=null,this.root=null}init(e){super.init(e),this.render()}render(){this.root=i.a.build("div",{className:"mdc-linear-progress mdc-linear-progress--closed",hidden:!0},[i.a.build("div",{className:"mdc-linear-progress__buffer"},[i.a.build("div",{className:"mdc-linear-progress__buffer-bar"}),i.a.build("div",{className:"mdc-linear-progress__buffer-dots"})]),i.a.build("div",{className:"mdc-linear-progress__bar mdc-linear-progress__primary-bar"},[i.a.build("span",{className:"mdc-linear-progress__bar-inner"})]),i.a.build("div",{className:"mdc-linear-progress__bar mdc-linear-progress__secondary-bar"},[i.a.build("span",{className:"mdc-linear-progress__bar-inner"})])]),this.parent.append(this.root),this.ctrl=new N.a(this.root)}open(){this.root.hidden=!1,this.ctrl.open()}close(){this.root.hidden=!0,this.ctrl.close()}set buffer(e){this.ctrl.buffer=e}set progress(e){this.ctrl.progress=e}}var T=L,M=n(40);class j extends d.a{constructor(){super(...arguments),this.ctrl=null}render(){const e=i.a.build("div",{className:"mdc-snackbar__label",role:"status",ariaLive:"polite"}),t=i.a.build("div",{className:"mdc-snackbar__actions"},[i.a.build("button",{className:"fa mdc-icon-button mdc-snackbar__dismiss",title:a.a.t("ui.snackbar.dismiss"),innerHTML:"&#xf00d"})]),n=i.a.build("div",{className:"mdc-snackbar"},[i.a.build("div",{className:"mdc-snackbar__surface"},[e,t])]);this.parent.append(n),this.ctrl=new M.a(n)}show(e){this.ctrl||this.render(),this.ctrl.labelText=e,this.ctrl.open()}}var E,P=function(e,t,n,a){return new(n||(n=Promise))((function(i,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function r(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};!function(e){const t=new h,r=new b,c=new x,d=new T,p=new j;let m=null,f=null,g=null;function v(e){e?(t.actions.get(l.signin.key).hidden=!0,t.menu&&(t.menu.items.get(u.a.signout.key).hidden=!1)):(y(),t.actions.get(l.signin.key).hidden=!navigator.onLine,t.menu&&(t.menu.items.get(u.a.signout.key).hidden=!0,t.menu.items.get(u.a.upload.key).hidden=!0,t.menu.items.get(u.a.import.key).hidden=!0))}function y(){t.menu&&(t.menu.items.get(u.a.open.key).hidden=!1,t.menu.items.get(u.a.save.key).hidden=!0,t.actions.get(l.menu.key).hidden=!0),t.actions.get(l.open.key).hidden=!1,t.actions.get(l.about.key).hidden=!1,d.close(),d.buffer=0,d.progress=0,f&&(f.setVisible(!1),g.clear(),f.map.update(s.a.nominations))}e.init=function(){document.documentElement.lang=a.a.language;const e=document.body;e.className="mdc-typography flex-box-col",t.events.set(l.view.key,(()=>function(){if(!f)return;t.switchView(),f.root.classList.toggle("view-hide"),g.root.classList.toggle("view-hide")}())),t.events.set(l.signin.key,(()=>s.a.auth.signIn())),t.events.set(l.open.key,(()=>s.a.open())),t.events.set(l.about.key,(()=>c.about.open())),t.init(e),d.init(e),m=i.a.build("div",{className:["flex--1","flex-box-row--wrap","main-box"].join(" "),cssText:["min-height: 0%"].join(";")}),e.append(m),p.init(e),c.init(e),c.about.events.info=e=>{p.show(e)},r.init(e),function(){s.a.events.authStatusChanged=e=>v(e),navigator.onLine||v(!1);s.a.events.progressUpdate=e=>d.progress=e,s.a.events.bufferUpdate=e=>d.buffer=e,s.a.events.start=()=>{t.actions.get(l.open.key).hidden=!0,Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,61)),Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,66)),d.open()},s.a.events.idle=()=>{(function(){return P(this,void 0,void 0,(function*(){if(f)return;yield t.prepare(),t.menu.items.get(u.a.signout.key).hidden=!s.a.auth.signedIn,t.menu.events.set(u.a.open.key,(()=>s.a.open())),t.menu.events.set(u.a.save.key,(()=>s.a.save())),t.menu.events.set(u.a.upload.key,(()=>s.a.upload())),t.menu.events.set(u.a.about.key,(()=>c.about.open())),t.menu.events.set(u.a.signout.key,(()=>s.a.auth.signOut()));const e=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,61));f=new e.default,f.init(m),s.a.events.bsUpdate=()=>{f.bs.update(s.a.nominations)},f.map.events.styleLoaded=()=>s.a.nominations,f.filter.events.switchType=(e,t)=>{if("rejected"!==e.key)for(const n of s.a.nominations)s.a.status.typeMatched(n.status.code,e.code)&&(document.getElementById("card-"+n.id).hidden=!t);else{const e=f.filter.reasonFilter;for(const t of s.a.nominations)t.status.code<100||(document.getElementById("card-"+t.id).hidden=!e.get(t.status.code));f.map.reasonFilter=e,f.map.updateRejected(s.a.nominations)}f.map.setTypeVisible(e.key,t)},f.filter.events.switchReason=(e,t)=>{for(const n of s.a.nominations)n.status.code===e.code&&(document.getElementById("card-"+n.id).hidden=!t);f.map.reasonFilter=f.filter.reasonFilter,f.map.updateRejected(s.a.nominations)},f.bs.events.analyse=e=>s.a.bs.analyse(e),f.bs.basic.events={refresh:()=>{s.a.updateBsData()},clear:()=>{s.a.clearBsData(),f.bs.update([])}},r.change=()=>{f&&f.updateStyle(),c.details.updateStyle()};const a=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,66));g=new a.default,g.init(m),g.events.alert=e=>{c.alert.open(e)},g.events.focus=e=>{f.map.easeTo(e.lngLat)},f.map.events.focus=e=>{const t=g.root.offsetTop+8;g.root.scrollTo(0,document.getElementById("card-"+e).offsetTop-t)},yield c.prepare(),c.details.events.alert=e=>{c.alert.open(e)},c.details.events.query=(e,t,n)=>{s.a.bs.query(e,t,n)},c.details.events.update=e=>{!function(e){if(!f)return;f.update(s.a.nominations);let t=!1;e.status instanceof o.a?t=f.filter.reasons.get(e.status).checked:e.status instanceof o.b&&(t=f.filter.types.get(e.status).checked),g.update(e,t)}(e)},c.details.map.events.alert=e=>{c.alert.open(e)},c.details.map.events.queryLngLat=(e,t,n)=>{s.a.bs.queryLocation(e,t,n)},g.events.openDetails=e=>{c.details.open(e)},c.import.import=e=>{s.a.importJSON(e)},t.menu.events.set(u.a.import.key,(()=>c.import.open()))}))})().then((()=>{f.setVisible(!0),f.map.fit(s.a.nominations),f.refresh(s.a.nominations),g.show(s.a.nominations),t.menu.items.get(u.a.open.key).hidden=!0,t.menu.items.get(u.a.save.key).hidden=!1,t.menu.items.get(u.a.upload.key).hidden=!s.a.auth.signedIn,t.menu.items.get(u.a.import.key).hidden=!1,d.close()}))},s.a.events.clear=()=>{y()},s.a.events.alert=e=>{c.alert.open(e)},s.a.events.info=e=>{p.show(e)},s.a.file.local.events.openUI=e=>{!function(e){const t=i.a.build("input",{cssText:"display:none;",type:"file",accept:"json"});t.addEventListener("change",(t=>{e(t.target.files[0])}),!1),document.body.append(t),t.click(),setTimeout((()=>{t.remove()}),1e3)}(e)},s.a.file.local.events.saveUI=(e,t)=>{!function(e,t){const n=i.a.build("a",{cssText:"display:none",href:t,download:e});document.body.append(n),n.click(),n.remove()}(e,t)}}()}}(E||(E={}))},5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));class a{constructor(){this.parent=null,Object.defineProperty(this,"parent",{enumerable:!1})}init(e){this.parent=e}render(){}}},6:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(1),i=n(5);class s extends i.a{constructor(){super(...arguments),this.ctrl=null}static buildDialog(e){return a.a.build("div",{className:"mdc-dialog",role:"dialog",ariaModal:!0},[a.a.build("div",{className:"mdc-dialog__container"},[a.a.build("div",{className:"mdc-dialog__surface"},e)]),a.a.build("div",{className:"mdc-dialog__scrim"})])}static buildDialogAction(e,t){return a.a.build("button",{className:"mdc-button mdc-dialog__button",dataset:{mdcDialogAction:e}},[a.a.build("span",{className:"mdc-button__label",innerHTML:t})])}static buildLink(e,t,n){return a.a.build("a",{href:e,title:t,target:"_blank",rel:"noopener",innerHTML:n||t})}}}}]);