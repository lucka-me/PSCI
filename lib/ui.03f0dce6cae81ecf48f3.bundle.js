(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{10:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a,i=n(6);!function(e){e.Action={close:"close"},e.StringKey={close:"ui.dialog.close"};class t extends i.a.Prototype{constructor(){super(...arguments),this.ctrl=null}open(){this.ctrl||this.render(),this.ctrl.open()}}e.DialogPrototype=t}(a||(a={}))},11:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(0);n(34);const i="mdc-dialog",s="mdc-dialog__container",o="mdc-dialog__surface",r="mdc-dialog__content",c="mdc-dialog__title",l="mdc-dialog__actions",d="mdc-dialog__scrim",u="mdc-button mdc-dialog__button",p="mdc-button__ripple",m="mdc-button__label";function h(e,t){const n=[];return t.title&&n.push(Object(a.a)("h2",{className:c,innerHTML:t.title})),n.push(Object(a.a)("div",{className:r},t.contents)),t.actions&&n.push(Object(a.a)("footer",{className:l},t.actions.map((e=>Object(a.a)("button",{className:u,dataset:{mdcDialogAction:e.action}},[Object(a.a)("div",{className:p}),Object(a.a)("span",{className:m,innerHTML:e.text})]))))),Object(a.a)("div",{className:`${i} ${e}`,role:"dialog",ariaModal:!0},[Object(a.a)("div",{className:s},[Object(a.a)("div",{className:o},n)]),Object(a.a)("div",{className:d})])}(h||(h={})).link=function(e,t,n){return Object(a.a)("a",{href:t,title:n||e,target:"_blank",rel:"noopener",innerHTML:e})}},18:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={open:{key:"open",title:"ui.app-bar.menu.open"},save:{key:"save",title:"ui.app-bar.menu.save"},upload:{key:"upload",title:"ui.app-bar.menu.upload"},import:{key:"import",title:"ui.app-bar.menu.import"},migrate:{key:"migrate",title:"ui.app-bar.menu.migrate"},about:{key:"about",title:"ui.app-bar.menu.about"},signout:{key:"signout",title:"ui.app-bar.menu.signOut"}}},19:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a,i=n(0);!function(e){e.copy=function(e){const t=Object(i.a)("textarea",{value:e,readOnly:!0});document.body.append(t),t.select(),document.execCommand("copy"),t.remove()}}(a||(a={}))},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0);function i(e,t){return Object(a.a)("button",{className:"fa mdc-icon-button",title:t||"",innerHTML:e})}},31:function(e,t,n){"use strict";n.d(t,"a",(function(){return W}));var a=n(0),i=n(4),s=n(2),o=n(1),r=n(14),c=n(40),l=n(6);const d={appBar:"mdc-top-app-bar mdc-top-app-bar--fixed",row:"mdc-top-app-bar__row",sectionStart:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-start"].join(" "),sectionEnd:["mdc-top-app-bar__section","mdc-top-app-bar__section--align-end"].join(" "),title:"mdc-top-app-bar__title",fixedAdjust:"mdc-top-app-bar--fixed-adjust"};function u(e,t){return Object(a.a)("header",{className:d.appBar},[Object(a.a)("div",{className:d.row},[Object(a.a)("section",{className:d.sectionStart},[Object(a.a)("span",{className:d.title,innerHTML:e})]),Object(a.a)("section",{className:d.sectionEnd,role:"toolbar"},t)])])}(u||(u={})).fixedAdjust=function(){return Object(a.a)("div",{className:d.fixedAdjust})};var p=n(7),m=n(21);const h={view:{key:"view",title:"ui.app-bar.list",icon:p.a.Icon.thList},signin:{key:"signin",title:"ui.app-bar.signIn",icon:p.a.Icon.signInAlt},open:{key:"open",title:"ui.app-bar.open",icon:p.a.Icon.folderOpen},about:{key:"about",title:"ui.app-bar.about",icon:p.a.Icon.infoCircle},menu:{key:"menu",title:"ui.app-bar.menu",icon:p.a.Icon.ellipsisV}},b={dashboard:"ui.app-bar.dashboard",list:"ui.app-bar.list"};var g=n(18),f=function(e,t,n,a){return new(n||(n=Promise))((function(i,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function r(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};class v extends l.a.Prototype{constructor(){super(),this.root=null,this.menu=null,this.actions=new Map,this.events={action:new Map,backToTop:()=>{}},this.events.action.set(h.menu.key,(()=>this.menu.open()))}init(e){super.init(e),this.render()}render(){const e=[];for(const t of Object.values(h)){const n=Object(m.a)(t.icon,i.a.t(t.title));e.push(n);const a=new r.a(n);a.unbounded=!0,a.listen("click",this.events.action.get(t.key)),n.hidden=!0,this.actions.set(t.key,n)}this.actions.get(h.view.key).classList.add("action-view"),this.actions.get(h.open.key).hidden=!1,this.actions.get(h.about.key).hidden=!1,this.root=u("Potori",e),this.parent.append(this.root),this.parent.append(u.fixedAdjust());new c.a(this.root).listen("dblclick",(()=>{this.events.backToTop()}))}prepare(){return f(this,void 0,void 0,(function*(){if(this.menu)return;const e=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,72));this.menu=new e.default,this.menu.init(this.root.querySelector(".mdc-top-app-bar__section--align-end")),this.actions.get(h.menu.key).hidden=!1,this.actions.get(h.open.key).hidden=!0,this.actions.get(h.about.key).hidden=!0}))}switchView(){const e=this.actions.get(h.view.key),t=e.innerHTML===p.a.Icon.thList;e.innerHTML=t?p.a.Icon.tachometerAlt:p.a.Icon.thList,e.title=i.a.t(t?b.dashboard:b.list)}}var y=v;class k extends l.a.Prototype{constructor(){super(...arguments),this.change=()=>{}}init(e){super.init(e);window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(e=>{this.change(e.matches)}))}}var w=n(41),j=n(11),_=n(19),O=n(10);const x="./docs",N="https://github.com/lucka-me/potori",E="https://github.com/lucka-me/potori/blob/master/CHANGELOG.md",P={title:"ui.dialog.about.title",documents:"ui.dialog.about.documents",repo:"ui.dialog.about.repo",exportError:"ui.dialog.about.exportError",changelog:"ui.dialog.about.changelog",messageExportErrorEmpty:"message:ui.dialog.about.exportErrorEmpty",messageExportErrorCopied:"message:ui.dialog.about.exportErrorCopied"};class I extends O.a.DialogPrototype{constructor(){super(...arguments),this.events={info:()=>{}}}render(){const e=j.a.link(i.a.t(P.exportError),"#");e.onclick=()=>(this.exportError(),!1);const t=Object(j.a)("about-dialog",{title:i.a.t(P.title),contents:[Object(a.a)("span",{},[j.a.link(i.a.t(P.documents),x)]),Object(a.a)("span",{},[j.a.link(i.a.t(P.repo),N)]),Object(a.a)("span",{},[j.a.link(s.a.version.string,E,i.a.t(P.changelog))]),Object(a.a)("span",{},[e])],actions:[{action:O.a.Action.close,text:i.a.t(O.a.StringKey.close)}]});this.parent.append(t),this.ctrl=new w.a(t)}exportError(){if(s.a.errors.length<1)return void this.events.info(i.a.t(P.messageExportErrorEmpty));let e="";for(const t of s.a.errors){let n=t.message;if("message"in t.error){const e=t.error;n=e.stack||e.message}e+=`[${t.filename}][${t.lineno}:${t.colno}]${n}\n`}_.a.copy(e),this.events.info(i.a.t(P.messageExportErrorCopied,{count:s.a.errors.length}))}}class L extends O.a.DialogPrototype{constructor(){super(...arguments),this.textMessage=null}render(){this.textMessage=Object(a.a)("span",{});const e=Object(j.a)("alert-dialog",{contents:[this.textMessage],actions:[{action:O.a.Action.close,text:i.a.t(O.a.StringKey.close)}]});this.parent.append(e),this.ctrl=new w.a(e)}set message(e){this.ctrl||this.render(),this.textMessage.innerHTML=e}}var T=function(e,t,n,a){return new(n||(n=Promise))((function(i,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function r(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};class A extends l.a.Prototype{constructor(){super(...arguments),this.about=new I,this.alert=new L,this.details=null,this.import=null,this.match=null}init(e){super.init(e),this.about.init(e),this.alert.init(e)}prepare(){return T(this,void 0,void 0,(function*(){if(this.details)return;const e=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,69));this.details=new e.default,this.details.init(this.parent);const t=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,73));this.import=new t.default,this.import.init(this.parent);const a=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,74));this.match=new a.default,this.match.init(this.parent)}))}}var M=n(42);const S="mdc-linear-progress",H="mdc-linear-progress__buffer",V="mdc-linear-progress__buffer-bar",C="mdc-linear-progress__buffer-dots",D="mdc-linear-progress__bar mdc-linear-progress__primary-bar",B="mdc-linear-progress__bar mdc-linear-progress__secondary-bar",U="mdc-linear-progress__bar-inner";class R extends l.a.Prototype{constructor(){super(...arguments),this.ctrl=null,this.root=null}init(e){super.init(e),this.render()}render(){this.root=Object(a.a)("div",{className:S,role:"progressbar",ariaValuemin:0,ariaValuemax:1,ariaValuenow:0},[Object(a.a)("div",{className:H},[Object(a.a)("div",{className:V}),Object(a.a)("div",{className:C})]),Object(a.a)("div",{className:D},[Object(a.a)("span",{className:U})]),Object(a.a)("div",{className:B},[Object(a.a)("span",{className:U})])]),this.root.hidden=!0,this.parent.append(this.root),this.ctrl=new M.a(this.root),this.ctrl.close()}open(){this.root.hidden=!1,this.ctrl.open()}close(){this.root.hidden=!0,this.ctrl.close()}set buffer(e){this.ctrl.buffer=e}set progress(e){this.ctrl.progress=e}}var $=R,q=n(43);const J="mdc-snackbar",K="mdc-snackbar__surface",G="mdc-snackbar__label",z="mdc-snackbar__actions",F="mdc-snackbar__dismiss mdc-icon-button fa";class Q extends l.a.Prototype{constructor(){super(...arguments),this.ctrl=null}render(){const e=Object(a.a)("div",{className:J},[Object(a.a)("div",{className:K,role:"status",ariaRelevant:"additions"},[Object(a.a)("div",{className:G,ariaAtomic:!1}),Object(a.a)("div",{className:z,ariaAtomic:!0},[Object(a.a)("button",{className:F,innerHTML:p.a.Icon.times})])])]);this.parent.append(e),this.ctrl=new q.a(e)}show(e){this.ctrl||this.render(),this.ctrl.labelText=e,this.ctrl.open()}}var W,X=function(e,t,n,a){return new(n||(n=Promise))((function(i,s){function o(e){try{c(a.next(e))}catch(e){s(e)}}function r(e){try{c(a.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,r)}c((a=a.apply(e,t||[])).next())}))};!function(e){const t=new y,r=new k,c=new A,l=new $,d=new Q;let u=null,p=null,m=null;function b(e){e?(t.actions.get(h.signin.key).hidden=!0,t.menu&&(t.menu.items.get(g.a.signout.key).hidden=!1)):(f(),t.actions.get(h.signin.key).hidden=!navigator.onLine,t.menu&&(t.menu.items.get(g.a.signout.key).hidden=!0,t.menu.items.get(g.a.upload.key).hidden=!0,t.menu.items.get(g.a.import.key).hidden=!0))}function f(){t.menu&&(t.menu.items.get(g.a.open.key).hidden=!1,t.menu.items.get(g.a.save.key).hidden=!0,t.actions.get(h.menu.key).hidden=!0),t.actions.get(h.open.key).hidden=!1,t.actions.get(h.about.key).hidden=!1,l.close(),l.buffer=0,l.progress=0,p&&(p.setVisible(!1),m.clear(),p.map.update(s.a.nominations))}function v(){return X(this,void 0,void 0,(function*(){if(p)return;yield t.prepare(),t.menu.items.get(g.a.signout.key).hidden=!s.a.auth.signedIn,t.menu.events.set(g.a.open.key,(()=>s.a.open())),t.menu.events.set(g.a.save.key,(()=>s.a.save())),t.menu.events.set(g.a.upload.key,(()=>s.a.upload())),t.menu.events.set(g.a.migrate.key,(()=>s.a.migrate())),t.menu.events.set(g.a.about.key,(()=>c.about.open())),t.menu.events.set(g.a.signout.key,(()=>s.a.auth.signOut()));const e=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,66));p=new e.default,p.init(u),s.a.events.bsUpdate=()=>{p.bs.update(s.a.nominations)},p.map.events.styleLoaded=()=>s.a.nominations,p.filter.events.switched=(e,t,n)=>{for(const n of s.a.nominations)if(n.status!==o.a.StatusCode.Rejected)document.getElementById("card-"+n.id).hidden=!e.get(n.status);else if(n.reasons.length>0){let e=!1;for(const a of n.reasons)if(t.get(a)){e=!0;break}document.getElementById("card-"+n.id).hidden=!e}else document.getElementById("card-"+n.id).hidden=!t.get(o.a.Reason.undeclared);p.map.filter(e,t),n&&p.map.updateRejected(s.a.nominations)},p.bs.events.analyse=e=>s.a.bs.analyse(e),p.bs.basic.events={refresh:()=>{s.a.updateBsData()},clear:()=>{s.a.clearBsData(),p.bs.update([])}},r.change=()=>{p&&p.updateStyle(),c.details.updateStyle()};const a=yield Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,71));m=new a.default,m.init(u),m.events.alert=e=>{c.alert.message=e,c.alert.open()},m.events.focus=e=>{p.map.easeTo(e.lngLat)},p.map.events.focus=e=>{m.focus(e)},yield c.prepare(),c.details.events.alert=e=>{c.alert.message=e,c.alert.open()},c.details.events.query=(e,t,n)=>{s.a.bs.query(e,t,n)},c.details.events.update=e=>{!function(e){if(!p)return;p.update(s.a.nominations);let t=!1;if(e.status===o.a.StatusCode.Rejected)if(e.reasons.length>0){t=!1;for(const[n,a]of p.filter.reason)if(a.checked&&e.reasons.includes(n)){t=!0;break}}else t=p.filter.reason.get(o.a.Reason.undeclared).checked;else t=p.filter.status.get(e.status).checked;m.update(e,t)}(e)},m.events.openDetails=e=>{c.details.nomination=e,c.details.open()},c.import.import=e=>{s.a.importJSON(e)},t.menu.events.set(g.a.import.key,(()=>c.import.open()))}))}e.init=function(){document.documentElement.lang=i.a.language;const e=document.body;t.events.action.set(h.view.key,(()=>function(){if(!p)return;t.switchView(),p.switchView(),m.switchView()}())),t.events.action.set(h.signin.key,(()=>s.a.auth.signIn())),t.events.action.set(h.open.key,(()=>s.a.open())),t.events.action.set(h.about.key,(()=>c.about.open())),t.events.backToTop=()=>{m&&m.backToTop()},t.init(e),l.init(e),u=Object(a.a)("div",{className:"main-box"}),e.append(u),d.init(e),c.init(e),c.about.events.info=e=>{d.show(e)},r.init(e),function(){s.a.events.authStatusChanged=e=>b(e),navigator.onLine||b(!1);s.a.events.progressUpdate=e=>l.progress=e,s.a.events.bufferUpdate=e=>l.buffer=e,s.a.events.start=()=>{t.actions.get(h.open.key).hidden=!0,Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,66)),Promise.all([n.e(3),n.e(0),n.e(8)]).then(n.bind(null,71)),l.open()},s.a.events.idle=()=>{v().then((()=>{p.setVisible(!0),p.map.fit(s.a.nominations),p.refresh(s.a.nominations),m.show(s.a.nominations),t.actions.get(h.view.key).hidden=!1,t.menu.items.get(g.a.open.key).hidden=!0,t.menu.items.get(g.a.save.key).hidden=!1,t.menu.items.get(g.a.upload.key).hidden=!s.a.auth.signedIn,t.menu.items.get(g.a.migrate.key).hidden=!s.a.auth.signedIn,t.menu.items.get(g.a.import.key).hidden=!1,l.close()}))},s.a.events.clear=()=>{f()},s.a.events.match=(e,t,n)=>{v().then((()=>{c.match.events.close=n,c.match.nominations=[e,t],c.match.open()}))},s.a.events.alert=e=>{c.alert.message=e,c.alert.open()},s.a.events.info=e=>{d.show(e)},s.a.file.local.events.openUI=e=>{!function(e){const t=Object(a.a)("input",{type:"file",accept:"json",hidden:!0});t.addEventListener("change",(t=>{e(t.target.files[0])}),!1),document.body.append(t),t.click(),setTimeout((()=>{t.remove()}),1e3)}(e)},s.a.file.local.events.saveUI=(e,t)=>{!function(e,t){const n=Object(a.a)("a",{href:t,download:e,hidden:!0});document.body.append(n),n.click(),n.remove()}(e,t)}}()}}(W||(W={}))},34:function(e,t,n){},6:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.Prototype=class{constructor(){this.parent=null,Object.defineProperty(this,"parent",{enumerable:!1})}init(e){this.parent=e}render(){}}}(a||(a={}))},7:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(0);function i(e){return Object(a.a)("i",{className:"fa fa-fw",innerHTML:e})}!function(e){e.Icon={search:"",thList:"",times:"",clock:"",edit:"",infoCircle:"",arrowUp:"",plus:"",calendarAlt:"",folderOpen:"",globe:"",angleUp:"",angleDown:"",ellipsisV:"",trash:"",syncAlt:"",signInAlt:"",redoAlt:"",mapMarkerAlt:"",tachometerAlt:"",brain:""}}(i||(i={}))}}]);