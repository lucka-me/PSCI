(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{59:function(t,e,a){},60:function(t,e,a){},61:function(t,e,a){},62:function(t,e,a){},63:function(t,e,a){},64:function(t,e,a){},66:function(t,e,a){},67:function(t,e,a){},68:function(t,e,a){},69:function(t,e,a){},70:function(t,e,a){},71:function(t,e,a){},72:function(t,e,a){},73:function(t,e,a){},74:function(t,e,a){},75:function(t,e,a){},82:function(t,e,a){"use strict";a.r(e),a.d(e,"default",(function(){return l}));var s=a(3),i=a(86),n=a(1),o=a(5),r=a(17);a.d(e,"AppBarMenuItems",(function(){return r.a}));a(72);class l extends o.a{constructor(){super(...arguments),this.ctrl=null,this.items=new Map,this.events=new Map}init(t){super.init(t),this.render()}render(){const t=n.a.build("ul",{className:"mdc-list",role:"menu",ariaOrientation:"vertical"});for(const e of Object.values(r.a)){const a=n.a.build("li",{className:"mdc-list-item",role:"menuitem",dataset:{code:e.key},hidden:!0},[n.a.build("span",{className:"mdc-list-item__text",innerHTML:s.a.t(e.title)})]);this.items.set(e.key,a),t.append(a)}this.items.get(r.a.about.key).hidden=!1;const e=n.a.build("div",{className:"mdc-menu mdc-menu-surface"},[t]),a=n.a.build("div",{className:"mdc-menu-surface--anchor"},[e]);this.parent.append(a),this.ctrl=new i.a(e),this.ctrl.listen("MDCMenu:selected",t=>{this.events.get(t.detail.item.dataset.code)()})}open(){this.ctrl.open||(this.ctrl.open=!0)}}},83:function(t,e,a){"use strict";a.r(e);var s=a(3),i=a(44),n=a(84),o=a(1),r=a(6);a(75);class l extends r.a{constructor(){super(...arguments),this.textField=null,this.import=()=>{}}render(){const t=o.a.build("div",{className:["mdc-text-field","mdc-text-field--outlined","mdc-text-field--textarea","mdc-text-field--fullwidth"].join(" ")},[o.a.build("textarea",{className:"mdc-text-field__input code",id:"input-dialog-import-wayfarer",rows:8,cols:80}),o.a.build("div",{className:"mdc-notched-outline"},[o.a.build("div",{className:"mdc-notched-outline__leading"}),o.a.build("div",{className:"mdc-notched-outline__notch"},[o.a.build("label",{className:"mdc-floating-label",for:"input-dialog-import-wayfarer",innerHTML:"JSON"})]),o.a.build("div",{className:"mdc-notched-outline__trailing"})])]),e=r.a.buildDialog([o.a.build("h2",{className:"mdc-dialog__title",innerHTML:s.a.t("Import")}),o.a.build("div",{className:"mdc-dialog__content"},[t,o.a.build("div",{className:"mdc-text-field-helper-line"},[o.a.build("div",{className:"mdc-text-field-helper-text mdc-text-field-helper-text--persistent"},[s.a.t("From "),r.a.buildLink("https://wayfarer.nianticlabs.com/api/v1/vault/manage",s.a.t("Wayfarer API"),s.a.t("Wayfarer API"))])])]),o.a.build("footer",{className:"mdc-dialog__actions"},[r.a.buildDialogAction("close",s.a.t("Close")),r.a.buildDialogAction("import",s.a.t("Import"))])]);this.parent.append(e),this.ctrl=new i.a(e),this.textField=new n.a(t),this.ctrl.listen("MDCDialog:closed",t=>{"import"===t.detail.action&&this.import(this.textField.value)})}open(){this.ctrl||this.render(),this.textField.value="",this.ctrl.open()}}e.default=l},85:function(t,e,a){"use strict";a.r(e);var s=a(47),i=a.n(s),n=a(1),o=a(5),r=a(48),l=a.n(r);class d extends o.a{constructor(){super(),this.root=null,Object.defineProperty(this,"root",{enumerable:!1})}update(t){}updateStyle(){}setVisible(t){if(!this.root){if(!t)return;this.render()}this.root.hidden=!t}}class c extends d{constructor(){super(...arguments),this.chart=null}static get color(){return{border:"rgba(0, 0, 0, 0.2)",borderHover:"rgba(0, 0, 0, 0.4)"}}static buildChartCard(t,e,a,s){return n.a.build("div",{className:["mdc-card","mdc-card--outlined","padding--8","flex--"+a,"flex-shrink--1"].join(" "),cssText:`min-width:${s}px`},[n.a.build("span",{className:"mdc-typography--headline6",innerHTML:t}),n.a.build("div",{className:"container-chart"},[e])])}static fillTimeDataMap(t,e,a){let s=e;for(;s<=a;){const e=l()(s+1e3).startOf("month"),a=e.valueOf();t.has(a)||t.set(a,0),s=e.endOf("month").valueOf()}}}var h=a(3),u=a(14);class m extends d{updateStats(t){}}class p extends m{constructor(){super(...arguments),this.chart=null}static buildChartCard(t,e,a,s){return c.buildChartCard(t,e,a,s)}static fillTimeDataMap(t,e,a){c.fillTimeDataMap(t,e,a)}}a(59);var b=class extends m{constructor(){super(...arguments),this.textReviews=null,this.textSubtitle=null,this.actionRefresh=null,this.events={refresh:()=>{},clear:()=>{}}}render(){this.textReviews=n.a.build("span",{cssText:"font-weight:300;font-size:4.5rem;line-height:4.5rem;",innerHTML:"0"}),this.textSubtitle=n.a.build("span",{className:"mdc-typography--body1 text-nowrap",innerHTML:h.a.t("Reviews for Portals",{count:0})}),this.actionRefresh=n.a.build("button",{className:"mdc-button mdc-card__action mdc-card__action--button",disabled:!0},[n.a.build("div",{className:"mdc-button__ripple"}),n.a.build("i",{className:"fa fa-fw mdc-button__icon",innerHTML:""}),n.a.build("span",{className:"mdc-button__label",innerHTML:h.a.t("Refresh")})]);const t=new u.a(this.actionRefresh);t.unbounded=!0,t.listen("click",()=>{this.actionRefresh.disabled=!0,this.events.refresh()});const e=n.a.build("button",{className:["fa","mdc-icon-button","mdc-card__action","mdc-card__action--icon"].join(" "),title:h.a.t("Clear"),id:"button-card-nomination-location",innerHTML:""}),a=new u.a(e);a.unbounded=!0,a.listen("click",()=>{this.events.clear()}),this.root=n.a.build("div",{className:["mdc-card","mdc-card--outlined","flex--1","flex-shrink--1"].join(" ")},[n.a.build("div",{className:["flex-box-col","padding--8","flex-grow--1","flex-justify-content--between"].join(" ")},[n.a.build("span",{className:"mdc-typography--headline6",innerHTML:h.a.t("Brainstorming")}),this.textReviews,this.textSubtitle]),n.a.build("div",{className:"mdc-card__actions"},[n.a.build("div",{className:"mdc-card__action-buttons"},[this.actionRefresh]),n.a.build("div",{className:"mdc-card__action-icons"},[e])])]),this.setVisible(!1),this.parent.append(this.root)}updateStats(t){this.textReviews.innerHTML=""+t.review,this.textSubtitle.innerHTML=h.a.t("Reviews for Portals",{count:t.nomination}),this.actionRefresh.disabled=!1}},g=a(18);a(60);var f=class extends p{render(){const t=n.a.build("canvas",{className:"canvas-chart--h"});this.root=p.buildChartCard(h.a.t("Brainstorming Rates"),t,1,240),this.setVisible(!1),this.parent.append(this.root);const e=[];for(const t of Object.values(g.b))e.push(h.a.t(t));const a=getComputedStyle(document.documentElement);this.chart=new i.a(t.getContext("2d"),{type:"radar",data:{labels:e,datasets:[{data:[],borderColor:a.getPropertyValue("--mdc-theme-primary"),pointRadius:0}]},options:{legend:{display:!1},scale:{ticks:{display:!1,min:1,max:5,stepSize:1},angleLines:{color:a.getPropertyValue("--mdc-theme-text-disabled-on-light")},gridLines:{color:a.getPropertyValue("--mdc-theme-text-disabled-on-light")}}}})}updateStats(t){const e=[];for(const a of Object.keys(g.b)){const s=t.rate.get(a),i=s.reduce((t,e)=>t+e,0)/s.length;e.push(parseFloat(i.toFixed(2)))}this.chart.data.datasets[0].data=e,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.options.scale.angleLines.color=t.getPropertyValue("--mdc-theme-text-disabled-on-light"),this.chart.options.scale.gridLines.color=t.getPropertyValue("--mdc-theme-text-disabled-on-light"),this.chart.update()}};a(61);var y=class extends p{render(){const t=n.a.build("canvas",{className:"canvas-chart--h"});this.root=p.buildChartCard(h.a.t("Brainstorming Reviews"),t,3,300),this.setVisible(!1),this.parent.append(this.root);const e=getComputedStyle(document.documentElement);this.chart=new i.a(t.getContext("2d"),{type:"line",data:{labels:[],datasets:[{label:h.a.t("Reviews"),data:[],borderColor:e.getPropertyValue("--mdc-theme-primary"),pointRadius:0}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{unit:"month",tooltipFormat:"YYYY-MM",displayFormats:{month:"YYYY-MM"}}}]}}})}updateStats(t){if(t.reviewTimes.length<1)return this.chart.data.datasets[0].data=[],void this.chart.update();const e=new Map;let a=l()(t.reviewTimes[0]).startOf("month").valueOf(),s=a;for(const i of t.reviewTimes){const t=l()(i).startOf("month").valueOf();t<a?a=t:t>s&&(s=t),e.has(t)?e.set(t,e.get(t)+1):e.set(t,1)}p.fillTimeDataMap(e,a,s);const i=[];e.forEach((t,e)=>{i.push({t:e,y:t})}),i.sort((t,e)=>t.t-e.t),this.chart.data.datasets[0].data=i,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.update()}};a(62);var v=class extends m{constructor(){super(...arguments),this.textSynch=null}render(){this.textSynch=n.a.build("span",{cssText:"font-weight:300;font-size:6rem;line-height:6rem;",innerHTML:"0.0"}),this.root=n.a.build("div",{className:["mdc-card","mdc-card--outlined","padding--8","flex--1","flex-shrink--1","flex-justify-content--between"].join(" ")},[n.a.build("span",{className:"mdc-typography--headline6",innerHTML:h.a.t("Brainstorming Synch")}),n.a.build("span",{className:"text-nowarp"},[this.textSynch,n.a.build("span",{cssText:"font-size:2rem;line-height:2rem;",innerHTML:"%"})]),n.a.build("span",{className:"mdc-typography--body1 text-nowarp",innerHTML:h.a.t("Reviews match the result")})]),this.setVisible(!1),this.parent.append(this.root)}updateStats(t){const e=t.synch.total>0?t.synch.synched/t.synch.total:0;this.textSynch.innerHTML=""+(100*e).toFixed(1)}};var x=class extends d{constructor(){super(),this.basic=new b,this.rates=new f,this.synch=new v,this.reviews=new y,this.events={analyse:()=>({review:0,nomination:0,rate:new Map,reviewTimes:[],synch:{total:0,synched:0}})},Object.defineProperty(this,"events",{enumerable:!1})}init(t){this.forEach(e=>{e.init(t)})}update(t){const e=this.events.analyse(t);this.forEach(t=>{t.updateStats(e)})}updateStyle(){this.forEach(t=>{t.updateStyle()})}setVisible(t){this.forEach(e=>{e.setVisible(t)})}forEach(t){Object.values(this).forEach(t)}};a(63);var w=class extends c{render(){const t=n.a.build("canvas",{className:"canvas-chart--h"});this.root=c.buildChartCard(h.a.t("Count by Month"),t,3,300),this.setVisible(!1),this.parent.append(this.root);const e=getComputedStyle(document.documentElement),a=e.getPropertyValue("--mdc-theme-primary"),s=e.getPropertyValue("--mdc-theme-secondary");this.chart=new i.a(t.getContext("2d"),{type:"line",data:{labels:[],datasets:[{label:h.a.t("Submissions"),data:[],borderColor:a,pointBackgroundColor:a,pointRadius:0,fill:!1},{label:h.a.t("Results"),data:[],borderColor:s,pointBackgroundColor:s,pointRadius:0,fill:!1}]},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{type:"time",time:{unit:"month",tooltipFormat:"YYYY-MM",displayFormats:{month:"YYYY-MM"}}}]},tooltips:{mode:"x"}}})}update(t){if(0===t.length)return this.chart.data.datasets[0].data=[],this.chart.data.datasets[1].data=[],void this.chart.update();const e=new Map,a=new Map;let s=l()(t[0].confirmedTime).startOf("month").valueOf(),i=s;for(const n of t){const t=l()(n.confirmedTime).startOf("month").valueOf();if(t<s?s=t:t>i&&(i=t),e.has(t)?e.set(t,e.get(t)+1):e.set(t,1),!n.resultTime)continue;const o=l()(n.resultTime).startOf("month").valueOf();o>i&&(i=o),a.has(o)?a.set(o,a.get(o)+1):a.set(o,1)}c.fillTimeDataMap(e,s,i),c.fillTimeDataMap(a,s,i);const n=[],o=[];e.forEach((t,e)=>{n.push({t:e,y:t})}),a.forEach((t,e)=>{o.push({t:e,y:t})}),n.sort((t,e)=>t.t-e.t),o.sort((t,e)=>t.t-e.t),this.chart.data.datasets[0].data=n,this.chart.data.datasets[1].data=o,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].borderColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.data.datasets[1].borderColor=t.getPropertyValue("--mdc-theme-secondary"),this.chart.update()}},T=a(88),N=a(0);a(64);class k extends d{constructor(){super(...arguments),this.block={type:{root:null},reason:{root:null}},this.types=new Map,this.reasons=new Map,this.events={switchType:()=>{},switchReason:()=>{}}}render(){this.block.type.root=n.a.build("div",{className:"flex-box-row--nowrap"}),this.block.reason.root=n.a.build("div",{className:"flex-box-row--wrap"}),this.root=n.a.build("div",{className:["mdc-card","mdc-card--outlined","padding--8","flex--1","flex-shrink--0"].join(" ")},[n.a.build("span",{className:"mdc-typography--headline6",innerHTML:h.a.t("Filter")}),n.a.build("span",{className:"mdc-typography--subtitle1",innerHTML:h.a.t("Type")}),this.block.type.root,n.a.build("span",{className:"mdc-typography--subtitle1",innerHTML:h.a.t("Rejected")}),this.block.reason.root]),this.setVisible(!1),this.parent.append(this.root);for(const t of N.a.status.reasons.values()){const e=k.buildSwitch(this.block.reason,t,"rejected");e.listen("change",()=>{this.switchReason(t,e.checked)}),this.reasons.set(t,e)}for(const t of N.a.status.types.values()){const e=k.buildSwitch(this.block.type,t,t.key);e.listen("change",()=>this.switchType(t,e.checked)),this.types.set(t,e)}}switchType(t,e){if(t.code>100)for(const t of this.reasons.values())t.checked=e;this.events.switchType(t,e)}switchReason(t,e){this.events.switchReason(t,e);const a=N.a.status.types.get("rejected");e&&!this.types.get(a).checked&&(this.types.get(a).checked=!0,this.events.switchType(a,!0))}getFilter(t){const e=new Map;for(const[a,s]of t.entries())s.checked&&e.set(a.code,s.checked);return e}get typeFilter(){return this.getFilter(this.types)}get reasonFilter(){return this.getFilter(this.reasons)}static buildSwitch(t,e,a){const s="switch-filter-"+e.key,i=n.a.build("div",{className:"mdc-switch"},[n.a.build("div",{className:"mdc-switch__track"}),n.a.build("div",{className:"mdc-switch__thumb-underlay",id:s},[n.a.build("div",{className:"mdc-switch__thumb"},[n.a.build("input",{type:"checkbox",className:"mdc-switch__native-control",role:"switch"})])])]),o=n.a.build("div",{className:"mdc-switch-box margin-h--4"},[i,n.a.build("label",{className:"fa fa-fw status-"+a,for:s,title:h.a.t(e.title),innerHTML:e.icon})]);t.root.append(o);const r=new T.a(i);return r.checked=!0,r}}var _=a(53),S=a.n(_);a(65),a(66);class L extends d{constructor(){super(...arguments),this.ctrl=null,this.events={focus:()=>{},styleLoaded:()=>[]},this.enabledReasons=[],this.tasks=[]}render(){const t=n.a.build("div",{cssText:["width: 100%","height: 100%","clip-path: inset(100% round 4px)","-webkit-clip-path: inset(0 round 4px)"].join(";")});this.root=n.a.build("div",{className:"mdc-card mdc-card--outlined flex--3 flex-shrink--1",cssText:"min-width: 300px;"},[t]),this.parent.append(this.root),S.a.accessToken="pk.eyJ1IjoibHVja2EtbWUiLCJhIjoiY2p2NDk5NmRvMHFreTQzbzduemM1MHV4cCJ9.7XGmxnEJRoCDr-i5BBmBfw",this.ctrl=new S.a.Map({container:t,style:L.getStyle()}),this.ctrl.on("idle",()=>this.executeTasks()),this.ctrl.addControl(new S.a.NavigationControl),this.ctrl.addControl(new S.a.FullscreenControl),this.resize()}get loaded(){return this.ctrl&&this.ctrl.isStyleLoaded()}update(t){this.loaded?(this.updateRejected(t),this.updateSource("accepted",L.generateGeoJSON(t,[N.a.status.types.get("accepted").code])),this.updateSource("pending",L.generateGeoJSON(t,[N.a.status.types.get("pending").code]))):this.tasks.push(()=>this.update(t))}updateStyle(){this.loaded?(this.ctrl.setStyle(L.getStyle()),this.update(this.events.styleLoaded())):this.tasks.push(()=>this.updateStyle())}set reasonFilter(t){this.enabledReasons=[];for(const[e,a]of t.entries())a&&this.enabledReasons.push(e)}setTypeVisible(t,e){if(!this.loaded)return void this.tasks.push(()=>this.setTypeVisible(t,e));const a=e?"visible":"none";this.ctrl.setLayoutProperty(`potori-${t}-cluster`,"visibility",a),this.ctrl.setLayoutProperty(`potori-${t}-count`,"visibility",a),this.ctrl.setLayoutProperty(`potori-${t}-unclustered`,"visibility",a)}easeTo(t){if(!this.loaded)return void this.tasks.push(()=>this.easeTo(t));const e=this.ctrl.getZoom();this.ctrl.easeTo({center:t,zoom:e<15?15:e})}resize(){this.loaded?this.ctrl.resize():this.tasks.push(()=>this.resize())}fit(t){if(!this.loaded)return void this.tasks.push(()=>this.fit(t));const e={lng:-181,lat:-91},a={lng:181,lat:91};for(const s of t)s.lngLat&&(s.lngLat.lng>e.lng&&(e.lng=s.lngLat.lng),s.lngLat.lng<a.lng&&(a.lng=s.lngLat.lng),s.lngLat.lat>e.lat&&(e.lat=s.lngLat.lat),s.lngLat.lat<a.lat&&(a.lat=s.lngLat.lat));a.lng>-181&&this.ctrl.fitBounds([a,e],{linear:!0})}updateRejected(t){this.loaded?this.updateSource("rejected",L.generateGeoJSON(t,this.enabledReasons)):this.tasks.push(()=>this.updateRejected(t))}executeTasks(){const t=this.tasks.length;for(let e=0;e<t;e++)this.tasks.shift()()}updateSource(t,e){const a="potori-"+t,s=this.ctrl.getSource(a);if(s)return void s.setData(e);this.ctrl.addSource(a,{type:"geojson",data:e,cluster:!0});const i=getComputedStyle(document.documentElement),n=i.getPropertyValue("--color-"+t),o=i.getPropertyValue(`--color-${t}--dark`);this.ctrl.addLayer({id:a+"-cluster",type:"circle",source:a,filter:["has","point_count"],paint:{"circle-color":n,"circle-opacity":.6,"circle-stroke-width":4,"circle-stroke-color":o,"circle-radius":["step",["get","point_count"],20,50,30,100,40]}}),this.ctrl.addLayer({id:a+"-count",type:"symbol",source:a,filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":getComputedStyle(document.documentElement).getPropertyValue("--mdc-theme-on-surface")}}),this.ctrl.addLayer({id:a+"-unclustered",type:"circle",source:a,filter:["!",["has","point_count"]],paint:{"circle-color":n,"circle-radius":5,"circle-stroke-width":2,"circle-stroke-color":o}}),this.ctrl.on("click",a+"-cluster",t=>{const e=this.ctrl.queryRenderedFeatures(t.point,{layers:[a+"-cluster"]}),s=e[0].properties.cluster_id;this.ctrl.getSource(a).getClusterExpansionZoom(s,(t,a)=>{t||this.ctrl.easeTo({center:e[0].geometry.coordinates,zoom:a})})}),this.ctrl.on("click",a+"-unclustered",t=>{t.features[0].geometry.coordinates;const e=t.features[0].geometry.coordinates;for(;Math.abs(t.lngLat.lng-e[0])>180;)e[0]+=t.lngLat.lng>e[0]?360:-360;(new S.a.Popup).setLngLat(e).setText(t.features[0].properties.title).addTo(this.ctrl),this.events.focus(t.features[0].properties.id)})}static generateGeoJSON(t,e){const a={type:"FeatureCollection",features:[]};if(e.length<1)return a;for(const s of t)e.includes(s.status.code)&&s.lngLat&&a.features.push({type:"Feature",properties:{id:s.id,title:s.title,status:s.status},geometry:{type:"Point",coordinates:[s.lngLat.lng,s.lngLat.lat]}});return a}static getStyle(){return`mapbox://styles/mapbox/${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`}}var C=L;a(67);var M=class extends c{render(){const t=n.a.build("canvas",{className:"canvas-chart--h"});this.root=c.buildChartCard(h.a.t("Quotas"),t,2,200),this.setVisible(!1),this.parent.append(this.root);const e=[];for(let t=0;t<14;t++)e.push(""+t);const a=getComputedStyle(document.documentElement);this.chart=new i.a(t.getContext("2d"),{type:"bar",data:{labels:e,datasets:[{data:[],backgroundColor:a.getPropertyValue("--mdc-theme-primary"),hoverBackgroundColor:a.getPropertyValue("--mdc-theme-primary")}]},options:{legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0}}],xAxes:[{scaleLabel:{display:!0,labelString:h.a.t("Day")}}]}}})}update(t){const e=new Array(14).fill(0),a=Date.now();for(const s of t){const t=s.restoreTime;t>a&&(e[Math.floor((t-a)/864e5)]+=1)}this.chart.data.datasets[0].data=e,this.chart.update()}updateStyle(){if(!this.chart)return;const t=getComputedStyle(document.documentElement);this.chart.data.datasets[0].backgroundColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.data.datasets[0].hoverBackgroundColor=t.getPropertyValue("--mdc-theme-primary"),this.chart.update()}};a(68);class R extends c{render(){const t=n.a.build("canvas",{className:"canvas-chart--v"});this.root=c.buildChartCard(h.a.t("Stats Rejected"),t,2,250),this.setVisible(!1),this.parent.append(this.root),this.chart=new i.a(t.getContext("2d"),{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:[],borderAlign:"inner",borderColor:R.color.border,hoverBackgroundColor:[],hoverBorderColor:R.color.borderHover}]},options:{legend:{display:!0,position:"right"}}})}update(t){const e=new Map;for(const t of N.a.status.reasons.values())e.set(t,0);t.reduce((t,e)=>{if(e.status.code<100)return t;const a=e.status;return t.set(a,t.get(a)+1),t},e);const a=[],s=[],i=[];for(const[t,n]of e.entries())n<1||(a.push(h.a.t(t.title)),s.push(t.color),i.push(n));this.chart.data.labels=a,this.chart.data.datasets[0].data=i,this.chart.data.datasets[0].backgroundColor=s,this.chart.data.datasets[0].hoverBackgroundColor=s,this.chart.update()}}var j=R;a(69);class H extends c{render(){const t=n.a.build("canvas",{className:"canvas-chart--v"});this.root=c.buildChartCard(h.a.t("Stats Type"),t,2,250),this.setVisible(!1),this.parent.append(this.root),this.chart=new i.a(t.getContext("2d"),{type:"doughnut",data:{labels:[],datasets:[{data:[],backgroundColor:[],borderAlign:"inner",borderColor:H.color.border,hoverBackgroundColor:[],hoverBorderColor:H.color.borderHover}]},options:{legend:{display:!0,position:"right"}}})}update(t){const e=new Map;for(const t of N.a.status.types.values())e.set(t.key,0);t.reduce((t,e)=>{const a=e.status.code>100?"rejected":e.status.key;return t.set(a,t.get(a)+1),t},e);const a=[],s=[],i=[],n=getComputedStyle(document.documentElement);for(const[t,o]of e.entries()){if(o<1)continue;const e=N.a.status.types.get(t);a.push(h.a.t(e.title)),s.push(n.getPropertyValue("--color-"+t)),i.push(o)}this.chart.data.labels=a,this.chart.data.datasets[0].data=i,this.chart.data.datasets[0].backgroundColor=s,this.chart.data.datasets[0].hoverBackgroundColor=s,this.chart.update()}}var D=H;a(70);class O extends o.a{constructor(){super(),this.root=null,this.map=new C,this.filter=new k,this.statsType=new D,this.statsRejected=new j,this.countByMonth=new w,this.quotas=new M,this.bs=new x,Object.defineProperty(this,"root",{enumerable:!1})}init(t){super.init(t),i.a.defaults.global.legend.labels.boxWidth=10,i.a.defaults.global.maintainAspectRatio=!1,i.a.defaults.line.tooltips={intersect:!1},i.a.defaults.doughnut.tooltips={callbacks:{label:(t,e)=>{const a=e.datasets[t.datasetIndex],s=a._meta,i=s[Object.keys(s)[0]].data,n=a.data.reduce((t,e,a)=>t+(i[a].hidden?0:e),0),o=a.data[t.index],r=(o/n*100).toFixed(2);return`${e.labels[t.index]}: ${o} (${r}%)`}}},i.a.defaults.radar.tooltips={intersect:!1,callbacks:{title:(t,e)=>e.labels[t[0].index]}},this.render(),this.forEach(t=>{t.init(this.root)})}render(){this.root=n.a.build("div",{className:["flex--2","flex-box-row--wrap","flex-align-items--start","flex-align-content--start","padding--4","dashboard"].join(" "),cssText:["height: 100%","box-sizing: border-box","overflow-y: scroll","scroll-behavior: smooth","-webkit-overflow-scrolling: touch"].join(";")}),this.parent.append(this.root)}refresh(t){this.map.reasonFilter=this.filter.reasonFilter,this.forEach(e=>{e.update(t)})}update(t){this.map.reasonFilter=this.filter.reasonFilter,this.map.update(t),this.statsType.update(t),this.statsRejected.update(t),this.countByMonth.update(t),this.bs.update(t)}updateStyle(){this.forEach(t=>{t.updateStyle()})}setVisible(t){this.forEach(e=>{e.setVisible(t)}),this.map.resize()}forEach(t){Object.values(this).forEach(t)}}e.default=O},91:function(t,e,a){"use strict";a.r(e);var s=a(3),i=a(1),n=a(0),o=a(5),r=a(14);a(71);var l=class{static build(t,e,a){const o=["margin-r--8","flex-box-row--nowrap","flex-align-items--center"].join(" "),l=[];l.push(i.a.build("span",{className:o},[i.a.icon("&#xf062"),i.a.build("span",{className:"margin-l--4",innerHTML:t.confirmedDateString})]));t.restoreTime>e&&l.push(i.a.build("span",{className:o},[i.a.icon("&#xf2f9"),i.a.build("span",{className:"margin-l--4",innerHTML:t.restoreIntervalString})])),l.push(i.a.build("span",{className:o},[i.a.icon("&#xf017"),i.a.build("span",{className:"margin-l--4",id:"text-card-nomination-interval"})])),l.push(i.a.build("span",{className:o,id:"box-card-nomination-result"},[i.a.icon("&#xf00c"),i.a.build("span",{className:"margin-l--4"})]));const d=["object-fit: cover","object-position: center","width: 120px","min-width: 120px","height: 120px","min-height: 120px"].join(";"),c=i.a.build("div",{className:"mdc-card__primary-action"},[i.a.build("div",{className:"flex-box-row--nowrap"},[i.a.build("img",{cssText:d,src:t.imageUrl,loading:"lazy"}),i.a.build("div",{className:["padding--8","flex-box--col","flex-align-items--start","flex-justify-content--start"].join(" ")},[i.a.build("span",{className:"mdc-typography--headline6",innerHTML:t.title}),i.a.build("div",{className:"mdc-typography--body2 flex-box-row--wrap"},l)])])]);new r.a(c).listen("click",a.openDetails);const h=i.a.build("button",{className:"mdc-button mdc-card__action mdc-card__action--button"},[i.a.build("div",{className:"mdc-button__ripple"}),i.a.build("i",{className:"fa fa-fw mdc-button__icon"}),i.a.build("span",{className:"mdc-button__label"})]),u=new r.a(h);u.unbounded=!0,u.listen("click",a.openBs);const m=[],p=["fa","mdc-icon-button","mdc-card__action","mdc-card__action--icon"].join(" "),b=i.a.build("button",{className:p,title:s.a.t("Location"),id:"button-card-nomination-location",hidden:!0,innerHTML:"&#xf3c5"}),g=new r.a(b);if(g.unbounded=!0,g.listen("click",a.focus),m.push(b),n.a.version.full){const e=i.a.build("button",{className:p,title:s.a.t("Intel Map"),id:"button-card-nomination-intel",hidden:!0,innerHTML:"&#xf279"}),a=new r.a(e);a.unbounded=!0,a.listen("click",()=>{window.open(t.intelUrl,"_blank","noopener")}),m.push(e)}return i.a.build("div",{className:"mdc-card mdc-card--outlined flex-shrink--0",id:"card-"+t.id},[c,i.a.build("div",{className:"mdc-card__actions"},[i.a.build("div",{className:"mdc-card__action-buttons"},[h]),i.a.build("div",{className:"mdc-card__action-icons"},m)])])}static update(t,e){const a=e.querySelector("#box-card-nomination-result"),i=n.a.status.getTypeByCode(t.status.code);e.querySelector("#text-card-nomination-interval").innerHTML=t.intervalString,t.status.code>0?(a.hidden=!1,a.querySelector("i").innerHTML=n.a.status.types.get(i).icon,a.querySelector("span").innerHTML=t.resultDateString):a.hidden=!0;const o=e.querySelector(".mdc-card__action-buttons > button");o.className="mdc-button mdc-card__action mdc-card__action--button status-"+i,o.querySelector("i").innerHTML=t.status.icon,o.querySelector("span").innerHTML=s.a.t(t.status.title)}static updateLocation(t,e){const a=!t.lngLat;if(e.querySelector("#button-card-nomination-location").hidden=a,!n.a.version.full)return;e.querySelector("#button-card-nomination-intel").hidden=a}};class d extends o.a{constructor(){super(...arguments),this.root=null,this.now=Date.now(),this.events={alert:()=>{},focus:()=>{},openDetails:()=>{}}}init(t){super.init(t),this.render()}render(){this.root=i.a.build("div",{className:["flex--1","flex-box-col","view-hide"].join(" "),cssText:["height: 100%","min-width: 300px","padding: 4px","box-sizing: border-box","overflow-y: scroll","scroll-behavior: smooth","-webkit-overflow-scrolling: touch"].join(";")}),this.parent.append(this.root)}clear(){this.root.innerHTML=""}show(t){this.clear();const e=t.map(t=>{const e=l.build(t,this.now,{focus:()=>{this.events.focus(t)},openBs:()=>{if(n.a.version.full)window.open(t.bsUrl,"_blank","noopener");else{const e=i.a.build("textarea",{value:t.id,readOnly:!0});document.body.append(e),e.select(),document.execCommand("copy"),e.remove(),this.events.alert(s.a.t("message:Brainstorming ID copied",{id:t.id}))}},openDetails:()=>this.events.openDetails(t)});return l.update(t,e),t.lngLat&&l.updateLocation(t,e),e});this.root.append(...e)}update(t,e){const a=this.root.querySelector("#card-"+t.id);l.update(t,a),l.updateLocation(t,a),a.hidden=!e}}e.default=d},92:function(t,e,a){"use strict";a.r(e);var s=a(3),i=a(87),n=a(44),o=a(90),r=a(89),l=a(84),d=a(1),c=a(0),h=a(6),u=a(53),m=a.n(u),p=a(14),b=a(18),g=a(5);a(73);class f extends g.a{constructor(){super(...arguments),this.ctrl=null,this.marker=null,this.dialog=null,this.nomination=null,this.buttons={edit:{root:null,icon:"",clicked:()=>this.edit()},search:{root:null,icon:"",clicked:()=>this.search()},delete:{root:null,icon:"",clicked:()=>this.delete()}},this.events={alert:()=>{},queryLngLat:()=>{}}}init(t){super.init(t),this.render()}render(){const t=[];for(const e of Object.values(this.buttons)){e.root=d.a.build("button",{className:"fa mdc-icon-button",innerHTML:e.icon});const a=new p.a(e.root);a.unbounded=!0,a.listen("click",e.clicked),t.push(e.root)}const e=d.a.build("div",{className:"flex-grow--1",cssText:"min-height: 180px"}),a=d.a.build("div",{className:"flex-box-row--nowrap margin-v--8"},[d.a.build("div",{className:"flex-box-col flex-justify-content--around"},t),e]);this.parent.append(a),this.ctrl=new m.a.Map({container:e,style:f.getStyle()}),this.ctrl.addControl(new m.a.NavigationControl)}set(t){this.nomination=t,this.delete(),this.nomination.lngLat&&a.e(0).then(a.t.bind(null,53,7)).then(t=>{this.marker=(new t.Marker).setLngLat(this.nomination.lngLat).addTo(this.ctrl),this.ctrl.jumpTo({center:this.nomination.lngLat,zoom:16}),this.buttons.delete.root.disabled=!1,this.buttons.edit.root.innerHTML=""}),this.buttons.search.root.disabled=!1}edit(){this.marker?this.marker.setDraggable(!0):a.e(0).then(a.t.bind(null,53,7)).then(t=>{this.marker=(new t.Marker).setLngLat(this.ctrl.getCenter()).setDraggable(!0).addTo(this.ctrl),this.buttons.delete.root.disabled=!1,this.buttons.edit.root.innerHTML=""})}search(){this.buttons.search.root.disabled=!0,this.events.queryLngLat(this.nomination.id,t=>{this.dialog.isOpen&&(this.marker?(this.marker.setLngLat(t),this.marker.setDraggable(!1)):a.e(0).then(a.t.bind(null,53,7)).then(e=>{this.marker=(new e.Marker).setLngLat(t).setDraggable(!1).addTo(this.ctrl)}),this.ctrl.easeTo({center:t,zoom:16}),this.buttons.edit.root.innerHTML="",this.buttons.search.root.disabled=!1,this.buttons.delete.root.disabled=!1)},t=>{if(!this.dialog.isOpen)return;switch(t){case b.a.FIREBASE_ERROR:this.events.alert(s.a.t("message:Failed to query Firebase"));break;case b.a.NOT_EXIST:this.events.alert(s.a.t("message:Nomination not exists in database"))}this.buttons.search.root.disabled=!1})}delete(){this.marker&&this.marker.remove(),this.marker=null,this.buttons.edit.root.innerHTML="",this.buttons.delete.root.disabled=!0}updateStyle(){this.ctrl&&this.ctrl.setStyle(f.getStyle())}static getStyle(){return`mapbox://styles/mapbox/${getComputedStyle(document.documentElement).getPropertyValue("--map-style").trim()}?optimize=true`}}a(74);class y extends h.a{constructor(){super(...arguments),this.nomination=null,this.headingTitle=null,this.image=null,this.textConfirmedTime=null,this.status=new Map,this.selectedStatus=null,this.fieldResultTime=null,this.elementChipSetReason=null,this.chipSetReason=null,this.map=new f,this.events={alert:()=>{},query:()=>{},update:()=>{}}}render(){this.headingTitle=d.a.build("h2",{className:"mdc-dialog__title",dataset:{mdcDialogInitialFocus:""},innerHTML:""}),this.image=d.a.build("img",{cssText:["object-fit:cover","object-position:center","width:100%","height:150px;"].join(";")}),this.textConfirmedTime=d.a.build("span",{className:"margin-l--4"});const t=[];for(const e of c.a.status.types.keys()){const a="radio-dialog-details-status-"+e,s=d.a.build("input",{type:"radio",className:"mdc-radio__native-control",name:"radio-dialog-details-status",value:e});s.addEventListener("change",t=>{const e=t.target;this.selectedStatus=e.value,this.fieldResultTime.root.hidden="pending"===e.value,this.fieldResultTime.layout(),this.elementChipSetReason.hidden=!("rejected"===e.value),this.map.ctrl.resize()});const i=d.a.build("div",{className:"mdc-radio"},[s,d.a.build("div",{className:"mdc-radio__background"},[d.a.build("div",{className:"mdc-radio__outer-circle"}),d.a.build("div",{className:"mdc-radio__inner-circle"})])]),n=d.a.build("div",{className:"mdc-form-field"},[i,d.a.build("label",{for:a,className:"fa status-"+e,innerHTML:c.a.status.types.get(e).icon})]),l=new r.a(i);this.status.set(e,l);new o.a(n).input=l,t.push(n)}const e=d.a.build("div",{className:["mdc-text-field","mdc-text-field--outlined","mdc-text-field--with-leading-icon","margin-v--8","margin-h--4","fullwidth"].join(" ")},[d.a.build("i",{className:["fa","mdc-text-field__icon","mdc-text-field__icon--leading"].join(" "),innerHTML:""}),d.a.build("input",{type:"datetime-local",className:"mdc-text-field__input",id:"input-dialog-details-result-time"}),y.buildNotchedOutline({for:"input-dialog-details-result-time",innerHTML:s.a.t("Result Time")})]);this.fieldResultTime=new l.a(e);const a=[];for(const[t,e]of c.a.status.reasons.entries())a.push(d.a.build("div",{className:"mdc-chip",id:"details-reason-"+t,role:"row"},[d.a.build("div",{className:"mdc-chip__ripple"}),d.a.build("span",{role:"gridcell"},[d.a.build("span",{className:"mdc-chip__primary-action",role:"button"},[d.a.build("span",{className:"mdc-chip__text",innerHTML:s.a.t(e.title)})])])]));this.elementChipSetReason=d.a.build("div",{className:"mdc-chip-set mdc-chip-set--choice",role:"grid"},a),this.chipSetReason=new i.a(this.elementChipSetReason);const u=d.a.build("div",{className:"mdc-dialog__content"},[d.a.build("div",{className:["mdc-typography--body1","flex-box-row--nowrap","flex-align-items--center"].join(" ")},[d.a.icon("&#xf062"),this.textConfirmedTime]),d.a.build("div",{className:["fullwidth","flex-box-row--nowrap","flex-justify-content--around"].join(" ")},t),e,this.elementChipSetReason]);this.map.init(u);const m=h.a.buildDialog([this.headingTitle,this.image,u,d.a.build("footer",{className:"mdc-dialog__actions"},[h.a.buildDialogAction("close","Close"),h.a.buildDialogAction("save","Save")])]);this.parent.append(m),this.ctrl=new n.a(m),this.ctrl.listen("MDCDialog:opened",()=>this.opened()),this.ctrl.listen("MDCDialog:closed",t=>this.closed(t)),this.map.dialog=this.ctrl}opened(){this.fieldResultTime.layout(),this.map.ctrl.resize()}closed(t){if("save"!==t.detail.action)return;const e=c.a.status.getTypeByCode(this.nomination.status.code),a=c.a.status.getReasonByCode(this.nomination.status.code),i=this.selectedStatus;let n=!1;if("pending"!==i){const t=Date.parse(this.fieldResultTime.value);if(!t)return void this.events.alert(s.a.t("message:Invalid DateTime"));const e=t+6e4*(new Date).getTimezoneOffset();this.nomination.resultTime&&Math.floor(this.nomination.resultTime/6e4)===Math.floor(e/6e4)||(this.nomination.resultTime=e,n=!0)}const o=this.chipSetReason.selectedChipIds.length>0?this.chipSetReason.selectedChipIds[0].replace("details-reason-",""):"undeclared";if((i!==e||"rejected"===e&&a.key!==o)&&(n=!0),this.map.marker){const t=this.map.marker.getLngLat();this.nomination.lngLat&&this.nomination.lngLat.lng===t.lng&&this.nomination.lngLat.lat===t.lat||(this.nomination.lngLat=t,n=!0)}else this.nomination.lngLat&&(this.nomination.lngLat=null,n=!0);n&&("rejected"!==this.selectedStatus?this.nomination.status=c.a.status.types.get(this.selectedStatus):this.nomination.status=c.a.status.reasons.get(o),this.events.update(this.nomination))}open(t){this.ctrl||this.render(),this.nomination=t,this.map.set(t);const e=c.a.status.getTypeByCode(t.status.code);this.headingTitle.innerHTML=t.title,this.image.src=t.imageUrl,this.textConfirmedTime.innerHTML=new Date(t.confirmedTime).toLocaleString(),this.fieldResultTime.root.hidden="pending"===e;const a=t=>{const e=new Date;return e.setTime(t-6e4*e.getTimezoneOffset()),e.toISOString()},s=a(t.resultTime?t.resultTime:Date.now());if(this.fieldResultTime.value=s.slice(0,s.lastIndexOf(":")),this.elementChipSetReason.hidden=!("rejected"===e),"rejected"===e){const e="details-reason-"+t.status.key;this.chipSetReason.chips.forEach(t=>{t.selected=t.id===e})}"pending"===e&&this.events.query(t.id,t=>{const e=a(t.lastTime);this.fieldResultTime.value=e.slice(0,e.lastIndexOf(":")),this.fieldResultTime.layout()},()=>{}),this.status.get(e).checked=!0,this.selectedStatus=e,this.ctrl.open()}updateStyle(){this.map.updateStyle()}static buildNotchedOutline(t){return t.className="mdc-floating-label",d.a.build("div",{className:"mdc-notched-outline"},[d.a.build("div",{className:"mdc-notched-outline__leading"}),d.a.build("div",{className:"mdc-notched-outline__notch"},[d.a.build("label",t)]),d.a.build("div",{className:"mdc-notched-outline__trailing"})])}}e.default=y}}]);