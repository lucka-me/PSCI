(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["brainstorming"],{"14cd":function(t,e,a){},1923:function(t){t.exports=JSON.parse('{"en":{"title":"Brainstorming","update":"Update","updating":"Updating Brainstorming","updateInform":"Updated {count} records."},"zh":{"title":"Brainstorming","update":"更新","updating":"正在更新Brainstorming","updateInform":"更新了{count}条记录。"}}')},"2fe3":function(t){t.exports=JSON.parse('{"en":{"title":"Coverage","covered":"Covered","notCovered":"Not Covered"},"zh":{"title":"覆盖率","covered":"已覆盖","notCovered":"未覆盖"}}')},"7f91":function(t){t.exports=JSON.parse('{"en":{"title":"Reviews by Month"},"zh":{"title":"每月审查次数"}}')},"83d4":function(t){t.exports=JSON.parse('{"en":{"title":"Synch","synched":"Synched","notSynched":"Not Synched"},"zh":{"title":"同步率","synched":"同步","notSynched":"不同步"}}')},"88b2":function(t,e,a){"use strict";a.r(e);var s=a("7a23");const o={key:0,class:"brainstorming"},r={key:0,class:"progress"},i={key:1,class:"grid grid--1-1-1"};function n(t,e,a,n,c,l){const d=Object(s["A"])("material-icon-button"),u=Object(s["A"])("material-top-app-bar"),h=Object(s["A"])("material-top-app-bar-adjust"),b=Object(s["A"])("material-linear-progress"),p=Object(s["A"])("coverage-chart"),O=Object(s["A"])("rates-chart"),f=Object(s["A"])("synch-chart"),j=Object(s["A"])("reviews-by-month-chart");return Object(s["t"])(),Object(s["e"])(s["a"],null,[Object(s["i"])(u,{title:t.$t("title"),"navi-back":""},{default:Object(s["F"])(()=>[t.canUpdate?(Object(s["t"])(),Object(s["e"])(d,{key:0,icon:"redo",title:t.$t("update"),onClick:t.update},null,8,["title","onClick"])):Object(s["f"])("",!0)]),_:1},8,["title"]),Object(s["i"])(h),t.$store.getters.empty?Object(s["f"])("",!0):(Object(s["t"])(),Object(s["e"])("main",o,[t.updating?(Object(s["t"])(),Object(s["e"])("div",r,[Object(s["i"])("div",null,Object(s["C"])(t.$t("updating")),1),Object(s["i"])(b,{progress:t.$store.state.progress,determinate:""},null,8,["progress"])])):Object(s["f"])("",!0),t.idle?(Object(s["t"])(),Object(s["e"])("div",i,[Object(s["i"])(p),Object(s["i"])(O),Object(s["i"])(f)])):Object(s["f"])("",!0),t.idle?(Object(s["t"])(),Object(s["e"])(j,{key:2})):Object(s["f"])("",!0)]))],64)}var c=a("9ab4"),l=a("9b4a"),d=(a("cadc"),a("ce1f")),u=a("6022"),h=a("42b4"),b=a("0613"),p=a("81dd"),O=a("ea0e"),f=a("2281"),j=a("4892");function g(t,e,a,o,r,i){const n=Object(s["A"])("chart-view"),c=Object(s["A"])("chart-block");return Object(s["t"])(),Object(s["e"])(c,{title:t.title},{default:Object(s["F"])(()=>[Object(s["i"])(n,{"chart-type":"doughnut","chart-datasets":t.datasets,"chart-labels":t.labels,"chart-options":t.options},null,8,["chart-datasets","chart-labels","chart-options"])]),_:1},8,["title"])}var m,y=a("1b40"),v=a("ad8e"),C=a("240d"),$=a("6163"),S=a("2fe3");let k=m=class extends y["d"]{constructor(){super(...arguments),this.options={plugins:{legend:{display:!0,position:"right"}}},this.datasets=[],this.rate=0}get title(){const t=this.$t("title");return 0===this.rate?t:`${t} | ${this.rate.toFixed(2)}%`}get labels(){return[this.$t("covered"),this.$t("notCovered")]}mounted(){this.updateData()}updateData(){return Object(c["b"])(this,void 0,void 0,(function*(){const t=this.$store.state.nominations,e=[0,0],a=[];for(const o of t){const t=v["a"].contains(o).then(t=>{e[t?0:1]++});a.push(t)}yield Promise.allSettled(a);const s={data:e,backgroundColor:m.colors,borderAlign:"inner",borderColor:"rgba(0, 0, 0, 0.2)",hoverBackgroundColor:m.colors,hoverBorderColor:"rgba(0, 0, 0, 0.4)"};this.datasets=[s],e[0]>0||e[1]>0?this.rate=e[0]/(e[0]+e[1])*100:this.rate=0}))}};k.colors=["royalblue","gray"],k=m=Object(c["c"])([Object(y["b"])({components:{ChartBlock:C["a"],ChartView:$["a"]},i18n:{messages:S}})],k);var A=k;A.render=g;var w=A;function x(t,e,a,o,r,i){const n=Object(s["A"])("chart-view"),c=Object(s["A"])("chart-block");return Object(s["t"])(),Object(s["e"])(c,{title:t.$t("title")},{default:Object(s["F"])(()=>[Object(s["i"])(n,{"chart-type":"radar","chart-datasets":t.datasets,"chart-labels":t.labels,"chart-options":t.options},null,8,["chart-datasets","chart-labels","chart-options"])]),_:1},8,["title"])}var B=a("d475");let N=class extends y["d"]{constructor(){super(...arguments),this.options={elements:{line:{tension:0}},scales:{r:{min:1,max:5,ticks:{stepSize:1}}},plugins:{legend:{display:!1}}},this.datasets=[]}get labels(){return[this.$t("quality"),this.$t("description"),this.$t("cultural"),this.$t("uniqueness"),this.$t("safety"),this.$t("location")]}mounted(){this.updateData()}updateData(){return Object(c["b"])(this,void 0,void 0,(function*(){const t=this.$store.state.nominations,e=[];for(let i=0;i<6;++i)e.push({count:0,rate:0});const a=(t,e)=>{if(!t)return;const a=parseInt(t);isNaN(a)||(e.count++,e.rate+=a)},s=[];for(const i of t){const t=v["a"].getFromLocal(i).then(t=>{if(t)for(const[s,o]of Object.entries(t)){if(!s.startsWith("review_"))continue;const t=o;a(t.JSON.quality,e[0]),a(t.JSON.description,e[1]),a(t.JSON.cultural,e[2]),a(t.JSON.uniqueness,e[3]),a(t.JSON.safety,e[4]),a(t.JSON.location,e[5])}});s.push(t)}yield Promise.allSettled(s);const o=e.map(t=>t.rate/t.count),r={data:o,borderColor:"royalblue"};this.datasets=[r]}))}};N=Object(c["c"])([Object(y["b"])({components:{ChartBlock:C["a"],ChartView:$["a"]},i18n:{messages:B}})],N);var J=N;J.render=x;var M=J;function D(t,e,a,o,r,i){const n=Object(s["A"])("chart-view"),c=Object(s["A"])("chart-block");return Object(s["t"])(),Object(s["e"])(c,{title:t.$t("title")},{default:Object(s["F"])(()=>[Object(s["i"])(n,{"chart-type":"line","chart-datasets":t.datasets,"chart-options":t.options},null,8,["chart-datasets","chart-options"])]),_:1},8,["title"])}var F=a("1315"),q=a("7f91");let R=class extends y["d"]{constructor(){super(...arguments),this.options={scales:{x:{type:"time",time:{unit:"month",tooltipFormat:"yyyy-MM",displayFormats:{month:"yyyy-MM"}}}},plugins:{legend:{display:!1},tooltip:{mode:"x"}}},this.datasets=[]}mounted(){this.updateData()}updateData(){return Object(c["b"])(this,void 0,void 0,(function*(){const t=this.$store.state.nominations,e=new Map;if(t.length>0){let a=F["DateTime"].fromMillis(t[0].confirmedTime).startOf("month").valueOf(),s=a;const o=[];for(const r of t){const t=v["a"].getFromLocal(r).then(t=>{var o;if(t)for(const[r,i]of Object.entries(t)){if(!r.startsWith("review_"))continue;const t=i,n=F["DateTime"].fromMillis(t.Timestamp).startOf("month").valueOf();n<a?a=n:n>s&&(s=n),e.set(n,(null!==(o=e.get(n))&&void 0!==o?o:0)+1)}});o.push(t)}yield Promise.allSettled(o),Object(C["b"])(e,a,s)}const a=[];for(const[o,r]of e)a.push({x:o,y:r});a.sort((t,e)=>t.x-e.x);const s={data:a,borderColor:"royalblue",pointBackgroundColor:"royalblue",pointRadius:0,fill:!0};this.datasets=[s]}))}};R=Object(c["c"])([Object(y["b"])({components:{ChartBlock:C["a"],ChartView:$["a"]},i18n:{messages:q}})],R);var _=R;_.render=D;var z=_;function I(t,e,a,o,r,i){const n=Object(s["A"])("chart-view"),c=Object(s["A"])("chart-block");return Object(s["t"])(),Object(s["e"])(c,{title:t.title},{default:Object(s["F"])(()=>[Object(s["i"])(n,{"chart-type":"doughnut","chart-datasets":t.datasets,"chart-labels":t.labels,"chart-options":t.options},null,8,["chart-datasets","chart-labels","chart-options"])]),_:1},8,["title"])}var P,T=a("ce89"),U=a("83d4");let L=P=class extends y["d"]{constructor(){super(...arguments),this.options={plugins:{legend:{display:!0,position:"right"}}},this.datasets=[],this.rate=0}get title(){const t=this.$t("title");return 0===this.rate?t:`${t} | ${this.rate.toFixed(2)}%`}get labels(){return[this.$t("synched"),this.$t("notSynched")]}mounted(){this.updateData()}updateData(){return Object(c["b"])(this,void 0,void 0,(function*(){const t=this.$store.state.nominations,e=[0,0],a=[];for(const o of t){if(o.status===T["a"].StatusCode.Pending)continue;let t=!0,s=!1;o.status===T["a"].StatusCode.Rejected?o.reasons.includes(T["a"].Reason.duplicated)?s=!0:o.reasons.includes(T["a"].Reason.close)&&(t=!1):t=!1;const r=v["a"].getFromLocal(o).then(a=>{if(a)for(const[o,r]of Object.entries(a)){if(!o.startsWith("review_"))continue;const a=r;if("D"===a.stars){e[s?0:1]++;continue}const i=parseInt(a.stars);isNaN(i)||(i<3&&t||i>=3&&!t?e[0]++:e[1]++)}});a.push(r)}yield Promise.allSettled(a);const s={data:e,backgroundColor:P.colors,borderAlign:"inner",borderColor:"rgba(0, 0, 0, 0.2)",hoverBackgroundColor:P.colors,hoverBorderColor:"rgba(0, 0, 0, 0.4)"};this.datasets=[s],e[0]>0||e[1]>0?this.rate=e[0]/(e[0]+e[1])*100:this.rate=0}))}};L.colors=["royalblue","gray"],L=P=Object(c["c"])([Object(y["b"])({components:{ChartBlock:C["a"],ChartView:$["a"]},i18n:{messages:U}})],L);var V=L;V.render=I;var W=V,Q=a("1923");let E=class extends d["b"]{get canUpdate(){return!this.$store.getters.empty&&this.$store.state.status===b["a"].Status.idle}created(){l["e"].register(l["a"],l["j"],l["m"],l["f"],l["i"],l["n"],l["o"],l["k"],l["p"],l["g"],l["q"],l["h"]),l["e"].defaults.maintainAspectRatio=!1,l["e"].defaults.plugins.legend.labels.boxWidth=10,l["e"].defaults.plugins.tooltip.intersect=!1,l["e"].defaults.elements.line.tension=.1}get updating(){return this.$store.state.status===b["a"].Status.queryingBrainstorming}get idle(){return this.$store.state.status===b["a"].Status.idle}update(){return Object(c["b"])(this,void 0,void 0,(function*(){const t=yield u["a"].updateBrainstorming();h["a"].inform(this.$t("updateInform",{count:t}))}))}};E=Object(c["c"])([Object(d["a"])({components:{MaterialTopAppBar:f["a"],MaterialTopAppBarAdjust:j["a"],MaterialIconButton:p["a"],MaterialLinearProgress:O["a"],CoverageChart:w,RatesChart:M,SynchChart:W,ReviewsByMonthChart:z},i18n:{messages:Q}})],E);var G=E;a("fb9f");G.render=n;e["default"]=G},d475:function(t){t.exports=JSON.parse('{"en":{"title":"Rates","quality":"Quality","description":"Description","cultural":"Cultura","uniqueness":"Uniqueness","safety":"Safety","location":"Location"},"zh":{"title":"评分","quality":"质量","description":"描述","cultural":"文化","uniqueness":"独特","safety":"安全","location":"位置"}}')},fb9f:function(t,e,a){"use strict";a("14cd")}}]);
//# sourceMappingURL=brainstorming.ae017023.js.map