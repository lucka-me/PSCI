(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["firebase"],{4362:function(e,t,n){t.nextTick=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),setTimeout((function(){e.apply(null,t)}),0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,r="/";t.cwd=function(){return r},t.chdir=function(t){e||(e=n("df7c")),r=e.resolve(t,r)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},a8e9:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return T})),n.d(t,"c",(function(){return M})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return R})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return q})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return V})),n.d(t,"n",(function(){return G})),n.d(t,"o",(function(){return x})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return A})),n.d(t,"r",(function(){return g})),n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return C})),n.d(t,"u",(function(){return w})),n.d(t,"v",(function(){return j})),n.d(t,"w",(function(){return S})),n.d(t,"x",(function(){return L})),n.d(t,"y",(function(){return F})),n.d(t,"z",(function(){return D})),n.d(t,"A",(function(){return K})),n.d(t,"B",(function(){return Y})),n.d(t,"C",(function(){return P})),n.d(t,"D",(function(){return z})),n.d(t,"E",(function(){return H})),n.d(t,"F",(function(){return Q}));var r=n("9ab4"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},u=function(e){var t=[],n=0,r=0;while(n<e.length){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){o=e[n++];var a=e[n++],s=e[n++],u=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&s)-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{o=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,d=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(d=64)),r.push(n[l],n[h],n[d],n[p])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):u(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length,s=a?n[e.charAt(i)]:0;++i;var u=i<e.length,c=u?n[e.charAt(i)]:64;++i;var l=i<e.length,h=l?n[e.charAt(i)]:64;if(++i,null==o||null==s||null==c||null==h)throw Error();var d=o<<2|s>>4;if(r.push(d),64!==c){var p=s<<4&240|c>>2;if(r.push(p),64!==h){var f=c<<6&192|h;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},l=function(e){var t=s(e);return c.encodeByteArray(t,!0)},h=function(e){try{return c.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function d(e){return p(void 0,e)}function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&f(r)&&(e[r]=p(e[r],t[r]));return e}function f(e){return"__proto__"!==e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n={alg:"none",type:"JWT"},i=t||"demo-project",o=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=Object(r["a"])({iss:"https://securetoken.google.com/"+i,aud:i,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e),u="";return[c.encodeString(JSON.stringify(n),!1),c.encodeString(JSON.stringify(s),!1),u].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y(){return"undefined"!==typeof navigator&&"string"===typeof navigator["userAgent"]?navigator["userAgent"]:""}function g(){return"undefined"!==typeof window&&!!(window["cordova"]||window["phonegap"]||window["PhoneGap"])&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())}function m(){try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(t){return!1}}function b(){return"object"===typeof self&&self.self===self}function w(){return"object"===typeof navigator&&"ReactNative"===navigator["product"]}function C(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var O="FirebaseError",E=function(e){function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name=O,Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,T.prototype.create),o}return Object(r["d"])(t,e),t}(Error),T=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?I(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new E(i,s,r);return u},e}();function I(e,t){return e.replace(k,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var k=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(e){return JSON.parse(e)}function P(e){return JSON.stringify(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var N=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=S(h(o[0])||""),n=S(h(o[1])||""),i=o[2],r=n["d"]||{},delete n["d"]}catch(a){}return{header:t,claims:n,data:r,signature:i}},j=function(e){var t=N(e),n=t.claims;return!!n&&"object"===typeof n&&n.hasOwnProperty("iat")},x=function(e){var t=N(e).claims;return"object"===typeof t&&!0===t["admin"]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function A(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function L(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r],a=o[0],s=o[1];n(a,s)}return t.length?"&"+t.join("&"):""}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var M=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;while(r<t){if(0===o)while(r<=n)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){while(r<t)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else while(r<t)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function q(e,t){var n=new W(e,t);return n.subscribe.bind(n)}var W=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=U(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=B),void 0===r.error&&(r.error=B),void 0===r.complete&&(r.complete=B);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function U(e,t){if("object"!==typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"===typeof e[i])return!0}return!1}function B(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var z=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){var o=e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}};function V(e,t){return e+" failed: "+t+" argument "}function H(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(V(e,t)+"must be a valid function.")}function Q(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(V(e,t)+"must be a valid context object.")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Y=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<e.length,"Surrogate pair missing trail surrogate.");var s=e.charCodeAt(r)-56320;i=65536+(a<<10)+s}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},K=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function G(e){return e&&e._delegate?e._delegate:e}}).call(this,n("c8ba"))},abfd:function(e,t,n){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var i;n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p}));var o,a=[];(function(e){e[e["DEBUG"]=0]="DEBUG",e[e["VERBOSE"]=1]="VERBOSE",e[e["INFO"]=2]="INFO",e[e["WARN"]=3]="WARN",e[e["ERROR"]=4]="ERROR",e[e["SILENT"]=5]="SILENT"})(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=(i={},i[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),l=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var o=(new Date).toISOString(),a=c[t];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[a].apply(console,r(["["+o+"]  "+e.name+":"],n))}},h=function(){function e(e){this.name=e,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,a.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in o))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"===typeof e?s[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],e)),this._logHandler.apply(this,r([this,o.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],e)),this._logHandler.apply(this,r([this,o.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],e)),this._logHandler.apply(this,r([this,o.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],e)),this._logHandler.apply(this,r([this,o.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],e)),this._logHandler.apply(this,r([this,o.ERROR],e))},e}();function d(e){a.forEach((function(t){t.setLogLevel(e)}))}function p(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=s[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==r&&void 0!==r?r:t.logLevel)&&e({level:o[n].toLowerCase(),message:s,args:i,type:t.name})}},r=0,i=a;r<i.length;r++){var u=i[r];n(u)}}},cc84:function(e,t,n){"use strict";n.r(t),n.d(t,"firebase",(function(){return M}));var r,i,o=n("9ab4"),a=n("a8e9"),s=n("ffa6"),u=n("abfd"),c=(r={},r["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new a["b"]("app","Firebase",c),h="@firebase/app",d="0.6.22",p="@firebase/analytics",f="@firebase/app-check",_="@firebase/auth",v="@firebase/database",y="@firebase/functions",g="@firebase/installations",m="@firebase/messaging",b="@firebase/performance",w="@firebase/remote-config",C="@firebase/storage",O="@firebase/firestore",E="firebase-wrapper",T="[DEFAULT]",I=(i={},i[h]="fire-core",i[p]="fire-analytics",i[f]="fire-app-check",i[_]="fire-auth",i[v]="fire-rtdb",i[y]="fire-fn",i[g]="fire-iid",i[m]="fire-fcm",i[b]="fire-perf",i[w]="fire-rc",i[C]="fire-gcs",i[O]="fire-fst",i["fire-js"]="fire-js",i[E]="fire-js-all",i),k=new u["b"]("@firebase/app"),S=function(){function e(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=Object(a["k"])(e),this.container=new s["b"](t.name),this._addComponent(new s["a"]("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(e){return r._addComponent(e)}))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){var n;void 0===t&&(t=T),this.checkDestroyed_();var r=this.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=T),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){k.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},e}();S.prototype.name&&S.prototype.options||S.prototype.delete||console.log("dc");var P="8.6.1";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N(e){var t={},n=new Map,r={__esModule:!0,initializeApp:c,app:o,registerVersion:p,setLogLevel:u["c"],onLog:f,apps:null,SDK_VERSION:P,INTERNAL:{registerComponent:d,removeApp:i,components:n,useAsService:_}};function i(e){delete t[e]}function o(e){if(e=e||T,!Object(a["h"])(t,e))throw l.create("no-app",{appName:e});return t[e]}function c(n,i){if(void 0===i&&(i={}),"object"!==typeof i||null===i){var o=i;i={name:o}}var s=i;void 0===s.name&&(s.name=T);var u=s.name;if("string"!==typeof u||!u)throw l.create("bad-app-name",{appName:String(u)});if(Object(a["h"])(t,u))throw l.create("duplicate-app",{appName:u});var c=new e(n,s,r);return t[u]=c,c}function h(){return Object.keys(t).map((function(e){return t[e]}))}function d(i){var s=i.name;if(n.has(s))return k.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===i.type?r[s]:null;if(n.set(s,i),"PUBLIC"===i.type){var u=function(e){if(void 0===e&&(e=o()),"function"!==typeof e[s])throw l.create("invalid-app-argument",{appName:s});return e[s]()};void 0!==i.serviceProps&&Object(a["l"])(u,i.serviceProps),r[s]=u,e.prototype[s]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._getService.bind(this,s);return n.apply(this,i.multipleInstances?e:[])}}for(var c=0,h=Object.keys(t);c<h.length;c++){var d=h[c];t[d]._addComponent(i)}return"PUBLIC"===i.type?r[s]:null}function p(e,t,n){var r,i=null!==(r=I[e])&&void 0!==r?r:e;n&&(i+="-"+n);var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var u=['Unable to register library "'+i+'" with version "'+t+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&a&&u.push("and"),a&&u.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void k.warn(u.join(" "))}d(new s["a"](i+"-version",(function(){return{library:i,version:t}}),"VERSION"))}function f(e,t){if(null!==e&&"function"!==typeof e)throw l.create("invalid-log-argument");Object(u["d"])(e,t)}function _(e,t){if("serverAuth"===t)return null;var n=t;return n}return r["default"]=r,Object.defineProperty(r,"apps",{get:h}),o["App"]=e,r}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j(){var e=N(S);function t(t){Object(a["l"])(e,t)}return e.INTERNAL=Object(o["a"])(Object(o["a"])({},e.INTERNAL),{createFirebaseNamespace:j,extendNamespace:t,createSubscribe:a["j"],ErrorFactory:a["b"],deepExtend:a["l"]}),e}var x=j(),R=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){var e=this.container.getProviders();return e.map((function(e){if(D(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null})).filter((function(e){return e})).join(" ")},e}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A(e,t){e.INTERNAL.registerComponent(new s["a"]("platform-logger",(function(e){return new R(e)}),"PRIVATE")),e.registerVersion(h,d,t),e.registerVersion("fire-js","")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(Object(a["p"])()&&void 0!==self.firebase){k.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var L=self.firebase.SDK_VERSION;L&&L.indexOf("LITE")>=0&&k.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var F=x.initializeApp;x.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(a["s"])()&&k.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),F.apply(void 0,e)};var M=x;A(M),t["default"]=M},dd40:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},df7c:function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e){"string"!==typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!==typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,r="/"===a.charAt(0))}return t=n(i(t.split("/"),(function(e){return!!e})),!r).join("/"),(r?"/":"")+t||"."},t.normalize=function(e){var r=t.isAbsolute(e),a="/"===o(e,-1);return e=n(i(e.split("/"),(function(e){return!!e})),!r).join("/"),e||r||(e="."),e&&a&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var n=e.length-1;n>=0;n--)if(""!==e[n])break;return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var c=[];for(u=s;u<i.length;u++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),47===t){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=r(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===r&&(i=!1,r=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){n=a+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var o="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n("4362"))},e947:function(e,t,n){"use strict";n.r(t),function(e,r){n.d(t,"DataSnapshot",(function(){return Lu})),n.d(t,"Database",(function(){return qu})),n.d(t,"OnDisconnect",(function(){return Du})),n.d(t,"Query",(function(){return Fu})),n.d(t,"Reference",(function(){return Mu})),n.d(t,"ServerValue",(function(){return rc})),n.d(t,"enableLogging",(function(){return E})),n.d(t,"registerDatabase",(function(){return ic}));var i=n("cc84"),o=n("ffa6"),a=n("a8e9"),s=n("9ab4"),u=n("abfd"),c="@firebase/database",l="0.10.2",h="";function d(e){h=e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var p=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Object(a["C"])(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Object(a["w"])(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),f=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Object(a["h"])(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),_=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new p(t)}}catch(n){}return new f},v=_("localStorage"),y=_("sessionStorage"),g=new u["b"]("@firebase/database"),m=function(){var e=1;return function(){return e++}}(),b=function(e){var t=Object(a["B"])(e),n=new a["c"];n.update(t);var r=n.digest();return a["f"].encodeByteArray(r)},w=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++){var i=e[r];Array.isArray(i)||i&&"object"===typeof i&&"number"===typeof i.length?n+=w.apply(null,i):n+="object"===typeof i?Object(a["C"])(i):i,n+=" "}return n},C=null,O=!0,E=function(e,t){Object(a["d"])(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(g.logLevel=u["a"].VERBOSE,C=g.log.bind(g),t&&y.set("logging_enabled",!0)):"function"===typeof e?C=e:(C=null,y.remove("logging_enabled"))},T=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===O&&(O=!1,null===C&&!0===y.get("logging_enabled")&&E(!0)),C){var n=w.apply(null,e);C(n)}},I=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];T.apply(void 0,Object(s["g"])([e],Object(s["f"])(t)))}},k=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+w.apply(void 0,Object(s["g"])([],Object(s["f"])(e)));g.error(n)},S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+w.apply(void 0,Object(s["g"])([],Object(s["f"])(e)));throw g.error(n),new Error(n)},P=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+w.apply(void 0,Object(s["g"])([],Object(s["f"])(e)));g.warn(n)},N=function(){"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&P("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},j=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},x=function(e){if(Object(a["t"])()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}},R="[MIN_NAME]",D="[MAX_NAME]",A=function(e,t){if(e===t)return 0;if(e===R||t===D)return-1;if(t===R||e===D)return 1;var n=K(e),r=K(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},L=function(e,t){return e===t?0:e<t?-1:1},F=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Object(a["C"])(t))},M=function(e){if("object"!==typeof e||null===e)return Object(a["C"])(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=Object(a["C"])(t[i]),r+=":",r+=M(e[t[i]]);return r+="}",r},q=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var U=function(e){Object(a["d"])(!j(e),"Invalid JSON number");var t,n,r,i,o,s=11,u=52,c=(1<<s-1)-1;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,e=Math.abs(e),e>=Math.pow(2,1-c)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),c),n=i+c,r=Math.round(e*Math.pow(2,u-i)-Math.pow(2,u))):(n=0,r=Math.round(e/Math.pow(2,1-c-u))));var l=[];for(o=u;o;o-=1)l.push(r%2?1:0),r=Math.floor(r/2);for(o=s;o;o-=1)l.push(n%2?1:0),n=Math.floor(n/2);l.push(t?1:0),l.reverse();var h=l.join(""),d="";for(o=0;o<64;o+=8){var p=parseInt(h.substr(o,8),2).toString(16);1===p.length&&(p="0"+p),d+=p}return d.toLowerCase()},B=function(){return!("object"!==typeof window||!window["chrome"]||!window["chrome"]["extension"]||/^chrome/.test(window.location.href))},z=function(){return"object"===typeof Windows&&"object"===typeof Windows.UI};function V(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}var H=new RegExp("^-?(0*)\\d{1,10}$"),Q=-2147483648,Y=2147483647,K=function(e){if(H.test(e)){var t=Number(e);if(t>=Q&&t<=Y)return t}return null},G=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw P("Exception was thrown by user callback.",e),t}),Math.floor(0))}},$=function(){var e="object"===typeof window&&window["navigator"]&&window["navigator"]["userAgent"]||"";return e.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},J=function(e,t){var n=setTimeout(e,t);return"object"===typeof n&&n["unref"]&&n["unref"](),n},X=function(){function e(e,t){var n=this;this.appName_=e,this.appCheckProvider=t,this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((function(e){return n.appCheck=e}))}return e.prototype.getToken=function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))},e.prototype.addTokenChangeListener=function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){P('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},e}(),Z=function(){function e(e,t,n){var r=this;this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(e){return r.auth_=e}))}return e.prototype.getToken=function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(T("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',P(e)},e}(),ee=function(){function e(e){this.accessToken=e}return e.prototype.getToken=function(e){return Promise.resolve({accessToken:this.accessToken})},e.prototype.addTokenChangeListener=function(e){e(this.accessToken)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.OWNER="owner",e}(),te="5",ne="v",re="s",ie="r",oe="f",ae=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,se="ls",ue="p",ce="ac",le="websocket",he="long_polling",de=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=v.get("host:"+e)||this._host}return e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&v.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+e+this.host+"/"+t},e}();function pe(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function fe(e,t,n){var r;if(Object(a["d"])("string"===typeof t,"typeof type must == string"),Object(a["d"])("object"===typeof n,"typeof params must == object"),t===le)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==he)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}pe(e)&&(n["ns"]=e.namespace);var i=[];return W(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _e=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Object(a["h"])(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Object(a["k"])(this.counters_)},e}(),ve={},ye={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ge(e){var t=e.toString();return ve[t]||(ve[t]=new _e),ve[t]}function me(e,t){var n=e.toString();return ye[n]||(ye[n]=t()),ye[n]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&G((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;while(this.pendingResponses[this.currentResponseNum]){var o=r();if("break"===o)break}},e}(),we="start",Ce="close",Oe="pLPCommand",Ee="pRTLPCB",Te="id",Ie="pw",ke="ser",Se="cb",Pe="seg",Ne="ts",je="d",xe="dframe",Re=1870,De=30,Ae=Re-De,Le=25e3,Fe=3e4,Me=function(){function e(e,t,n,r,i,o,a){var s=this;this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=I(e),this.stats_=ge(t),this.urlFn=function(e){return s.appCheckToken&&(e[ce]=s.appCheckToken),fe(t,he,e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new be(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(Fe)),x((function(){if(!n.isClosed_){n.scriptTagHolder=new qe((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(s["f"])(e,5),i=r[0],o=r[1],a=r[2];r[3],r[4];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===we)n.id=o,n.password=a;else{if(i!==Ce)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(s["f"])(e,2),i=r[0],o=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var e={};e[we]="t",e[ke]=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e[Se]=n.scriptTagHolder.uniqueCallbackIdentifier),e[ne]=te,n.transportSessionId&&(e[re]=n.transportSessionId),n.lastSessionId&&(e[se]=n.lastSessionId),n.applicationId&&(e[ue]=n.applicationId),n.appCheckToken&&(e[ce]=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&ae.test(location.hostname)&&(e[ie]=oe);var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!Object(a["t"])()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!B()&&!z())},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Object(a["C"])(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=Object(a["g"])(t),r=q(n,Ae),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!Object(a["t"])()){this.myDisconnFrame=document.createElement("iframe");var n={};n[xe]="t",n[Te]=e,n[Ie]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Object(a["C"])(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),qe=function(){function e(t,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(a["t"])())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=m(),window[Oe+this.uniqueCallbackIdentifier]=t,window[Ee+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){var s=document.domain;o='<script>document.domain="'+s+'";<\/script>'}var u="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(c){T("frame writing exception"),c.stack&&T(c.stack),T(c)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{var t=e.contentWindow.document;t||T("No IE domain setting required")}catch(r){var n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){this.myID=e,this.myPW=t,this.alive=!0;while(this.newRequest_());},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e[Te]=this.myID,e[Ie]=this.myPW,e[ke]=this.currentSerial;var t=this.urlFn(e),n="",r=0;while(this.pendingSegs.length>0){var i=this.pendingSegs[0];if(!(i.d.length+De+n.length<=Re))break;var o=this.pendingSegs.shift();n=n+"&"+Pe+r+"="+o.seg+"&"+Ne+r+"="+o.ts+"&"+je+r+"="+o.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(Le)),o=function(){clearTimeout(i),r()};this.addTag(e,o)},e.prototype.addTag=function(e,t){var n=this;Object(a["t"])()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){T("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},e}(),We=16384,Ue=45e3,Be=null;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"undefined"!==typeof MozWebSocket?Be=MozWebSocket:"undefined"!==typeof WebSocket&&(Be=WebSocket);var ze=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=I(this.connId),this.stats_=ge(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(e,t,n,r){var i={};return i[ne]=te,!Object(a["t"])()&&"undefined"!==typeof location&&location.hostname&&ae.test(location.hostname)&&(i[ie]=oe),t&&(i[re]=t),n&&(i[se]=n),r&&(i[ce]=r),fe(e,le,i)},t.prototype.open=function(t,n){var r=this;this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,v.set("previous_websocket_failure",!0);try{if(Object(a["t"])()){var i=this.nodeAdmin?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/"+te+"/"+h+"/"+e.platform+"/"+i,"X-Firebase-GMPID":this.applicationId||""}};this.nodeAdmin?o.headers["Authorization"]=this.authToken||"":o.headers["X-Firebase-AppCheck"]=this.appCheckToken||"";var s=Object({NODE_ENV:"production",BASE_URL:"/next/"}),u=0===this.connURL.indexOf("wss://")?s["HTTPS_PROXY"]||s["https_proxy"]:s["HTTP_PROXY"]||s["http_proxy"];u&&(o["proxy"]={origin:u}),this.mySock=new Be(this.connURL,[],o)}else{o={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Be(this.connURL,[],o)}}catch(l){this.log_("Error instantiating WebSocket.");var c=l.message||l.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==Be&&!t.forceDisallow_},t.previouslyFailed=function(){return v.isInMemoryStorage||!0===v.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){v.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Object(a["w"])(t);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},t.prototype.extractFrameCount_=function(e){if(Object(a["d"])(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},t.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e["data"];if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(e){this.resetKeepAlive();var t=Object(a["C"])(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=q(t,We);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(Ue))},t.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),Ve=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Me,ze]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=ze&&ze["isAvailable"](),o=i&&!ze.previouslyFailed();if(t.webSocketOnly&&(i||P("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[ze];else{var a=this.transports_=[];try{for(var u=Object(s["h"])(e.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l["isAvailable"]()&&a.push(l)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),He=6e4,Qe=5e3,Ye=10240,Ke=102400,Ge="t",$e="d",Je="s",Xe="r",Ze="e",et="o",tt="a",nt="n",rt="p",it="h",ot=function(){function e(e,t,n,r,i,o,a,s,u,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=I("c:"+this.id+":"),this.transportManager_=new Ve(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=t["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t["healthyTimeout"]||0;i>0&&(this.healthyTimeout_=J((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>Ke?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>Ye?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if(Ge in e){var t=e[Ge];t===tt?this.upgradeIfSecondaryHealthy_():t===Xe?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===et&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=F("t",e),n=F("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:rt,d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:tt,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:nt,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=F("t",e),n=F("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=F(Ge,e);if($e in e){var n=e[$e];if(t===it)this.onHandshake_(n);else if(t===nt){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Je?this.onConnectionShutdown_(n):t===Xe?this.onReset_(n):t===Ze?k("Server Error: "+n):t===et?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):k("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),te!==n&&P("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e["responsesRequiredToBeHealthy"]||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),J((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(He))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):J((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(Qe))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:rt,d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(v.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),at=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.refreshAppCheckToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),st=function(){function e(e){this.allowedEvents_=e,this.listeners_={},Object(a["d"])(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=Object(s["g"])([],Object(s["f"])(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){Object(a["d"])(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)},e}(),ut=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Object(a["r"])()||(window.addEventListener("online",(function(){t.online_||(t.online_=!0,t.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){t.online_&&(t.online_=!1,t.trigger("online",!1))}),!1)),t}return Object(s["d"])(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(a["d"])("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(st),ct=32,lt=768,ht=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(){return new ht("")}function pt(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ft(e){return e.pieces_.length-e.pieceNum_}function _t(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new ht(e.pieces_,t)}function vt(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function yt(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function gt(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function mt(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new ht(t,0)}function bt(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof ht)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new ht(n,0)}function wt(e){return e.pieceNum_>=e.pieces_.length}function Ct(e,t){var n=pt(e),r=pt(t);if(null===n)return t;if(n===r)return Ct(_t(e),_t(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Ot(e,t){for(var n=gt(e,0),r=gt(t,0),i=0;i<n.length&&i<r.length;i++){var o=A(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Et(e,t){if(ft(e)!==ft(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Tt(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(ft(e)>ft(t))return!1;while(n<e.pieces_.length){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var It=function(){function e(e,t){this.errorPrefix_=t,this.parts_=gt(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(a["A"])(this.parts_[n]);Pt(this)}return e}();function kt(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Object(a["A"])(t),Pt(e)}function St(e){var t=e.parts_.pop();e.byteLength_-=Object(a["A"])(t),e.parts_.length>0&&(e.byteLength_-=1)}function Pt(e){if(e.byteLength_>lt)throw new Error(e.errorPrefix_+"has a key path longer than "+lt+" bytes ("+e.byteLength_+").");if(e.parts_.length>ct)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ct+") or object contains a cycle "+Nt(e))}function Nt(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt,xt,Rt=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document["hidden"]?(n="visibilitychange",t="hidden"):"undefined"!==typeof document["mozHidden"]?(n="mozvisibilitychange",t="mozHidden"):"undefined"!==typeof document["msHidden"]?(n="msvisibilitychange",t="msHidden"):"undefined"!==typeof document["webkitHidden"]&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))}),!1),r}return Object(s["d"])(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(a["d"])("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(st),Dt=1e3,At=3e5,Lt=3e3,Ft=3e4,Mt=1.3,qt=3e4,Wt="server_kill",Ut=3,Bt=function(e){function t(n,r,i,o,s,u,c,l){var h=e.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=o,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.appCheckTokenProvider_=c,h.authOverride_=l,h.id=t.nextPersistentConnectionId_++,h.log_=I("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=Dt,h.maxReconnectDelay_=At,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,l&&!Object(a["t"])())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Rt.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&ut.getInstance().on("online",h.onOnline_,h),h}return Object(s["d"])(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Object(a["C"])(i)),Object(a["d"])(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.get=function(e){var t=this;this.initConnection_();var n=new a["a"],r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e["d"];"ok"===e["s"]?(t.onDataUpdate_(r["p"],i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[o];void 0!==e&&i===e&&(delete t.outstandingGets_[o],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))}),Lt),this.connected_&&this.sendGet_(o),n.promise},t.prototype.listen=function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Object(a["d"])(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Object(a["d"])(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)},t.prototype.sendGet_=function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i},s="q";e.tag&&(a["q"]=r._queryObject,a["t"]=e.tag),a["h"]=e.hashFn(),this.sendRequest(s,a,(function(a){var s=a["d"],u=a["s"];t.warnOnListenWarnings_(s,r);var c=n.listens.get(i)&&n.listens.get(i).get(o);c===e&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),e.onComplete&&e.onComplete(u,s))}))},t.warnOnListenWarnings_=function(e,t){if(e&&"object"===typeof e&&Object(a["h"])(e,"w")){var n=Object(a["z"])(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();P("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){var t=e&&40===e.length;(t||Object(a["o"])(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Ft)},t.prototype.refreshAppCheckToken=function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=Object(a["v"])(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r["noauth"]=!0:"object"===typeof this.authOverride_&&(r["authvar"]=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n["s"],i=n["d"]||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}},t.prototype.tryAppCheck=function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t["s"],r=t["d"]||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))},t.prototype.unlisten=function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Object(a["d"])(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");var i=this.removeListen_(n,r);i&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e},o="n";r&&(i["q"]=n,i["t"]=r),this.sendRequest(o,i)},t.prototype.onDisconnectPut=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e["s"],e["d"])}),Math.floor(0))}))},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){this.initConnection_();var o={p:t,d:n};void 0!==i&&(o["h"]=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r["s"],r["d"])}))},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){var n=e["s"];if("ok"!==n){var r=e["d"];t.log_("reportStats","Error sending stats: "+r)}}))}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Object(a["C"])(e));var t=e["r"],n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e["b"]))}else{if("error"in e)throw"A server-side error has occurred: "+e["error"];"a"in e&&this.onDataPush_(e["a"],e["b"])}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t["p"],t["d"],!1,t["t"]):"m"===e?this.onDataUpdate_(t["p"],t["d"],!0,t["t"]):"c"===e?this.onListenRevoked_(t["p"],t["q"]):"ac"===e?this.onAuthRevoked_(t["s"],t["d"]):"apc"===e?this.onAppCheckRevoked_(t["s"],t["d"]):"sd"===e?this.onSecurityDebugPacket_(t):k("Unrecognized action received from server: "+Object(a["C"])(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;Object(a["d"])(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))},t.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Dt,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Dt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var e=(new Date).getTime()-this.lastConnectionEstablishedTime_;e>qt&&(this.reconnectDelay_=Dt),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Mt)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){return Object(s["b"])(this,void 0,void 0,(function(){var e,n,r,i,o,u,c,l,h,d,p,f,_,v,y=this;return Object(s["e"])(this,(function(g){switch(g.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,r())},h=function(e){Object(a["d"])(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)},this.realtime_={close:l,sendRequest:h},d=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,g.label=1;case 1:return g.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)])];case 2:return p=s["f"].apply(void 0,[g.sent(),2]),f=p[0],_=p[1],u?T("getToken() completed but was canceled"):(T("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=_&&_.token,c=new ot(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,(function(e){P(e+" ("+y.repoInfo_.toString()+")"),y.interrupt(Wt)}),o)),[3,4];case 3:return v=g.sent(),this.log_("Failed to get token: "+v),u||(this.repoInfo_.nodeAdmin&&P(v),l()),[3,4];case 4:return[2]}}))}))},t.prototype.interrupt=function(e){T("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){T("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Object(a["q"])(this.interruptReasons_)&&(this.reconnectDelay_=Dt,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map((function(e){return M(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new ht(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){T("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ut&&(this.reconnectDelay_=Ft,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onAppCheckRevoked_=function(e,t){T("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ut&&this.appCheckTokenProvider_.notifyForInvalidToken())},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e["msg"].replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=Object(s["h"])(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var u=(n=void 0,Object(s["h"])(a.values())),c=u.next();!c.done;c=u.next()){var l=c.value;this.sendListen_(l)}}catch(p){n={error:p}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(f){e={error:f}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);while(this.onDisconnectRequestQueue_.length){var d=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(d.action,d.pathString,d.data,d.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},t.prototype.sendConnectStats_=function(){var e={},t="js";Object(a["t"])()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+h.replace(/\./g,"-")]=1,Object(a["r"])()?e["framework.cordova"]=1:Object(a["u"])()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=ut.getInstance().currentlyOnline();return Object(a["q"])(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(at),zt=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),Vt=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new zt(R,e),r=new zt(R,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return zt.MIN},e}(),Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s["d"])(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return jt},set:function(e){jt=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return A(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Object(a["e"])("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return zt.MIN},t.prototype.maxPost=function(){return new zt(D,jt)},t.prototype.makePost=function(e,t){return Object(a["d"])("string"===typeof e,"KeyIndex indexValue must always be a string."),new zt(e,jt)},t.prototype.toString=function(){return".key"},t}(Vt),Qt=new Ht,Yt=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];var o=1;while(!e.isEmpty())if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_){t=t.left;while(!t.isEmpty())this.nodeStack_.push(t),t=t.right}else{t=t.right;while(!t.isEmpty())this.nodeStack_.push(t),t=t.left}return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Kt=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:$t.EMPTY_NODE,this.right=null!=o?o:$t.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return $t.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()},e.prototype.remove=function(e,t){var n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return $t.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),Gt=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Kt(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),$t=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Kt.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Kt.BLACK,null,null))},e.prototype.get=function(e){var t,n=this.root_;while(!n.isEmpty()){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){var t,n=this.root_,r=null;while(!n.isEmpty()){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;n=n.left;while(!n.right.isEmpty())n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Yt(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Yt(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Yt(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Yt(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new Gt,e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Jt(e,t){return A(e.name,t.name)}function Xt(e,t){return A(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(e){xt=e}var en,tn,nn,rn=function(e){return"number"===typeof e?"number:"+U(e):"string:"+e},on=function(e){if(e.isLeafNode()){var t=e.val();Object(a["d"])("string"===typeof t||"number"===typeof t||"object"===typeof t&&Object(a["h"])(t,".sv"),"Priority must be a string or number.")}else Object(a["d"])(e===xt||e.isEmpty(),"priority of unexpected type.");Object(a["d"])(e===xt||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},an=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Object(a["d"])(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),on(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return en},set:function(e){en=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return wt(t)?this:".priority"===pt(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=pt(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(a["d"])(".priority"!==r||1===ft(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(_t(t),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+rn(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?U(this.value_):this.value_,this.lazyHash_=b(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Object(a["d"])(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),o=e.VALUE_TYPE_ORDER.indexOf(r);return Object(a["d"])(i>=0,"Unknown leaf type: "+n),Object(a["d"])(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();function sn(e){tn=e}function un(e){nn=e}var cn,ln,hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s["d"])(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?A(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return zt.MIN},t.prototype.maxPost=function(){return new zt(D,new an("[PRIORITY-POST]",nn))},t.prototype.makePost=function(e,t){var n=tn(e);return new zt(t,new an("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(Vt),dn=new hn,pn=Math.log(2),fn=function(){function e(e){var t=function(e){return parseInt(Math.log(e)/pn,10)},n=function(e){return parseInt(Array(e+1).join("1"),2)};this.count=t(e+1),this.current_=this.count-1;var r=n(this.count);this.bits_=e+1&r}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),_n=function(e,t,n,r){e.sort(t);var i=function(t,r){var o,a,s=r-t;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Kt(a,o.node,Kt.BLACK,null,null);var u=parseInt(s/2,10)+t,c=i(t,u),l=i(u+1,r);return o=e[u],a=n?n(o):o,new Kt(a,o.node,Kt.BLACK,c,l)},o=function(t){for(var r=null,o=null,a=e.length,s=function(t,r){var o=a-t,s=a;a-=t;var c=i(o+1,s),l=e[o],h=n?n(l):l;u(new Kt(h,l.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?s(h,Kt.BLACK):(s(h,Kt.BLACK),s(h,Kt.RED))}return o},a=new fn(e.length),s=o(a);return new $t(r||t,s)},vn={},yn=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return Object(a["d"])(vn&&dn,"ChildrenNode.ts has not been loaded"),cn=cn||new e({".priority":vn},{".priority":dn}),cn},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=Object(a["z"])(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof $t?t:null},e.prototype.hasIndex=function(e){return Object(a["h"])(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){Object(a["d"])(t!==Qt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");var r,i=[],o=!1,u=n.getIterator(zt.Wrap),c=u.getNext();while(c)o=o||t.isDefinedOn(c.node),i.push(c),c=u.getNext();r=o?_n(i,t.getCompare()):vn;var l=t.toString(),h=Object(s["a"])({},this.indexSet_);h[l]=t;var d=Object(s["a"])({},this.indexes_);return d[l]=r,new e(d,h)},e.prototype.addToIndexes=function(t,n){var r=this,i=Object(a["x"])(this.indexes_,(function(e,i){var o=Object(a["z"])(r.indexSet_,i);if(Object(a["d"])(o,"Missing index implementation for "+i),e===vn){if(o.isDefinedOn(t.node)){var s=[],u=n.getIterator(zt.Wrap),c=u.getNext();while(c)c.name!==t.name&&s.push(c),c=u.getNext();return s.push(t),_n(s,o.getCompare())}return vn}var l=n.get(t.name),h=e;return l&&(h=h.remove(new zt(t.name,l))),h.insert(t,t.node)}));return new e(i,this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){var r=Object(a["x"])(this.indexes_,(function(e){if(e===vn)return e;var r=n.get(t.name);return r?e.remove(new zt(t.name,r)):e}));return new e(r,this.indexSet_)},e}(),gn=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&on(this.priorityNode_),this.children_.isEmpty()&&Object(a["d"])(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return ln||(ln=new e(new $t(Xt),null,yn.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||ln},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?ln:t},e.prototype.getChild=function(e){var t=pt(e);return null===t?this:this.getImmediateChild(t).getChild(_t(e))},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(Object(a["d"])(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new zt(t,n),i=void 0,o=void 0;n.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),o=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?ln:this.priorityNode_;return new e(i,s,o)},e.prototype.updateChild=function(e,t){var n=pt(e);if(null===n)return t;Object(a["d"])(".priority"!==pt(e)||1===ft(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(_t(e),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(dn,(function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+rn(this.getPriority().val())+":"),this.forEachChild(dn,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":b(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new zt(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new zt(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new zt(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));var r=this.children_.getIteratorFrom(e.name,zt.Wrap),i=r.peek();while(null!=i&&t.compare(i,e)<0)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));var r=this.children_.getReverseIteratorFrom(e.name,zt.Wrap),i=r.peek();while(null!=i&&t.compare(i,e)>0)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===bn?-1:0},e.prototype.withIndex=function(t){if(t===Qt||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===Qt||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){var n=this.getIterator(dn),r=t.getIterator(dn),i=n.getNext(),o=r.getNext();while(i&&o){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Qt?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),mn=function(e){function t(){return e.call(this,new $t(Xt),gn.EMPTY_NODE,yn.Default)||this}return Object(s["d"])(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return gn.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(gn),bn=new mn;Object.defineProperties(zt,{MIN:{value:new zt(R,gn.EMPTY_NODE)},MAX:{value:new zt(D,bn)}}),Ht.__EMPTY_NODE=gn.EMPTY_NODE,an.__childrenNodeConstructor=gn,Zt(bn),un(bn);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var wn=!0;function Cn(e,t){if(void 0===t&&(t=null),null===e)return gn.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),Object(a["d"])(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){var n=e;return new an(n,Cn(t))}if(e instanceof Array||!wn){var r=gn.EMPTY_NODE;return W(e,(function(t,n){if(Object(a["h"])(e,t)&&"."!==t.substring(0,1)){var i=Cn(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}})),r.updatePriority(Cn(t))}var i=[],o=!1,s=e;if(W(s,(function(e,t){if("."!==e.substring(0,1)){var n=Cn(t);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),i.push(new zt(e,n)))}})),0===i.length)return gn.EMPTY_NODE;var u=_n(i,Jt,(function(e){return e.name}),Xt);if(o){var c=_n(i,dn.getCompare());return new gn(u,Cn(t),new yn({".priority":c},{".priority":dn}))}return new gn(u,Cn(t),yn.Default)}sn(Cn);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var On=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,Object(a["d"])(!wt(t)&&".priority"!==pt(t),"Can't create PathIndex with empty path or .priority key"),n}return Object(s["d"])(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?A(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=Cn(e),r=gn.EMPTY_NODE.updateChild(this.indexPath_,n);return new zt(t,r)},t.prototype.maxPost=function(){var e=gn.EMPTY_NODE.updateChild(this.indexPath_,bn);return new zt(D,e)},t.prototype.toString=function(){return gt(this.indexPath_,0).join("/")},t}(Vt),En=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s["d"])(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?A(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return zt.MIN},t.prototype.maxPost=function(){return zt.MAX},t.prototype.makePost=function(e,t){var n=Cn(e);return new zt(t,n)},t.prototype.toString=function(){return".value"},t}(Vt),Tn=new En,In="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",kn="-",Sn="z",Pn=786,Nn=function(){var e=0,t=[];return function(n){var r,i=n===e;e=n;var o=new Array(8);for(r=7;r>=0;r--)o[r]=In.charAt(n%64),n=Math.floor(n/64);Object(a["d"])(0===n,"Cannot push at time == 0");var s=o.join("");if(i){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)s+=In.charAt(t[r]);return Object(a["d"])(20===s.length,"nextPushId: Length should be 20."),s}}(),jn=function(e){if(e===""+Y)return kn;var t=K(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<Pn)return n.push(kn),n.join("");var i=n.length-1;while(i>=0&&n[i]===Sn)i--;if(-1===i)return D;var o=n[i],a=In.charAt(In.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},xn=function(e){if(e===""+Q)return R;var t=K(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return n[n.length-1]===kn?1===n.length?""+Y:(delete n[n.length-1],n.join("")):(n[n.length-1]=In.charAt(In.indexOf(n[n.length-1])-1),n.join("")+Sn.repeat(Pn-n.length))};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Rn(e){return{type:"value",snapshotNode:e}}function Dn(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function An(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Ln(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function Fn(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mn=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,o){Object(a["d"])(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(An(t,s)):Object(a["d"])(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(Dn(t,n)):o.trackChildChange(Ln(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(dn,(function(e,r){t.hasChild(e)||n.trackChildChange(An(e,r))})),t.isLeafNode()||t.forEachChild(dn,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Ln(t,r,i))}else n.trackChildChange(Dn(t,r))}))),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?gn.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),qn=function(){function e(t){this.indexedFilter_=new Mn(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new zt(t,n))||(n=gn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=gn.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(gn.EMPTY_NODE);var i=this;return t.forEachChild(dn,(function(e,t){i.matches(new zt(e,t))||(r=r.updateImmediateChild(e,gn.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),Wn=function(){function e(e){this.rangedFilter_=new qn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new zt(t,n))||(n=gn.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=gn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=gn.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);var o=0;while(i.hasNext()&&o<this.limit_){var a=i.getNext(),s=void 0;if(s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,!s)break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=t.withIndex(this.index_),r=r.updatePriority(gn.EMPTY_NODE);var u=void 0,c=void 0,l=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();l=function(e,t){return h(t,e)}}else i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();o=0;var d=!1;while(i.hasNext()){a=i.getNext();!d&&l(u,a)<=0&&(d=!0);s=d&&o<this.limit_&&l(a,c)<=0;s?o++:r=r.updateImmediateChild(a.name,gn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o;if(this.reverse_){var s=this.index_.getCompare();o=function(e,t){return s(t,e)}}else o=this.index_.getCompare();var u=e;Object(a["d"])(u.numChildren()===this.limit_,"");var c=new zt(t,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(t)){var d=u.getImmediateChild(t),p=r.getChildAfterChild(this.index_,l,this.reverse_);while(null!=p&&(p.name===t||u.hasChild(p.name)))p=r.getChildAfterChild(this.index_,p,this.reverse_);var f=null==p?1:o(p,c),_=h&&!n.isEmpty()&&f>=0;if(_)return null!=i&&i.trackChildChange(Ln(t,n,d)),u.updateImmediateChild(t,n);null!=i&&i.trackChildChange(An(t,d));var v=u.updateImmediateChild(t,gn.EMPTY_NODE),y=null!=p&&this.rangedFilter_.matches(p);return y?(null!=i&&i.trackChildChange(Dn(p.name,p.node)),v.updateImmediateChild(p.name,p.node)):v}return n.isEmpty()?e:h&&o(l,c)>=0?(null!=i&&(i.trackChildChange(An(l.name,l.node)),i.trackChildChange(Dn(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(l.name,gn.EMPTY_NODE)):e},e}(),Un=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=dn}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.hasStartAfter=function(){return this.startAfterSet_},e.prototype.hasEndBefore=function(){return this.endBeforeSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},e.prototype.getIndexStartValue=function(){return Object(a["d"])(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return Object(a["d"])(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:R},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return Object(a["d"])(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return Object(a["d"])(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:D},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return Object(a["d"])(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===dn},e.prototype.copy=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(e){return e.loadsAllData()?new Mn(e.getIndex()):e.hasLimit()?new Wn(e):new qn(e)}function zn(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}function Vn(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}function Hn(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Qn(e,t,n){var r;if(e.index_===Qt)"string"===typeof t&&(t=jn(t)),r=Hn(e,t,n);else{var i=void 0;i=null==n?D:jn(n),r=Hn(e,t,i)}return r.startAfterSet_=!0,r}function Yn(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Kn(e,t,n){var r,i;return e.index_===Qt?("string"===typeof t&&(t=xn(t)),i=Yn(e,t,n)):(r=null==n?R:xn(n),i=Yn(e,t,r)),i.endBeforeSet_=!0,i}function Gn(e,t){var n=e.copy();return n.index_=t,n}function $n(e){var t,n={};return e.isDefault()||(e.index_===dn?t="$priority":e.index_===Tn?t="$value":e.index_===Qt?t="$key":(Object(a["d"])(e.index_ instanceof On,"Unrecognized index type!"),t=e.index_.toString()),n["orderBy"]=Object(a["C"])(t),e.startSet_&&(n["startAt"]=Object(a["C"])(e.indexStartValue_),e.startNameSet_&&(n["startAt"]+=","+Object(a["C"])(e.indexStartName_))),e.endSet_&&(n["endAt"]=Object(a["C"])(e.indexEndValue_),e.endNameSet_&&(n["endAt"]+=","+Object(a["C"])(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n["limitToFirst"]=e.limit_:n["limitToLast"]=e.limit_)),n}function Jn(e){var t={};if(e.startSet_&&(t["sp"]=e.indexStartValue_,e.startNameSet_&&(t["sn"]=e.indexStartName_)),e.endSet_&&(t["ep"]=e.indexEndValue_,e.endNameSet_&&(t["en"]=e.indexEndName_)),e.limitSet_){t["l"]=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t["vf"]=n}return e.index_!==dn&&(t["i"]=e.index_.toString()),t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xn=function(e){function t(t,n,r,i){var o=e.call(this)||this;return o.repoInfo_=t,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=I("p:rest:"),o.listens_={},o}return Object(s["d"])(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Object(a["d"])(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())},t.prototype.listen=function(e,n,r,i){var o=this,s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);var u=t.getListenId_(e,r),c={};this.listens_[u]=c;var l=$n(e._queryParams);this.restRequest_(s+".json",l,(function(e,t){var n,l=t;(404===e&&(l=null,e=null),null===e&&o.onDataUpdate_(s,l,!1,r),Object(a["z"])(o.listens_,u)===c)&&(n=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(n,null))}))},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.get=function(e){var t=this,n=$n(e._queryParams),r=e._path.toString(),i=new a["a"];return this.restRequest_(r+".json",n,(function(e,n){var o=n;404===e&&(o=null,e=null),null===e?(t.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;return void 0===t&&(t={}),t["format"]="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var o=Object(s["f"])(i,2),u=o[0],c=o[1];u&&u.accessToken&&(t["auth"]=u.accessToken),c&&c.token&&(t["ac"]=c.token);var l=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+Object(a["y"])(t);r.log_("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var e=null;if(h.status>=200&&h.status<300){try{e=Object(a["w"])(h.responseText)}catch(t){P("Failed to parse JSON response for "+l+": "+h.responseText)}n(null,e)}else 401!==h.status&&404!==h.status&&P("Got unsuccessful REST response for "+l+" Status: "+h.status),n(h.status);n=null}},h.open("GET",l,!0),h.send()}))},t}(at),Zn=function(){function e(){this.rootNode_=gn.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function er(){return{value:null,children:new Map}}function tr(e,t,n){if(wt(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=pt(t);e.children.has(r)||e.children.set(r,er());var i=e.children.get(r);t=_t(t),tr(i,t,n)}}function nr(e,t){if(wt(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(dn,(function(t,n){tr(e,new ht(t),n)})),nr(e,t)}if(e.children.size>0){var r=pt(t);if(t=_t(t),e.children.has(r)){var i=nr(e.children.get(r),t);i&&e.children.delete(r)}return 0===e.children.size}return!0}function rr(e,t,n){null!==e.value?n(t,e.value):ir(e,(function(e,r){var i=new ht(t.toString()+"/"+e);rr(r,i,n)}))}function ir(e,t){e.children.forEach((function(e,n){t(n,e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var or,ar=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=Object(s["a"])({},e);return this.last_&&W(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t},e}(),sr=1e4,ur=3e4,cr=3e5,lr=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ar(e);var n=sr+(ur-sr)*Math.random();J(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;W(t,(function(t,i){i>0&&Object(a["h"])(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),J(this.reportStats_.bind(this),Math.floor(2*Math.random()*cr))},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(e,t){e.statsToReport_[t]=!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function pr(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function fr(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(e){e[e["OVERWRITE"]=0]="OVERWRITE",e[e["MERGE"]=1]="MERGE",e[e["ACK_USER_WRITE"]=2]="ACK_USER_WRITE",e[e["LISTEN_COMPLETE"]=3]="LISTEN_COMPLETE"})(or||(or={}));var _r,vr=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=or.ACK_USER_WRITE,this.source=dr()}return e.prototype.operationForChild=function(t){if(wt(this.path)){if(null!=this.affectedTree.value)return Object(a["d"])(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new ht(t));return new e(dt(),n,this.revert)}return Object(a["d"])(pt(this.path)===t,"operationForChild called for unrelated child."),new e(_t(this.path),this.affectedTree,this.revert)},e}(),yr=function(){function e(e,t){this.source=e,this.path=t,this.type=or.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return wt(this.path)?new e(this.source,dt()):new e(this.source,_t(this.path))},e}(),gr=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=or.OVERWRITE}return e.prototype.operationForChild=function(t){return wt(this.path)?new e(this.source,dt(),this.snap.getImmediateChild(t)):new e(this.source,_t(this.path),this.snap)},e}(),mr=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=or.MERGE}return e.prototype.operationForChild=function(t){if(wt(this.path)){var n=this.children.subtree(new ht(t));return n.isEmpty()?null:n.value?new gr(this.source,dt(),n.value):new e(this.source,dt(),n)}return Object(a["d"])(pt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,_t(this.path),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),br=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(wt(e))return this.isFullyInitialized()&&!this.filtered_;var t=pt(e);return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),wr=function(){function e(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}return e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(e,t,n,r){var i=[],o=[];return t.forEach((function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(Fn(t.childName,t.snapshotNode))})),Or(e,i,"child_removed",t,r,n),Or(e,i,"child_added",t,r,n),Or(e,i,"child_moved",o,r,n),Or(e,i,"child_changed",t,r,n),Or(e,i,"value",t,r,n),i}function Or(e,t,n,r,i,o){var a=r.filter((function(e){return e.type===n}));a.sort((function(t,n){return Tr(e,t,n)})),a.forEach((function(n){var r=Er(e,n,o);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Er(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function Tr(e,t,n){if(null==t.childName||null==n.childName)throw Object(a["e"])("Should only compare child_ events.");var r=new zt(t.childName,t.snapshotNode),i=new zt(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(e,t){return{eventCache:e,serverCache:t}}function kr(e,t,n,r){return Ir(new br(t,n,r),e.serverCache)}function Sr(e,t,n,r){return Ir(e.eventCache,new br(t,n,r))}function Pr(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Nr(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jr=function(){return _r||(_r=new $t(L)),_r},xr=function(){function e(e,t){void 0===t&&(t=jr()),this.value=e,this.children=t}return e.fromObject=function(t){var n=new e(null);return W(t,(function(e,t){n=n.set(new ht(e),t)})),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:dt(),value:this.value};if(wt(e))return null;var n=pt(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(_t(e),t);if(null!=i){var o=bt(new ht(n),i.path);return{path:o,value:i.value}}return null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))},e.prototype.subtree=function(t){if(wt(t))return this;var n=pt(t),r=this.children.get(n);return null!==r?r.subtree(_t(t)):new e(null)},e.prototype.set=function(t,n){if(wt(t))return new e(n,this.children);var r=pt(t),i=this.children.get(r)||new e(null),o=i.set(_t(t),n),a=this.children.insert(r,o);return new e(this.value,a)},e.prototype.remove=function(t){if(wt(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=pt(t),r=this.children.get(n);if(r){var i=r.remove(_t(t)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new e(null):new e(this.value,o)}return this},e.prototype.get=function(e){if(wt(e))return this.value;var t=pt(e),n=this.children.get(t);return n?n.get(_t(e)):null},e.prototype.setTree=function(t,n){if(wt(t))return n;var r=pt(t),i=this.children.get(r)||new e(null),o=i.setTree(_t(t),n),a=void 0;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new e(this.value,a)},e.prototype.fold=function(e){return this.fold_(dt(),e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(bt(e,r),t)})),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,dt(),t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(wt(e))return null;var i=pt(e),o=this.children.get(i);return o?o.findOnPath_(_t(e),bt(t,i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,dt(),t)},e.prototype.foreachOnPath_=function(t,n,r){if(wt(t))return this;this.value&&r(n,this.value);var i=pt(t),o=this.children.get(i);return o?o.foreachOnPath_(_t(t),bt(n,i),r):new e(null)},e.prototype.foreach=function(e){this.foreach_(dt(),e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(bt(e,n),t)})),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))},e}(),Rr=function(){function e(e){this.writeTree_=e}return e.empty=function(){return new e(new xr(null))},e}();function Dr(e,t,n){if(wt(t))return new Rr(new xr(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=Ct(i,t);return o=o.updateChild(a,n),new Rr(e.writeTree_.set(i,o))}var s=new xr(n),u=e.writeTree_.setTree(t,s);return new Rr(u)}function Ar(e,t,n){var r=e;return W(n,(function(e,n){r=Dr(r,bt(t,e),n)})),r}function Lr(e,t){if(wt(t))return Rr.empty();var n=e.writeTree_.setTree(t,new xr(null));return new Rr(n)}function Fr(e,t){return null!=Mr(e,t)}function Mr(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Ct(n.path,t)):null}function qr(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(dn,(function(e,n){t.push(new zt(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new zt(e,n.value))})),t}function Wr(e,t){if(wt(t))return e;var n=Mr(e,t);return new Rr(null!=n?new xr(n):e.writeTree_.subtree(t))}function Ur(e){return e.writeTree_.isEmpty()}function Br(e,t){return zr(dt(),e.writeTree_,t)}function zr(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(Object(a["d"])(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=zr(bt(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(bt(e,".priority"),r)),n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(e,t){return pi(t,e)}function Hr(e,t,n,r,i){Object(a["d"])(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=Dr(e.visibleWrites,t,n)),e.lastWriteId=r}function Qr(e,t,n,r){Object(a["d"])(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Ar(e.visibleWrites,t,n),e.lastWriteId=r}function Yr(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}function Kr(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));Object(a["d"])(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);var i=r.visible,o=!1,s=e.allWrites.length-1;while(i&&s>=0){var u=e.allWrites[s];u.visible&&(s>=n&&Gr(u,r.path)?i=!1:Tt(r.path,u.path)&&(o=!0)),s--}if(i){if(o)return $r(e),!0;if(r.snap)e.visibleWrites=Lr(e.visibleWrites,r.path);else{var c=r.children;W(c,(function(t){e.visibleWrites=Lr(e.visibleWrites,bt(r.path,t))}))}return!0}return!1}function Gr(e,t){if(e.snap)return Tt(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Tt(bt(e.path,n),t))return!0;return!1}function $r(e){e.visibleWrites=Xr(e.allWrites,Jr,dt()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function Jr(e){return e.visible}function Xr(e,t,n){for(var r=Rr.empty(),i=0;i<e.length;++i){var o=e[i];if(t(o)){var s=o.path,u=void 0;if(o.snap)Tt(n,s)?(u=Ct(n,s),r=Dr(r,u,o.snap)):Tt(s,n)&&(u=Ct(s,n),r=Dr(r,dt(),o.snap.getChild(u)));else{if(!o.children)throw Object(a["e"])("WriteRecord should have .snap or .children");if(Tt(n,s))u=Ct(n,s),r=Ar(r,u,o.children);else if(Tt(s,n))if(u=Ct(s,n),wt(u))r=Ar(r,dt(),o.children);else{var c=Object(a["z"])(o.children,pt(u));if(c){var l=c.getChild(_t(u));r=Dr(r,dt(),l)}}}}}return r}function Zr(e,t,n,r,i){if(r||i){var o=Wr(e.visibleWrites,t);if(!i&&Ur(o))return n;if(i||null!=n||Fr(o,dt())){var a=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Tt(e.path,t)||Tt(t,e.path))},s=Xr(e.allWrites,a,t);l=n||gn.EMPTY_NODE;return Br(s,l)}return null}var u=Mr(e.visibleWrites,t);if(null!=u)return u;var c=Wr(e.visibleWrites,t);if(Ur(c))return n;if(null!=n||Fr(c,dt())){var l=n||gn.EMPTY_NODE;return Br(c,l)}return null}function ei(e,t,n){var r=gn.EMPTY_NODE,i=Mr(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(dn,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var o=Wr(e.visibleWrites,t);return n.forEachChild(dn,(function(e,t){var n=Br(Wr(o,new ht(e)),t);r=r.updateImmediateChild(e,n)})),qr(o).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}var a=Wr(e.visibleWrites,t);return qr(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}function ti(e,t,n,r,i){Object(a["d"])(r||i,"Either existingEventSnap or existingServerSnap must exist");var o=bt(t,n);if(Fr(e.visibleWrites,o))return null;var s=Wr(e.visibleWrites,o);return Ur(s)?i.getChild(n):Br(s,i.getChild(n))}function ni(e,t,n,r){var i=bt(t,n),o=Mr(e.visibleWrites,i);if(null!=o)return o;if(r.isCompleteForChild(n)){var a=Wr(e.visibleWrites,i);return Br(a,r.getNode().getImmediateChild(n))}return null}function ri(e,t){return Mr(e.visibleWrites,t)}function ii(e,t,n,r,i,o,a){var s,u=Wr(e.visibleWrites,t),c=Mr(u,dt());if(null!=c)s=c;else{if(null==n)return[];s=Br(u,n)}if(s=s.withIndex(a),s.isEmpty()||s.isLeafNode())return[];var l=[],h=a.getCompare(),d=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),p=d.getNext();while(p&&l.length<i)0!==h(p,r)&&l.push(p),p=d.getNext();return l}function oi(){return{visibleWrites:Rr.empty(),allWrites:[],lastWriteId:-1}}function ai(e,t,n,r){return Zr(e.writeTree,e.treePath,t,n,r)}function si(e,t){return ei(e.writeTree,e.treePath,t)}function ui(e,t,n,r){return ti(e.writeTree,e.treePath,t,n,r)}function ci(e,t){return ri(e.writeTree,bt(e.treePath,t))}function li(e,t,n,r,i,o){return ii(e.writeTree,e.treePath,t,n,r,i,o)}function hi(e,t,n){return ni(e.writeTree,e.treePath,t,n)}function di(e,t){return pi(bt(e.treePath,t),e.writeTree)}function pi(e,t){return{treePath:e,writeTree:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fi=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;Object(a["d"])("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Object(a["d"])(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Ln(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,An(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Dn(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Object(a["e"])("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Ln(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),_i=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}(),vi=new _i,yi=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new br(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return hi(this.writes_,e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Nr(this.viewCache_),i=li(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]},e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function gi(e){return{filter:e}}function mi(e,t){Object(a["d"])(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),Object(a["d"])(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function bi(e,t,n,r,i){var o,s,u=new fi;if(n.type===or.OVERWRITE){var c=n;c.source.fromUser?o=Ei(e,t,c.path,c.snap,r,i,u):(Object(a["d"])(c.source.fromServer,"Unknown source."),s=c.source.tagged||t.serverCache.isFiltered()&&!wt(c.path),o=Oi(e,t,c.path,c.snap,r,i,s,u))}else if(n.type===or.MERGE){var l=n;l.source.fromUser?o=Ii(e,t,l.path,l.children,r,i,u):(Object(a["d"])(l.source.fromServer,"Unknown source."),s=l.source.tagged||t.serverCache.isFiltered(),o=Si(e,t,l.path,l.children,r,i,s,u))}else if(n.type===or.ACK_USER_WRITE){var h=n;o=h.revert?ji(e,t,h.path,r,i,u):Pi(e,t,h.path,h.affectedTree,r,i,u)}else{if(n.type!==or.LISTEN_COMPLETE)throw Object(a["e"])("Unknown operation type: "+n.type);o=Ni(e,t,n.path,r,u)}var d=u.getChanges();return wi(t,o,d),{viewCache:o,changes:d}}function wi(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Pr(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Rn(Pr(t)))}}function Ci(e,t,n,r,i,o){var s=t.eventCache;if(null!=ci(r,n))return t;var u=void 0,c=void 0;if(wt(n))if(Object(a["d"])(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var l=Nr(t),h=l instanceof gn?l:gn.EMPTY_NODE,d=si(r,h);u=e.filter.updateFullNode(t.eventCache.getNode(),d,o)}else{var p=ai(r,Nr(t));u=e.filter.updateFullNode(t.eventCache.getNode(),p,o)}else{var f=pt(n);if(".priority"===f){Object(a["d"])(1===ft(n),"Can't have a priority with additional path components");var _=s.getNode();c=t.serverCache.getNode();var v=ui(r,n,_,c);u=null!=v?e.filter.updatePriority(_,v):s.getNode()}else{var y=_t(n),g=void 0;if(s.isCompleteForChild(f)){c=t.serverCache.getNode();var m=ui(r,n,s.getNode(),c);g=null!=m?s.getNode().getImmediateChild(f).updateChild(y,m):s.getNode().getImmediateChild(f)}else g=hi(r,f,t.serverCache);u=null!=g?e.filter.updateChild(s.getNode(),f,g,y,i,o):s.getNode()}}return kr(t,u,s.isFullyInitialized()||wt(n),e.filter.filtersNodes())}function Oi(e,t,n,r,i,o,a,s){var u,c=t.serverCache,l=a?e.filter:e.filter.getIndexedFilter();if(wt(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var d=pt(n);if(!c.isCompleteForPath(n)&&ft(n)>1)return t;var p=_t(n),f=c.getNode().getImmediateChild(d),_=f.updateChild(p,r);u=".priority"===d?l.updatePriority(c.getNode(),_):l.updateChild(c.getNode(),d,_,p,vi,null)}var v=Sr(t,u,c.isFullyInitialized()||wt(n),l.filtersNodes()),y=new yi(i,v,o);return Ci(e,v,n,i,y,s)}function Ei(e,t,n,r,i,o,a){var s,u,c=t.eventCache,l=new yi(i,t,o);if(wt(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,a),s=kr(t,u,!0,e.filter.filtersNodes());else{var h=pt(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=kr(t,u,c.isFullyInitialized(),c.isFiltered());else{var d=_t(n),p=c.getNode().getImmediateChild(h),f=void 0;if(wt(d))f=r;else{var _=l.getCompleteChild(h);f=null!=_?".priority"===vt(d)&&_.getChild(mt(d)).isEmpty()?_:_.updateChild(d,r):gn.EMPTY_NODE}if(p.equals(f))s=t;else{var v=e.filter.updateChild(c.getNode(),h,f,d,l,a);s=kr(t,v,c.isFullyInitialized(),e.filter.filtersNodes())}}}return s}function Ti(e,t){return e.eventCache.isCompleteForChild(t)}function Ii(e,t,n,r,i,o,a){var s=t;return r.foreach((function(r,u){var c=bt(n,r);Ti(t,pt(c))&&(s=Ei(e,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=bt(n,r);Ti(t,pt(c))||(s=Ei(e,s,c,u,i,o,a))})),s}function ki(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function Si(e,t,n,r,i,o,a,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,c=t;u=wt(n)?r:new xr(null).setTree(n,r);var l=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=t.serverCache.getNode().getImmediateChild(n),h=ki(e,u,r);c=Oi(e,c,new ht(n),h,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=t.serverCache.getNode().getImmediateChild(n),d=ki(e,h,r);c=Oi(e,c,new ht(n),d,i,o,a,s)}})),c}function Pi(e,t,n,r,i,o,a){if(null!=ci(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(wt(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Oi(e,t,n,u.getNode().getChild(n),i,o,s,a);if(wt(n)){var c=new xr(null);return u.getNode().forEachChild(Qt,(function(e,t){c=c.set(new ht(e),t)})),Si(e,t,n,c,i,o,s,a)}return t}var l=new xr(null);return r.foreach((function(e,t){var r=bt(n,e);u.isCompleteForPath(r)&&(l=l.set(e,u.getNode().getChild(r)))})),Si(e,t,n,l,i,o,s,a)}function Ni(e,t,n,r,i){var o=t.serverCache,a=Sr(t,o.getNode(),o.isFullyInitialized()||wt(n),o.isFiltered());return Ci(e,a,n,r,vi,i)}function ji(e,t,n,r,i,o){var s;if(null!=ci(r,n))return t;var u=new yi(r,t,i),c=t.eventCache.getNode(),l=void 0;if(wt(n)||".priority"===pt(n)){var h=void 0;if(t.serverCache.isFullyInitialized())h=ai(r,Nr(t));else{var d=t.serverCache.getNode();Object(a["d"])(d instanceof gn,"serverChildren would be complete if leaf node"),h=si(r,d)}h=h,l=e.filter.updateFullNode(c,h,o)}else{var p=pt(n),f=hi(r,p,t.serverCache);null==f&&t.serverCache.isCompleteForChild(p)&&(f=c.getImmediateChild(p)),l=null!=f?e.filter.updateChild(c,p,f,_t(n),u,o):t.eventCache.getNode().hasChild(p)?e.filter.updateChild(c,p,gn.EMPTY_NODE,_t(n),u,o):c,l.isEmpty()&&t.serverCache.isFullyInitialized()&&(s=ai(r,Nr(t)),s.isLeafNode()&&(l=e.filter.updateFullNode(l,s,o)))}return s=t.serverCache.isFullyInitialized()||null!=ci(r,dt()),kr(t,l,s,e.filter.filtersNodes())}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xi,Ri=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_._queryParams,r=new Mn(n.getIndex()),i=Bn(n);this.processor_=gi(i);var o=t.serverCache,a=t.eventCache,s=r.updateFullNode(gn.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(gn.EMPTY_NODE,a.getNode(),null),c=new br(s,o.isFullyInitialized(),r.filtersNodes()),l=new br(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Ir(l,c),this.eventGenerator_=new wr(this.query_)}return Object.defineProperty(e.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),e}();function Di(e){return e.viewCache_.serverCache.getNode()}function Ai(e){return Pr(e.viewCache_)}function Li(e,t){var n=Nr(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!wt(t)&&!n.getImmediateChild(pt(t)).isEmpty())?n.getChild(t):null}function Fi(e){return 0===e.eventRegistrations_.length}function Mi(e,t){e.eventRegistrations_.push(t)}function qi(e,t,n){var r=[];if(n){Object(a["d"])(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var o=[],s=0;s<e.eventRegistrations_.length;++s){var u=e.eventRegistrations_[s];if(u.matches(t)){if(t.hasAnyCallback()){o=o.concat(e.eventRegistrations_.slice(s+1));break}}else o.push(u)}e.eventRegistrations_=o}else e.eventRegistrations_=[];return r}function Wi(e,t,n,r){t.type===or.MERGE&&null!==t.source.queryId&&(Object(a["d"])(Nr(e.viewCache_),"We should always have a full cache before handling merges"),Object(a["d"])(Pr(e.viewCache_),"Missing event cache, even though we have a server cache"));var i=e.viewCache_,o=bi(e.processor_,i,t,n,r);return mi(e.processor_,o.viewCache),Object(a["d"])(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,Bi(e,o.changes,o.viewCache.eventCache.getNode(),null)}function Ui(e,t){var n=e.viewCache_.eventCache,r=[];if(!n.getNode().isLeafNode()){var i=n.getNode();i.forEachChild(dn,(function(e,t){r.push(Dn(e,t))}))}return n.isFullyInitialized()&&r.push(Rn(n.getNode())),Bi(e,r,n.getNode(),t)}function Bi(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return Cr(e.eventGenerator_,t,n,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zi,Vi=function(){function e(){this.views=new Map}return e}();function Hi(e){Object(a["d"])(!xi,"__referenceConstructor has already been defined"),xi=e}function Qi(){return Object(a["d"])(xi,"Reference.ts has not been loaded"),xi}function Yi(e){return 0===e.views.size}function Ki(e,t,n,r){var i,o,u=t.source.queryId;if(null!==u){var c=e.views.get(u);return Object(a["d"])(null!=c,"SyncTree gave us an op for an invalid query."),Wi(c,t,n,r)}var l=[];try{for(var h=Object(s["h"])(e.views.values()),d=h.next();!d.done;d=h.next()){c=d.value;l=l.concat(Wi(c,t,n,r))}}catch(p){i={error:p}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}return l}function Gi(e,t,n,r,i){var o=t._queryIdentifier,a=e.views.get(o);if(!a){var s=ai(n,i?r:null),u=!1;s?u=!0:r instanceof gn?(s=si(n,r),u=!1):(s=gn.EMPTY_NODE,u=!1);var c=Ir(new br(s,u,!1),new br(r,i,!1));return new Ri(t,c)}return a}function $i(e,t,n,r,i,o){var a=Gi(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),Mi(a,n),Ui(a,n)}function Ji(e,t,n,r){var i,o,a=t._queryIdentifier,u=[],c=[],l=no(e);if("default"===a)try{for(var h=Object(s["h"])(e.views.entries()),d=h.next();!d.done;d=h.next()){var p=Object(s["f"])(d.value,2),f=p[0],_=p[1];c=c.concat(qi(_,n,r)),Fi(_)&&(e.views.delete(f),_.query._queryParams.loadsAllData()||u.push(_.query))}}catch(v){i={error:v}}finally{try{d&&!d.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else{_=e.views.get(a);_&&(c=c.concat(qi(_,n,r)),Fi(_)&&(e.views.delete(a),_.query._queryParams.loadsAllData()||u.push(_.query)))}return l&&!no(e)&&u.push(new(Qi())(t._repo,t._path)),{removed:u,events:c}}function Xi(e){var t,n,r=[];try{for(var i=Object(s["h"])(e.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function Zi(e,t){var n,r,i=null;try{for(var o=Object(s["h"])(e.views.values()),a=o.next();!a.done;a=o.next()){var u=a.value;i=i||Li(u,t)}}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function eo(e,t){var n=t._queryParams;if(n.loadsAllData())return ro(e);var r=t._queryIdentifier;return e.views.get(r)}function to(e,t){return null!=eo(e,t)}function no(e){return null!=ro(e)}function ro(e){var t,n;try{for(var r=Object(s["h"])(e.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function io(e){Object(a["d"])(!zi,"__referenceConstructor has already been defined"),zi=e}function oo(){return Object(a["d"])(zi,"Reference.ts has not been loaded"),zi}var ao=1,so=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=new xr(null),this.pendingWriteTree_=oi(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return e}();function uo(e,t,n,r,i){return Hr(e.pendingWriteTree_,t,n,r,i),i?Co(e,new gr(dr(),t,n)):[]}function co(e,t,n,r){Qr(e.pendingWriteTree_,t,n,r);var i=xr.fromObject(n);return Co(e,new mr(dr(),t,i))}function lo(e,t,n){void 0===n&&(n=!1);var r=Yr(e.pendingWriteTree_,t),i=Kr(e.pendingWriteTree_,t);if(i){var o=new xr(null);return null!=r.snap?o=o.set(dt(),!0):W(r.children,(function(e){o=o.set(new ht(e),!0)})),Co(e,new vr(r.path,o,n))}return[]}function ho(e,t,n){return Co(e,new gr(pr(),t,n))}function po(e,t,n){var r=xr.fromObject(n);return Co(e,new mr(pr(),t,r))}function fo(e,t){return Co(e,new yr(pr(),t))}function _o(e,t,n){var r=So(e,n);if(r){var i=Po(r),o=i.path,a=i.queryId,s=Ct(o,t),u=new yr(fr(a),s);return No(e,o,u)}return[]}function vo(e,t,n,r){var i=t._path,o=e.syncPointTree_.get(i),a=[];if(o&&("default"===t._queryIdentifier||to(o,t))){var s=Ji(o,t,n,r);Yi(o)&&(e.syncPointTree_=e.syncPointTree_.remove(i));var u=s.removed;a=s.events;var c=-1!==u.findIndex((function(e){return e._queryParams.loadsAllData()})),l=e.syncPointTree_.findOnPath(i,(function(e,t){return no(t)}));if(c&&!l){var h=e.syncPointTree_.subtree(i);if(!h.isEmpty())for(var d=jo(h),p=0;p<d.length;++p){var f=d[p],_=f.query,v=To(e,f);e.listenProvider_.startListening(xo(_),Io(e,_),v.hashFn,v.onComplete)}}if(!l&&u.length>0&&!r)if(c){var y=null;e.listenProvider_.stopListening(xo(t),y)}else u.forEach((function(t){var n=e.queryToTagMap.get(ko(t));e.listenProvider_.stopListening(xo(t),n)}));Ro(e,u)}return a}function yo(e,t,n,r){var i=So(e,r);if(null!=i){var o=Po(i),a=o.path,s=o.queryId,u=Ct(a,t),c=new gr(fr(s),u,n);return No(e,a,c)}return[]}function go(e,t,n,r){var i=So(e,r);if(i){var o=Po(i),a=o.path,s=o.queryId,u=Ct(a,t),c=xr.fromObject(n),l=new mr(fr(s),u,c);return No(e,a,l)}return[]}function mo(e,t,n){var r=t._path,i=null,o=!1;e.syncPointTree_.foreachOnPath(r,(function(e,t){var n=Ct(e,r);i=i||Zi(t,n),o=o||no(t)}));var s,u=e.syncPointTree_.get(r);if(u?(o=o||no(u),i=i||Zi(u,dt())):(u=new Vi,e.syncPointTree_=e.syncPointTree_.set(r,u)),null!=i)s=!0;else{s=!1,i=gn.EMPTY_NODE;var c=e.syncPointTree_.subtree(r);c.foreachChild((function(e,t){var n=Zi(t,dt());n&&(i=i.updateImmediateChild(e,n))}))}var l=to(u,t);if(!l&&!t._queryParams.loadsAllData()){var h=ko(t);Object(a["d"])(!e.queryToTagMap.has(h),"View does not exist, but we have a tag");var d=Do();e.queryToTagMap.set(h,d),e.tagToQueryMap.set(d,h)}var p=Vr(e.pendingWriteTree_,r),f=$i(u,t,n,p,i,s);if(!l&&!o){var _=eo(u,t);f=f.concat(Ao(e,t,_))}return f}function bo(e,t,n){var r=!0,i=e.pendingWriteTree_,o=e.syncPointTree_.findOnPath(t,(function(e,n){var r=Ct(e,t),i=Zi(n,r);if(i)return i}));return Zr(i,t,o,n,r)}function wo(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=Ct(e,n);r=r||Zi(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||Zi(i,dt()):(i=new Vi,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,a=o?new br(r,!0,!1):null,s=Vr(e.pendingWriteTree_,t._path),u=Gi(i,t,s,o?a.getNode():gn.EMPTY_NODE,o);return Ai(u)}function Co(e,t){return Oo(t,e.syncPointTree_,null,Vr(e.pendingWriteTree_,dt()))}function Oo(e,t,n,r){if(wt(e.path))return Eo(e,t,n,r);var i=t.get(dt());null==n&&null!=i&&(n=Zi(i,dt()));var o=[],a=pt(e.path),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=di(r,a);o=o.concat(Oo(s,u,c,l))}return i&&(o=o.concat(Ki(i,e,r,n))),o}function Eo(e,t,n,r){var i=t.get(dt());null==n&&null!=i&&(n=Zi(i,dt()));var o=[];return t.children.inorderTraversal((function(t,i){var a=n?n.getImmediateChild(t):null,s=di(r,t),u=e.operationForChild(t);u&&(o=o.concat(Eo(u,i,a,s)))})),i&&(o=o.concat(Ki(i,e,r,n))),o}function To(e,t){var n=t.query,r=Io(e,n);return{hashFn:function(){var e=Di(t)||gn.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?_o(e,n._path,r):fo(e,n._path);var i=V(t,n);return vo(e,n,null,i)}}}function Io(e,t){var n=ko(t);return e.queryToTagMap.get(n)}function ko(e){return e._path.toString()+"$"+e._queryIdentifier}function So(e,t){return e.tagToQueryMap.get(t)}function Po(e){var t=e.indexOf("$");return Object(a["d"])(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ht(e.substr(0,t))}}function No(e,t,n){var r=e.syncPointTree_.get(t);Object(a["d"])(r,"Missing sync point for query tag that we're tracking");var i=Vr(e.pendingWriteTree_,t);return Ki(r,n,i,null)}function jo(e){return e.fold((function(e,t,n){if(t&&no(t)){var r=ro(t);return[r]}var i=[];return t&&(i=Xi(t)),W(n,(function(e,t){i=i.concat(t)})),i}))}function xo(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(oo())(e._repo,e._path):e}function Ro(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=ko(r),o=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(o)}}}function Do(){return ao++}function Ao(e,t,n){var r=t._path,i=Io(e,t),o=To(e,n),s=e.listenProvider_.startListening(xo(t),i,o.hashFn,o.onComplete),u=e.syncPointTree_.subtree(r);if(i)Object(a["d"])(!no(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(e,t,n){if(!wt(e)&&t&&no(t))return[ro(t).query];var r=[];return t&&(r=r.concat(Xi(t).map((function(e){return e.query})))),W(n,(function(e,t){r=r.concat(t)})),r})),l=0;l<c.length;++l){var h=c[l];e.listenProvider_.stopListening(xo(h),Io(e,h))}return s}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lo=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){var n=this.node_.getImmediateChild(t);return new e(n)},e.prototype.node=function(){return this.node_},e}(),Fo=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var n=bt(this.path_,t);return new e(this.syncTree_,n)},e.prototype.node=function(){return bo(this.syncTree_,this.path_)},e}(),Mo=function(e){return e=e||{},e["timestamp"]=e["timestamp"]||(new Date).getTime(),e},qo=function(e,t,n){return e&&"object"===typeof e?(Object(a["d"])(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?Wo(e[".sv"],t,n):"object"===typeof e[".sv"]?Uo(e[".sv"],t):void Object(a["d"])(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Wo=function(e,t,n){switch(e){case"timestamp":return n["timestamp"];default:Object(a["d"])(!1,"Unexpected server value: "+e)}},Uo=function(e,t,n){e.hasOwnProperty("increment")||Object(a["d"])(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e["increment"];"number"!==typeof r&&Object(a["d"])(!1,"Unexpected increment value: "+r);var i=t.node();if(Object(a["d"])(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i,s=o.getValue();return"number"!==typeof s?r:s+r},Bo=function(e,t,n,r){return Vo(t,new Fo(n,e),r)},zo=function(e,t,n){return Vo(e,new Lo(t),n)};function Vo(e,t,n){var r,i=e.getPriority().val(),o=qo(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var a=e,s=qo(a.getValue(),t,n);return s!==a.getValue()||o!==a.getPriority().val()?new an(s,Cn(o)):e}var u=e;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new an(o))),u.forEachChild(dn,(function(e,i){var o=Vo(i,t.getImmediateChild(e),n);o!==i&&(r=r.updateImmediateChild(e,o))})),r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ho=function(){function e(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e,this.parent=t,this.node=n}return e}();function Qo(e,t){var n=t instanceof ht?t:new ht(t),r=e,i=pt(n);while(null!==i){var o=Object(a["z"])(r.node.children,i)||{children:{},childCount:0};r=new Ho(i,r,o),n=_t(n),i=pt(n)}return r}function Yo(e){return e.node.value}function Ko(e,t){e.node.value=t,ta(e)}function Go(e){return e.node.childCount>0}function $o(e){return void 0===Yo(e)&&!Go(e)}function Jo(e,t){W(e.node.children,(function(n,r){t(new Ho(n,e,r))}))}function Xo(e,t,n,r){n&&!r&&t(e),Jo(e,(function(e){Xo(e,t,!0,r)})),n&&r&&t(e)}function Zo(e,t,n){var r=n?e:e.parent;while(null!==r){if(t(r))return!0;r=r.parent}return!1}function ea(e){return new ht(null===e.parent?e.name:ea(e.parent)+"/"+e.name)}function ta(e){null!==e.parent&&na(e.parent,e.name,e)}function na(e,t,n){var r=$o(n),i=Object(a["h"])(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,ta(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,ta(e))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ra=/[\[\].#$\/\u0000-\u001F\u007F]/,ia=/[\[\].#$\u0000-\u001F\u007F]/,oa=10485760,aa=function(e){return"string"===typeof e&&0!==e.length&&!ra.test(e)},sa=function(e){return"string"===typeof e&&0!==e.length&&!ia.test(e)},ua=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),sa(e)},ca=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!j(e)||e&&"object"===typeof e&&Object(a["h"])(e,".sv")},la=function(e,t,n,r){r&&void 0===t||ha(Object(a["m"])(e,"value"),t,n)},ha=function(e,t,n){var r=n instanceof ht?new It(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Nt(r));if("function"===typeof t)throw new Error(e+"contains a function "+Nt(r)+" with contents = "+t.toString());if(j(t))throw new Error(e+"contains "+t.toString()+" "+Nt(r));if("string"===typeof t&&t.length>oa/3&&Object(a["A"])(t)>oa)throw new Error(e+"contains a string greater than "+oa+" utf8 bytes "+Nt(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){var i=!1,o=!1;if(W(t,(function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!aa(t)))throw new Error(e+" contains an invalid key ("+t+") "+Nt(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');kt(r,t),ha(e,n,r),St(r)})),i&&o)throw new Error(e+' contains ".value" child '+Nt(r)+" in addition to actual children.")}},da=function(e,t){var n,r;for(n=0;n<t.length;n++){r=t[n];for(var i=gt(r),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!aa(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Ot);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&Tt(a,r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}},pa=function(e,t,n,r){if(!r||void 0!==t){var i=Object(a["m"])(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var o=[];W(t,(function(e,t){var r=new ht(e);if(ha(i,t,bt(n,r)),".priority"===vt(r)&&!ca(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)})),da(i,o)}},fa=function(e,t,n){if(!n||void 0!==t){if(j(t))throw new Error(Object(a["m"])(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ca(t))throw new Error(Object(a["m"])(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},_a=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(a["m"])(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},va=function(e,t,n,r){if((!r||void 0!==n)&&!aa(n))throw new Error(Object(a["m"])(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ya=function(e,t,n,r){if((!r||void 0!==n)&&!sa(n))throw new Error(Object(a["m"])(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ga=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ya(e,t,n,r)},ma=function(e,t){if(".info"===pt(t))throw new Error(e+" failed = Can't modify data under /.info/")},ba=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!aa(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!ua(n))throw new Error(Object(a["m"])(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},wa=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(Object(a["m"])(e,t)+"must be a boolean.")},Ca=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e}();function Oa(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||Et(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function Ea(e,t,n){Oa(e,n),Ia(e,(function(e){return Et(e,t)}))}function Ta(e,t,n){Oa(e,n),Ia(e,(function(e){return Tt(e,t)||Tt(t,e)}))}function Ia(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i){var o=i.path;t(o)?(ka(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function ka(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();C&&T("event: "+n.toString()),G(r)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sa="repo_interrupt",Pa=25,Na=function(){function e(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ca,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=er(),this.transactionQueueTree_=new Ho,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e}();function ja(e,t,n){if(e.stats_=ge(e.repoInfo_),e.forceRestClient_||$())e.server_=new Xn(e.repoInfo_,(function(t,n,r,i){Da(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return La(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(a["C"])(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new Bt(e.repoInfo_,t,(function(t,n,r,i){Da(e,t,n,r,i)}),(function(t){La(e,t)}),(function(t){Fa(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=me(e.repoInfo_,(function(){return new lr(e.stats_,e.server_)})),e.infoData_=new Zn,e.infoSyncTree_=new so({startListening:function(t,n,r,i){var o=[],a=e.infoData_.getNode(t._path);return a.isEmpty()||(o=ho(e.infoSyncTree_,t._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),Ma(e,"connected",!1),e.serverSyncTree_=new so({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var o=i(n,r);Ta(e.eventQueue_,t._path,o)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function xa(e){var t=e.infoData_.getNode(new ht(".info/serverTimeOffset")),n=t.val()||0;return(new Date).getTime()+n}function Ra(e){return Mo({timestamp:xa(e)})}function Da(e,t,n,r,i){e.dataUpdateCount++;var o=new ht(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var s=[];if(i)if(r){var u=Object(a["x"])(n,(function(e){return Cn(e)}));s=go(e.serverSyncTree_,o,u,i)}else{var c=Cn(n);s=yo(e.serverSyncTree_,o,c,i)}else if(r){var l=Object(a["x"])(n,(function(e){return Cn(e)}));s=po(e.serverSyncTree_,o,l)}else{var h=Cn(n);s=ho(e.serverSyncTree_,o,h)}var d=o;s.length>0&&(d=as(e,o)),Ta(e.eventQueue_,d,s)}function Aa(e,t){e.interceptServerDataCallback_=t}function La(e,t){Ma(e,"connected",t),!1===t&&za(e)}function Fa(e,t){W(t,(function(t,n){Ma(e,t,n)}))}function Ma(e,t,n){var r=new ht("/.info/"+t),i=Cn(n);e.infoData_.updateSnapshot(r,i);var o=ho(e.infoSyncTree_,r,i);Ta(e.eventQueue_,r,o)}function qa(e){return e.nextWriteId_++}function Wa(e,t){var n=wo(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((function(n){var r=Cn(n).withIndex(t._queryParams.getIndex()),i=ho(e.serverSyncTree_,t._path,r);return Ea(e.eventQueue_,t._path,i),Promise.resolve(r)}),(function(n){return es(e,"get for query "+Object(a["C"])(t)+" failed: "+n),Promise.reject(new Error(n))}))}function Ua(e,t,n,r,i){es(e,"set",{path:t.toString(),value:n,priority:r});var o=Ra(e),a=Cn(n,r),s=bo(e.serverSyncTree_,t),u=zo(a,s,o),c=qa(e),l=uo(e.serverSyncTree_,t,u,c,!0);Oa(e.eventQueue_,l),e.server_.put(t.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||P("set at "+t+" failed: "+n);var a=lo(e.serverSyncTree_,c,!o);Ta(e.eventQueue_,t,a),ts(e,i,n,r)}));var h=ds(e,t);as(e,h),Ta(e.eventQueue_,h,[])}function Ba(e,t,n,r){es(e,"update",{path:t.toString(),value:n});var i=!0,o=Ra(e),a={};if(W(n,(function(n,r){i=!1,a[n]=Bo(bt(t,n),Cn(r),e.serverSyncTree_,o)})),i)T("update() called with empty data.  Don't do anything."),ts(e,r,"ok",void 0);else{var s=qa(e),u=co(e.serverSyncTree_,t,a,s);Oa(e.eventQueue_,u),e.server_.merge(t.toString(),n,(function(n,i){var o="ok"===n;o||P("update at "+t+" failed: "+n);var a=lo(e.serverSyncTree_,s,!o),u=a.length>0?as(e,t):t;Ta(e.eventQueue_,u,a),ts(e,r,n,i)})),W(n,(function(n){var r=ds(e,bt(t,n));as(e,r)})),Ta(e.eventQueue_,t,[])}}function za(e){es(e,"onDisconnectEvents");var t=Ra(e),n=er();rr(e.onDisconnect_,dt(),(function(r,i){var o=Bo(r,i,e.serverSyncTree_,t);tr(n,r,o)}));var r=[];rr(n,dt(),(function(t,n){r=r.concat(ho(e.serverSyncTree_,t,n));var i=ds(e,t);as(e,i)})),e.onDisconnect_=er(),Ta(e.eventQueue_,dt(),r)}function Va(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&nr(e.onDisconnect_,t),ts(e,n,r,i)}))}function Ha(e,t,n,r){var i=Cn(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,o){"ok"===n&&tr(e.onDisconnect_,t,i),ts(e,r,n,o)}))}function Qa(e,t,n,r,i){var o=Cn(n,r);e.server_.onDisconnectPut(t.toString(),o.val(!0),(function(n,r){"ok"===n&&tr(e.onDisconnect_,t,o),ts(e,i,n,r)}))}function Ya(e,t,n,r){if(Object(a["q"])(n))return T("onDisconnect().update() called with empty data.  Don't do anything."),void ts(e,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,o){"ok"===i&&W(n,(function(n,r){var i=Cn(r);tr(e.onDisconnect_,bt(t,n),i)})),ts(e,r,i,o)}))}function Ka(e,t,n){var r;r=".info"===pt(t._path)?mo(e.infoSyncTree_,t,n):mo(e.serverSyncTree_,t,n),Ea(e.eventQueue_,t._path,r)}function Ga(e,t,n){var r;r=".info"===pt(t._path)?vo(e.infoSyncTree_,t,n):vo(e.serverSyncTree_,t,n),Ea(e.eventQueue_,t._path,r)}function $a(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Sa)}function Ja(e){e.persistentConnection_&&e.persistentConnection_.resume(Sa)}function Xa(e,t){if(void 0===t&&(t=!1),"undefined"!==typeof console){var n;t?(e.statsListener_||(e.statsListener_=new ar(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();var r=Object.keys(n).reduce((function(e,t){return Math.max(t.length,e)}),0);W(n,(function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)}))}}function Za(e,t){e.stats_.incrementCounter(t),hr(e.statsReporter_,t)}function es(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),T.apply(void 0,Object(s["g"])([r],Object(s["f"])(t)))}function ts(e,t,n,r){t&&G((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var o=new Error(i);o.code=e,t(o)}}))}function ns(e,t,n,r,i,o){es(e,"transaction on "+t);var s={path:t,update:n,onComplete:r,status:null,order:m(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=rs(e,t,void 0);s.currentInputSnapshot=u;var c=s.update(u.val());if(void 0===c)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{ha("transaction failed: Data returned ",c,s.path),s.status=0;var l=Qo(e.transactionQueueTree_,t),h=Yo(l)||[];h.push(s),Ko(l,h);var d=void 0;if("object"===typeof c&&null!==c&&Object(a["h"])(c,".priority"))d=Object(a["z"])(c,".priority"),Object(a["d"])(ca(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{var p=bo(e.serverSyncTree_,t)||gn.EMPTY_NODE;d=p.getPriority().val()}var f=Ra(e),_=Cn(c,d),v=zo(_,u,f);s.currentOutputSnapshotRaw=_,s.currentOutputSnapshotResolved=v,s.currentWriteId=qa(e);var y=uo(e.serverSyncTree_,t,v,s.currentWriteId,s.applyLocally);Ta(e.eventQueue_,t,y),is(e,e.transactionQueueTree_)}}function rs(e,t,n){return bo(e.serverSyncTree_,t,n)||gn.EMPTY_NODE}function is(e,t){if(void 0===t&&(t=e.transactionQueueTree_),t||hs(e,t),Yo(t)){var n=cs(e,t);Object(a["d"])(n.length>0,"Sending zero length transaction queue");var r=n.every((function(e){return 0===e.status}));r&&os(e,ea(t),n)}else Go(t)&&Jo(t,(function(t){is(e,t)}))}function os(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=rs(e,t,r),o=i,s=i.hash(),u=0;u<n.length;u++){var c=n[u];Object(a["d"])(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var l=Ct(t,c.path);o=o.updateChild(l,c.currentOutputSnapshotRaw)}var h=o.val(!0),d=t;e.server_.put(d.toString(),h,(function(r){es(e,"transaction put response",{path:d.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(t){n[t].status=2,i=i.concat(lo(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},s=0;s<n.length;s++)a(s);hs(e,Qo(e.transactionQueueTree_,t)),is(e,e.transactionQueueTree_),Ta(e.eventQueue_,t,i);for(s=0;s<o.length;s++)G(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{P("transaction at "+d.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}as(e,t)}}),s)}function as(e,t){var n=us(e,t),r=ea(n),i=cs(e,n);return ss(e,i,r),r}function ss(e,t,n){if(0!==t.length){for(var r=[],i=[],o=t.filter((function(e){return 0===e.status})),s=o.map((function(e){return e.currentWriteId})),u=function(o){var u,c=t[o],l=Ct(n,c.path),h=!1;if(Object(a["d"])(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,u=c.abortReason,i=i.concat(lo(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=Pa)h=!0,u="maxretry",i=i.concat(lo(e.serverSyncTree_,c.currentWriteId,!0));else{var d=rs(e,c.path,s);c.currentInputSnapshot=d;var p=t[o].update(d.val());if(void 0!==p){ha("transaction failed: Data returned ",p,c.path);var f=Cn(p),_="object"===typeof p&&null!=p&&Object(a["h"])(p,".priority");_||(f=f.updatePriority(d.getPriority()));var v=c.currentWriteId,y=Ra(e),g=zo(f,d,y);c.currentOutputSnapshotRaw=f,c.currentOutputSnapshotResolved=g,c.currentWriteId=qa(e),s.splice(s.indexOf(v),1),i=i.concat(uo(e.serverSyncTree_,c.path,g,c.currentWriteId,c.applyLocally)),i=i.concat(lo(e.serverSyncTree_,v,!0))}else h=!0,u="nodata",i=i.concat(lo(e.serverSyncTree_,c.currentWriteId,!0))}Ta(e.eventQueue_,n,i),i=[],h&&(t[o].status=2,function(e){setTimeout(e,Math.floor(0))}(t[o].unwatcher),t[o].onComplete&&("nodata"===u?r.push((function(){return t[o].onComplete(null,!1,t[o].currentInputSnapshot)})):r.push((function(){return t[o].onComplete(new Error(u),!1,null)}))))},c=0;c<t.length;c++)u(c);hs(e,e.transactionQueueTree_);for(c=0;c<r.length;c++)G(r[c]);is(e,e.transactionQueueTree_)}}function us(e,t){var n,r=e.transactionQueueTree_;n=pt(t);while(null!==n&&void 0===Yo(r))r=Qo(r,n),t=_t(t),n=pt(t);return r}function cs(e,t){var n=[];return ls(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function ls(e,t,n){var r=Yo(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Jo(t,(function(t){ls(e,t,n)}))}function hs(e,t){var n=Yo(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Ko(t,n.length>0?n:void 0)}Jo(t,(function(t){hs(e,t)}))}function ds(e,t){var n=ea(us(e,t)),r=Qo(e.transactionQueueTree_,t);return Zo(r,(function(t){ps(e,t)})),ps(e,r),Xo(r,(function(t){ps(e,t)})),n}function ps(e,t){var n=Yo(t);if(n){for(var r=[],i=[],o=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?(Object(a["d"])(o===s-1,"All SENT items should be at beginning of queue."),o=s,n[s].status=3,n[s].abortReason="set"):(Object(a["d"])(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(lo(e.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Ko(t,void 0):n.length=o+1,Ta(e.eventQueue_,ea(t),i);for(s=0;s<r.length;s++)G(r[s])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}function _s(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Object(s["h"])(e.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var u=a.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):P("Invalid query segment '"+a+"' in query '"+e+"'")}}}catch(c){t={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}var vs=function(e,t){var n=ys(e),r=n.namespace;"firebase.com"===n.domain&&S(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||N();var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new de(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new ht(n.pathString)}},ys=function(e){var t="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"===typeof e){var c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=fs(e.substring(l,h)));var d=_s(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(a="https"===s||"wss"===s,u=parseInt(t.substring(c+1),10)):c=t.length;var p=t.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var f=t.indexOf(".");r=t.substring(0,f).toLowerCase(),n=t.substring(f+1),o=r}"ns"in d&&(o=d["ns"])}return{host:t,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},gs=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(a["C"])(this.snapshot.exportVal())},e}(),ms=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),bs=function(){function e(e,t){this.snapshotCallback=e,this.cancelCallback=t}return e.prototype.onValue=function(e,t){this.snapshotCallback.call(null,e,t)},e.prototype.onCancel=function(e){return Object(a["d"])(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(e.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),e.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},e}(),ws=function(){function e(e,t){this._repo=e,this._path=t}return e.prototype.cancel=function(){var e=new a["a"];return Va(this._repo,this._path,e.wrapCallback((function(){}))),e.promise},e.prototype.remove=function(){ma("OnDisconnect.remove",this._path);var e=new a["a"];return Ha(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise},e.prototype.set=function(e){ma("OnDisconnect.set",this._path),la("OnDisconnect.set",e,this._path,!1);var t=new a["a"];return Ha(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e.prototype.setWithPriority=function(e,t){ma("OnDisconnect.setWithPriority",this._path),la("OnDisconnect.setWithPriority",e,this._path,!1),fa("OnDisconnect.setWithPriority",t,!1);var n=new a["a"];return Qa(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise},e.prototype.update=function(e){ma("OnDisconnect.update",this._path),pa("OnDisconnect.update",e,this._path,!1);var t=new a["a"];return Ya(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e}(),Cs=function(){function e(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(e.prototype,"key",{get:function(){return wt(this._path)?null:vt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Is(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryIdentifier",{get:function(){var e=Jn(this._queryParams),t=M(e);return"{}"===t?"default":t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryObject",{get:function(){return Jn(this._queryParams)},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(t=Object(a["n"])(t),!(t instanceof e))return!1;var n=this._repo===t._repo,r=Et(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i},e.prototype.toJSON=function(){return this.toString()},e.prototype.toString=function(){return this._repo.toString()+yt(this._path)},e}();function Os(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Es(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Qt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){var o=e.getIndexStartName();if(o!==R)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){var s=e.getIndexEndName();if(s!==D)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===dn){if(null!=t&&!ca(t)||null!=n&&!ca(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(a["d"])(e.getIndex()instanceof On||e.getIndex()===Tn,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ts(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Is=function(e){function t(t,n){return e.call(this,t,n,new Un,!1)||this}return Object(s["d"])(t,e),Object.defineProperty(t.prototype,"parent",{get:function(){var e=mt(this._path);return null===e?null:new t(this._repo,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var e=this;while(null!==e.parent)e=e.parent;return e},enumerable:!1,configurable:!0}),t}(Cs),ks=function(){function e(e,t,n){this._node=e,this.ref=t,this._index=n}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),e.prototype.child=function(t){var n=new ht(t),r=Ns(this.ref,t);return new e(this._node.getChild(n),r,dn)},e.prototype.exists=function(){return!this._node.isEmpty()},e.prototype.exportVal=function(){return this._node.val(!0)},e.prototype.forEach=function(t){var n=this;if(this._node.isLeafNode())return!1;var r=this._node;return!!r.forEachChild(this._index,(function(r,i){return t(new e(i,Ns(n.ref,r),dn))}))},e.prototype.hasChild=function(e){var t=new ht(e);return!this._node.getChild(t).isEmpty()},e.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},e.prototype.toJSON=function(){return this.exportVal()},e.prototype.val=function(){return this._node.val()},e}();function Ss(e,t){return e=Object(a["n"])(e),e._checkNotDeleted("ref"),void 0!==t?Ns(e._root,t):e._root}function Ps(e,t){e=Object(a["n"])(e),e._checkNotDeleted("refFromURL");var n=vs(t,e._repo.repoInfo_.nodeAdmin);ba("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||S("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Ss(e,n.path.toString())}function Ns(e,t){return e=Object(a["n"])(e),null===pt(e._path)?ga("child","path",t,!1):ya("child","path",t,!1),new Is(e._repo,bt(e._path,t))}function js(e,t){e=Object(a["n"])(e),ma("push",e._path),la("push",t,e._path,!0);var n,r=xa(e._repo),i=Nn(r),o=Ns(e,i),s=Ns(e,i);return n=null!=t?Rs(s,t).then((function(){return s})):Promise.resolve(s),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),o}function xs(e){return ma("remove",e._path),Rs(e,null)}function Rs(e,t){e=Object(a["n"])(e),ma("set",e._path),la("set",t,e._path,!1);var n=new a["a"];return Ua(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function Ds(e,t){e=Object(a["n"])(e),ma("setPriority",e._path),fa("setPriority",t,!1);var n=new a["a"];return Ua(e._repo,bt(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}function As(e,t,n){if(ma("setWithPriority",e._path),la("setWithPriority",t,e._path,!1),fa("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new a["a"];return Ua(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}function Ls(e,t){pa("update",t,e._path,!1);var n=new a["a"];return Ba(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function Fs(e){return e=Object(a["n"])(e),Wa(e._repo,e).then((function(t){return new ks(t,new Is(e._repo,e._path),e._queryParams.getIndex())}))}var Ms=function(){function e(e){this.callbackContext=e}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t._queryParams.getIndex();return new gs("value",this,new ks(e.snapshotNode,new Is(t._repo,t._path),n))},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new ms(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))},e.prototype.hasAnyCallback=function(){return null!==this.callbackContext},e}(),qs=function(){function e(e,t){this.eventType=e,this.callbackContext=t}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new ms(this,e,t):null},e.prototype.createEvent=function(e,t){Object(a["d"])(null!=e.childName,"Child events should have a childName.");var n=Ns(new Is(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new gs(e.type,this,new ks(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}},e.prototype.matches=function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))},e.prototype.hasAnyCallback=function(){return!!this.callbackContext},e}();function Ws(e,t,n,r,i){var o;if("object"===typeof r&&(o=void 0,i=r),"function"===typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(t,n){Ga(e._repo,e,c),a(t,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new bs(n,o||void 0),c="value"===t?new Ms(u):new qs(t,u);return Ka(e._repo,e,c),function(){return Ga(e._repo,e,c)}}function Us(e,t,n,r){return Ws(e,"value",t,n,r)}function Bs(e,t,n,r){return Ws(e,"child_added",t,n,r)}function zs(e,t,n,r){return Ws(e,"child_changed",t,n,r)}function Vs(e,t,n,r){return Ws(e,"child_moved",t,n,r)}function Hs(e,t,n,r){return Ws(e,"child_removed",t,n,r)}function Qs(e,t,n){var r=null,i=n?new bs(n):null;"value"===t?r=new Ms(i):t&&(r=new qs(t,i)),Ga(e._repo,e,r)}var Ys=function(){function e(){}return e}(),Ks=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(s["d"])(t,e),t.prototype._apply=function(e){la("endAt",this._value,e._path,!0);var t=Yn(e._queryParams,this._value,this._key);if(Ts(t),Es(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Cs(e._repo,e._path,t,e._orderByCalled)},t}(Ys);function Gs(e,t){return va("endAt","key",t,!0),new Ks(e,t)}var $s=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(s["d"])(t,e),t.prototype._apply=function(e){la("endBefore",this._value,e._path,!1);var t=Kn(e._queryParams,this._value,this._key);if(Ts(t),Es(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Cs(e._repo,e._path,t,e._orderByCalled)},t}(Ys);function Js(e,t){return va("endBefore","key",t,!0),new $s(e,t)}var Xs=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(s["d"])(t,e),t.prototype._apply=function(e){la("startAt",this._value,e._path,!0);var t=Hn(e._queryParams,this._value,this._key);if(Ts(t),Es(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Cs(e._repo,e._path,t,e._orderByCalled)},t}(Ys);function Zs(e,t){return void 0===e&&(e=null),va("startAt","key",t,!0),new Xs(e,t)}var eu=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(s["d"])(t,e),t.prototype._apply=function(e){la("startAfter",this._value,e._path,!1);var t=Qn(e._queryParams,this._value,this._key);if(Ts(t),Es(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Cs(e._repo,e._path,t,e._orderByCalled)},t}(Ys);function tu(e,t){return va("startAfter","key",t,!0),new eu(e,t)}var nu=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(s["d"])(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Cs(e._repo,e._path,zn(e._queryParams,this._limit),e._orderByCalled)},t}(Ys);function ru(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new nu(e)}var iu=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(s["d"])(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Cs(e._repo,e._path,Vn(e._queryParams,this._limit),e._orderByCalled)},t}(Ys);function ou(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new iu(e)}var au=function(e){function t(t){var n=e.call(this)||this;return n._path=t,n}return Object(s["d"])(t,e),t.prototype._apply=function(e){Os(e,"orderByChild");var t=new ht(this._path);if(wt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new On(t),r=Gn(e._queryParams,n);return Es(r),new Cs(e._repo,e._path,r,!0)},t}(Ys);function su(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ya("orderByChild","path",e,!1),new au(e)}var uu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s["d"])(t,e),t.prototype._apply=function(e){Os(e,"orderByKey");var t=Gn(e._queryParams,Qt);return Es(t),new Cs(e._repo,e._path,t,!0)},t}(Ys);function cu(){return new uu}var lu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s["d"])(t,e),t.prototype._apply=function(e){Os(e,"orderByPriority");var t=Gn(e._queryParams,dn);return Es(t),new Cs(e._repo,e._path,t,!0)},t}(Ys);function hu(){return new lu}var du=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s["d"])(t,e),t.prototype._apply=function(e){Os(e,"orderByValue");var t=Gn(e._queryParams,Tn);return Es(t),new Cs(e._repo,e._path,t,!0)},t}(Ys);function pu(){return new du}var fu=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(s["d"])(t,e),t.prototype._apply=function(e){if(la("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Ks(this._value,this._key)._apply(new Xs(this._value,this._key)._apply(e))},t}(Ys);function _u(e,t){return va("equalTo","key",t,!0),new fu(e,t)}function vu(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=Object(a["n"])(e);try{for(var u=Object(s["h"])(r),c=u.next();!c.done;c=u.next()){var l=c.value;o=l._apply(o)}}catch(h){t={error:h}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return o}Hi(Is),io(Is);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var yu="FIREBASE_DATABASE_EMULATOR_HOST",gu={},mu=!1;function bu(e,t,n,r){e.repoInfo_=new de(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}function wu(t,n,r,i,o){var a=i||t.options.databaseURL;void 0===a&&(t.options.projectId||S("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),T("Using default host for project ",t.options.projectId),a=t.options.projectId+"-default-rtdb.firebaseio.com");var s,u=vs(a,o),c=u.repoInfo,l=void 0;"undefined"!==typeof e&&(l=Object({NODE_ENV:"production",BASE_URL:"/next/"})[yu]),l?(s=!0,a="http://"+l+"?ns="+c.namespace,u=vs(a,o),c=u.repoInfo):s=!u.repoInfo.secure;var h=o&&s?new ee(ee.OWNER):new Z(t.name,t.options,n);ba("Invalid Firebase Database URL",u),wt(u.path)||S("Database URL must point to the root of a Firebase Database (not including a child path).");var d=Ou(c,t,h,new X(t.name,r));return new Tu(d,t)}function Cu(e,t){var n=gu[t];n&&n[e.key]===e||S("Database "+t+"("+e.repoInfo_+") has already been deleted."),$a(e),delete n[e.key]}function Ou(e,t,n,r){var i=gu[t.name];i||(i={},gu[t.name]=i);var o=i[e.toURLString()];return o&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Na(e,mu,n,r),i[e.toURLString()]=o,o}function Eu(e){mu=e}var Tu=function(){function e(e,t){this._repoInternal=e,this.app=t,this["type"]="database",this._instanceStarted=!1}return Object.defineProperty(e.prototype,"_repo",{get:function(){return this._instanceStarted||(ja(this._repoInternal,this.app.options.appId,this.app.options["databaseAuthVariableOverride"]),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Is(this._repo,dt())),this._rootInternal},enumerable:!1,configurable:!0}),e.prototype._delete=function(){return this._checkNotDeleted("delete"),Cu(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null,Promise.resolve()},e.prototype._checkNotDeleted=function(e){null===this._rootInternal&&S("Cannot call "+e+" on a deleted database.")},e}();function Iu(e,t,n,r){void 0===r&&(r={}),e=Object(a["n"])(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&S("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,o=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&S('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new ee(ee.OWNER);else if(r.mockUserToken){var s=Object(a["i"])(r.mockUserToken,e.app.options.projectId);o=new ee(s)}bu(i,t,n,o)}function ku(e){e=Object(a["n"])(e),e._checkNotDeleted("goOffline"),$a(e._repo)}function Su(e){e=Object(a["n"])(e),e._checkNotDeleted("goOnline"),Ja(e._repo)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pu={".sv":"timestamp"};function Nu(){return Pu}function ju(e){return{".sv":{increment:e}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xu=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();function Ru(e,t,n){var r;if(e=Object(a["n"])(e),ma("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,o=new a["a"],s=function(t,n,r){var i=null;t?o.reject(t):(i=new ks(r,new Is(e._repo,e._path),dn),o.resolve(new xu(n,i)))},u=Us(e,(function(){}));return ns(e._repo,e._path,t,s,u,i),o.promise}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Du=function(){function e(e){this._delegate=e}return e.prototype.cancel=function(e){Object(a["D"])("OnDisconnect.cancel",0,1,arguments.length),Object(a["E"])("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.remove=function(e){Object(a["D"])("OnDisconnect.remove",0,1,arguments.length),Object(a["E"])("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.set=function(e,t){Object(a["D"])("OnDisconnect.set",1,2,arguments.length),Object(a["E"])("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},e.prototype.setWithPriority=function(e,t,n){Object(a["D"])("OnDisconnect.setWithPriority",2,3,arguments.length),Object(a["E"])("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},e.prototype.update=function(e,t){if(Object(a["D"])("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,P("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(a["E"])("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},e}(),Au=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return Object(a["D"])("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),Lu=function(){function e(e,t){this._database=e,this._delegate=t}return e.prototype.val=function(){return Object(a["D"])("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},e.prototype.exportVal=function(){return Object(a["D"])("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},e.prototype.toJSON=function(){return Object(a["D"])("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.exists=function(){return Object(a["D"])("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},e.prototype.child=function(t){return Object(a["D"])("DataSnapshot.child",0,1,arguments.length),t=String(t),ya("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))},e.prototype.hasChild=function(e){return Object(a["D"])("DataSnapshot.hasChild",1,1,arguments.length),ya("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)},e.prototype.getPriority=function(){return Object(a["D"])("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},e.prototype.forEach=function(t){var n=this;return Object(a["D"])("DataSnapshot.forEach",1,1,arguments.length),Object(a["E"])("DataSnapshot.forEach","action",t,!1),this._delegate.forEach((function(r){return t(new e(n._database,r))}))},e.prototype.hasChildren=function(){return Object(a["D"])("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(e.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return Object(a["D"])("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},e.prototype.getRef=function(){return Object(a["D"])("DataSnapshot.ref",0,0,arguments.length),new Mu(this._database,this._delegate.ref)},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),Fu=function(){function e(e,t){this.database=e,this._delegate=t}return e.prototype.on=function(t,n,r,i){var o,s=this;Object(a["D"])("Query.on",2,4,arguments.length),Object(a["E"])("Query.on","callback",n,!1);var u=e.getCancelAndContextArgs_("Query.on",r,i),c=function(e,t){n.call(u.context,new Lu(s.database,e),t)};c.userCallback=n,c.context=u.context;var l=null===(o=u.cancel)||void 0===o?void 0:o.bind(u.context);switch(t){case"value":return Us(this._delegate,c,l),n;case"child_added":return Bs(this._delegate,c,l),n;case"child_removed":return Hs(this._delegate,c,l),n;case"child_changed":return zs(this._delegate,c,l),n;case"child_moved":return Vs(this._delegate,c,l),n;default:throw new Error(Object(a["m"])("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.prototype.off=function(e,t,n){if(Object(a["D"])("Query.off",0,3,arguments.length),_a("Query.off",e,!0),Object(a["E"])("Query.off","callback",t,!0),Object(a["F"])("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,Qs(this._delegate,e,r)}else Qs(this._delegate,e)},e.prototype.get=function(){var e=this;return Fs(this._delegate).then((function(t){return new Lu(e.database,t)}))},e.prototype.once=function(t,n,r,i){var o=this;Object(a["D"])("Query.once",1,4,arguments.length),Object(a["E"])("Query.once","callback",n,!0);var s=e.getCancelAndContextArgs_("Query.once",r,i),u=new a["a"],c=function(e,t){var r=new Lu(o.database,e);n&&n.call(s.context,r,t),u.resolve(r)};c.userCallback=n,c.context=s.context;var l=function(e){s.cancel&&s.cancel.call(s.context,e),u.reject(e)};switch(t){case"value":Us(this._delegate,c,l,{onlyOnce:!0});break;case"child_added":Bs(this._delegate,c,l,{onlyOnce:!0});break;case"child_removed":Hs(this._delegate,c,l,{onlyOnce:!0});break;case"child_changed":zs(this._delegate,c,l,{onlyOnce:!0});break;case"child_moved":Vs(this._delegate,c,l,{onlyOnce:!0});break;default:throw new Error(Object(a["m"])("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},e.prototype.limitToFirst=function(t){return Object(a["D"])("Query.limitToFirst",1,1,arguments.length),new e(this.database,vu(this._delegate,ru(t)))},e.prototype.limitToLast=function(t){return Object(a["D"])("Query.limitToLast",1,1,arguments.length),new e(this.database,vu(this._delegate,ou(t)))},e.prototype.orderByChild=function(t){return Object(a["D"])("Query.orderByChild",1,1,arguments.length),new e(this.database,vu(this._delegate,su(t)))},e.prototype.orderByKey=function(){return Object(a["D"])("Query.orderByKey",0,0,arguments.length),new e(this.database,vu(this._delegate,cu()))},e.prototype.orderByPriority=function(){return Object(a["D"])("Query.orderByPriority",0,0,arguments.length),new e(this.database,vu(this._delegate,hu()))},e.prototype.orderByValue=function(){return Object(a["D"])("Query.orderByValue",0,0,arguments.length),new e(this.database,vu(this._delegate,pu()))},e.prototype.startAt=function(t,n){return void 0===t&&(t=null),Object(a["D"])("Query.startAt",0,2,arguments.length),new e(this.database,vu(this._delegate,Zs(t,n)))},e.prototype.startAfter=function(t,n){return void 0===t&&(t=null),Object(a["D"])("Query.startAfter",0,2,arguments.length),new e(this.database,vu(this._delegate,tu(t,n)))},e.prototype.endAt=function(t,n){return void 0===t&&(t=null),Object(a["D"])("Query.endAt",0,2,arguments.length),new e(this.database,vu(this._delegate,Gs(t,n)))},e.prototype.endBefore=function(t,n){return void 0===t&&(t=null),Object(a["D"])("Query.endBefore",0,2,arguments.length),new e(this.database,vu(this._delegate,Js(t,n)))},e.prototype.equalTo=function(t,n){return Object(a["D"])("Query.equalTo",1,2,arguments.length),new e(this.database,vu(this._delegate,_u(t,n)))},e.prototype.toString=function(){return Object(a["D"])("Query.toString",0,0,arguments.length),this._delegate.toString()},e.prototype.toJSON=function(){return Object(a["D"])("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.isEqual=function(t){if(Object(a["D"])("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(t._delegate)},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Object(a["E"])(e,"cancel",r.cancel,!0),r.context=n,Object(a["F"])(e,"context",r.context,!0);else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(Object(a["m"])(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return new Mu(this.database,new Is(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),e}(),Mu=function(e){function t(t,n){var r=e.call(this,t,new Cs(n._repo,n._path,new Un,!1))||this;return r.database=t,r._delegate=n,r}return Object(s["d"])(t,e),t.prototype.getKey=function(){return Object(a["D"])("Reference.key",0,0,arguments.length),this._delegate.key},t.prototype.child=function(e){return Object(a["D"])("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new t(this.database,Ns(this._delegate,e))},t.prototype.getParent=function(){Object(a["D"])("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new t(this.database,e):null},t.prototype.getRoot=function(){return Object(a["D"])("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)},t.prototype.set=function(e,t){Object(a["D"])("Reference.set",1,2,arguments.length),Object(a["E"])("Reference.set","onComplete",t,!0);var n=Rs(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.update=function(e,t){if(Object(a["D"])("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,P("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ma("Reference.update",this._delegate._path),Object(a["E"])("Reference.update","onComplete",t,!0);var i=Ls(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},t.prototype.setWithPriority=function(e,t,n){Object(a["D"])("Reference.setWithPriority",2,3,arguments.length),Object(a["E"])("Reference.setWithPriority","onComplete",n,!0);var r=As(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},t.prototype.remove=function(e){Object(a["D"])("Reference.remove",0,1,arguments.length),Object(a["E"])("Reference.remove","onComplete",e,!0);var t=xs(this._delegate);return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},t.prototype.transaction=function(e,t,n){var r=this;Object(a["D"])("Reference.transaction",1,3,arguments.length),Object(a["E"])("Reference.transaction","transactionUpdate",e,!1),Object(a["E"])("Reference.transaction","onComplete",t,!0),wa("Reference.transaction","applyLocally",n,!0);var i=Ru(this._delegate,e,{applyLocally:n}).then((function(e){return new Au(e.committed,new Lu(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i},t.prototype.setPriority=function(e,t){Object(a["D"])("Reference.setPriority",1,2,arguments.length),Object(a["E"])("Reference.setPriority","onComplete",t,!0);var n=Ds(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.push=function(e,n){var r=this;Object(a["D"])("Reference.push",0,2,arguments.length),Object(a["E"])("Reference.push","onComplete",n,!0);var i=js(this._delegate,e),o=i.then((function(e){return new t(r.database,e)}));n&&o.then((function(){return n(null)}),(function(e){return n(e)}));var s=new t(this.database,i);return s.then=o.then.bind(o),s.catch=o.catch.bind(o,void 0),s},t.prototype.onDisconnect=function(){return ma("Reference.onDisconnect",this._delegate._path),new Du(new ws(this._delegate._repo,this._delegate._path))},Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(Fu),qu=function(){function e(e,t){var n=this;this._delegate=e,this.app=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return e.prototype.useEmulator=function(e,t,n){void 0===n&&(n={}),Iu(this._delegate,e,t,n)},e.prototype.ref=function(e){if(Object(a["D"])("database.ref",0,1,arguments.length),e instanceof Mu){var t=Ps(this._delegate,e.toString());return new Mu(this,t)}t=Ss(this._delegate,e);return new Mu(this,t)},e.prototype.refFromURL=function(e){var t="database.refFromURL";Object(a["D"])(t,1,1,arguments.length);var n=Ps(this._delegate,e);return new Mu(this,n)},e.prototype.goOffline=function(){return Object(a["D"])("database.goOffline",0,0,arguments.length),ku(this._delegate)},e.prototype.goOnline=function(){return Object(a["D"])("database.goOnline",0,0,arguments.length),Su(this._delegate)},e.ServerValue={TIMESTAMP:Nu(),increment:function(e){return ju(e)}},e}(),Wu=function(){ze.forceDisallow(),Me.forceAllow()},Uu=function(){Me.forceDisallow()},Bu=function(){return ze["isAvailable"]()},zu=function(e,t){var n=e._delegate._repo.persistentConnection_;n.securityDebugCallback_=t},Vu=function(e,t){Xa(e._delegate._repo,t)},Hu=function(e,t){Za(e._delegate._repo,t)},Qu=function(e){return e._delegate._repo.dataUpdateCount},Yu=function(e,t){return Aa(e._delegate._repo,t)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,a=e.namespace,s=e.nodeAdmin,u=void 0!==s&&s;d(r);var c=new o["c"]("auth-internal",new o["b"]("database-standalone"));return c.setComponent(new o["a"]("auth-internal",(function(){return i}),"PRIVATE")),{instance:new qu(wu(t,c,void 0,n,u),t),namespace:a}}var Gu=Object.freeze({__proto__:null,forceLongPolling:Wu,forceWebSockets:Uu,isWebSocketsAvailable:Bu,setSecurityDebugCallback:zu,stats:Vu,statsIncrementCounter:Hu,dataUpdateCount:Qu,interceptServerData:Yu,initStandalone:Ku}),$u=Bt;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bt.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Bt.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Ju=ot,Xu=function(e){var t=Bt.prototype.put;return Bt.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Bt.prototype.put=t}},Zu=de,ec=function(e){return e._delegate._queryIdentifier},tc=function(e){Eu(e)},nc=Object.freeze({__proto__:null,DataConnection:$u,RealTimeConnection:Ju,hijackHash:Xu,ConnectionTarget:Zu,queryIdentifier:ec,forceRestClient:tc}),rc=qu.ServerValue;function ic(e){d(e.SDK_VERSION);var t=e.INTERNAL.registerComponent(new o["a"]("database",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new qu(wu(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Mu,Query:Fu,Database:qu,DataSnapshot:Lu,enableLogging:E,INTERNAL:Gu,ServerValue:rc,TEST_ACCESS:nc}).setMultipleInstances(!0));e.registerVersion(c,l),Object(a["t"])()&&(r.exports=t)}ic(i["default"])}.call(this,n("4362"),n("dd40")(e))},ffa6:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return s}));var r=n("9ab4"),i=n("a8e9"),o=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),a="[DEFAULT]",s=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Set}return e.prototype.get=function(e){void 0===e&&(e=a);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i["a"];if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=Object(r["a"])({identifier:a,optional:!1},e),n=t.identifier,i=t.optional,o=this.normalizeInstanceIdentifier(n);if(!this.isInitialized(o)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:o})}catch(s){if(i)return null;throw s}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(c(e))try{this.getOrInitializeService({instanceIdentifier:a})}catch(p){}try{for(var i=Object(r["h"])(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=Object(r["f"])(o.value,2),u=s[0],l=s[1],h=this.normalizeInstanceIdentifier(u);try{var d=this.getOrInitializeService({instanceIdentifier:h});l.resolve(d)}catch(p){}}}catch(f){t={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=a),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return Object(r["b"])(this,void 0,void 0,(function(){var e;return Object(r["e"])(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Object(r["g"])(Object(r["g"])([],Object(r["f"])(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),Object(r["f"])(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=a),this.instances.has(e)},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.instanceIdentifier,o=void 0===i?a:i,s=e.options,u=void 0===s?{}:s,c=this.normalizeInstanceIdentifier(o);if(this.isInitialized(c))throw Error(this.name+"("+c+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var l=this.getOrInitializeService({instanceIdentifier:c,options:u});try{for(var h=Object(r["h"])(this.instancesDeferred.entries()),d=h.next();!d.done;d=h.next()){var p=Object(r["f"])(d.value,2),f=p[0],_=p[1],v=this.normalizeInstanceIdentifier(f);c===v&&_.resolve(l)}}catch(y){t={error:y}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}return this.invokeOnInitCallbacks(l,c),l},e.prototype.onInit=function(e){var t=this;return this.onInitCallbacks.add(e),function(){t.onInitCallbacks.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i;try{for(var o=Object(r["h"])(this.onInitCallbacks),a=o.next();!a.done;a=o.next()){var s=a.value;try{s(e,t)}catch(u){}}}catch(c){n={error:c}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t=e.instanceIdentifier,n=e.options,r=void 0===n?{}:n,i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:u(t),options:r}),this.instances.set(t,i),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch(o){}return i||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:a:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();function u(e){return e===a?void 0:e}function c(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var l=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){var t=this.getProvider(e.name);t.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new s(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}()}}]);
//# sourceMappingURL=firebase.8d2f272a.js.map